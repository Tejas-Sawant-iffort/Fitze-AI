"use strict";(self.webpackChunkcustom_vf_nextjs=self.webpackChunkcustom_vf_nextjs||[]).push([[333],{74444:(t,e,n)=>{n.d(e,{BH:()=>d,L:()=>o,LL:()=>y,P0:()=>c,Sg:()=>f,ZR:()=>g,aH:()=>h,eu:()=>m,hl:()=>p,m9:()=>b,vZ:()=>w});const i=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=63&r|128):55296==(64512&r)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&t.charCodeAt(++i)),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=63&r|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=63&r|128)}return e},r={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let e=0;e<t.length;e+=3){const r=t[e],s=e+1<t.length,o=s?t[e+1]:0,a=e+2<t.length,u=a?t[e+2]:0,l=r>>2,c=(3&r)<<4|o>>4;let h=(15&o)<<2|u>>6,d=63&u;a||(d=64,s||(h=64)),i.push(n[l],n[c],n[h],n[d])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(i(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,i=0;for(;n<t.length;){const r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=t[n++];e[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const s=((7&r)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(s>>10)),e[i++]=String.fromCharCode(56320+(1023&s))}else{const s=t[n++],o=t[n++];e[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let e=0;e<t.length;){const r=n[t.charAt(e++)],o=e<t.length?n[t.charAt(e)]:0;++e;const a=e<t.length?n[t.charAt(e)]:64;++e;const u=e<t.length?n[t.charAt(e)]:64;if(++e,null==r||null==o||null==a||null==u)throw new s;const l=r<<2|o>>4;if(i.push(l),64!==a){const t=o<<4&240|a>>2;if(i.push(t),64!==u){const t=a<<6&192|u;i.push(t)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class s extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const o=function(t){return function(t){const e=i(t);return r.encodeByteArray(e,!0)}(t).replace(/\./g,"")},a=function(t){try{return r.decodeString(t,!0)}catch(t){}return null};const u=()=>function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,l=()=>{try{return u()||(()=>{if("undefined"==typeof process)return;const t={NODE_ENV:"production",WORKER_ENV:"production"}.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const e=t&&a(t[1]);return e&&JSON.parse(e)})()}catch(t){return}},c=t=>{const e=(t=>{var e,n;return null===(n=null===(e=l())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]})(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),i]:[e.substring(0,n),i]},h=()=>{var t;return null===(t=l())||void 0===t?void 0:t.config};class d{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function f(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",i=t.iat||0,r=t.sub||t.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},t);return[o(JSON.stringify({alg:"none",type:"JWT"})),o(JSON.stringify(s)),""].join(".")}function p(){try{return"object"==typeof indexedDB}catch(t){return!1}}function m(){return new Promise(((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var t;e((null===(t=r.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}))}class g extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,g.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,y.prototype.create)}}class y{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,r=this.errors[t],s=r?function(t,e){return t.replace(v,((t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`}))}(r,n):"Error",o=`${this.serviceName}: ${s} (${i}).`;return new g(i,o,n)}}const v=/\{\$([^}]+)}/g;function w(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const r of n){if(!i.includes(r))return!1;const n=t[r],s=e[r];if(_(n)&&_(s)){if(!w(n,s))return!1}else if(n!==s)return!1}for(const t of i)if(!n.includes(t))return!1;return!0}function _(t){return null!==t&&"object"==typeof t}function b(t){return t&&t._delegate?t._delegate:t}},26677:(t,e,n)=>{n.d(e,{ky:()=>h});var i=n(43953),r=n(67294);var s=function(){return s=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},s.apply(this,arguments)},o=function(t){return{loading:null==t,value:t}},a=function(t){var e=t?t():void 0,n=(0,r.useReducer)((function(t,e){switch(e.type){case"error":return s(s({},t),{error:e.error,loading:!1,value:void 0});case"reset":return o(e.defaultValue);case"value":return s(s({},t),{error:void 0,loading:!1,value:e.value});default:return t}}),o(e)),i=n[0],a=n[1],u=(0,r.useCallback)((function(){var e=t?t():void 0;a({type:"reset",defaultValue:e})}),[t]),l=(0,r.useCallback)((function(t){a({type:"error",error:t})}),[]),c=(0,r.useCallback)((function(t){a({type:"value",value:t})}),[]);return(0,r.useMemo)((function(){return{error:i.error,loading:i.loading,reset:u,setError:l,setValue:c,value:i.value}}),[i.error,i.loading,u,l,c,i.value])},u=function(t,e,n){var i=(0,r.useRef)(t);return(0,r.useEffect)((function(){e(t,i.current)||(i.current=t,n&&n())})),i},l=function(t,e){var n=!t&&!e,r=!!t&&!!e&&(0,i.Eo)(t,e);return n||r},c=function(t,e){return u(t,l,e)},h=function(t,e){var n=a(),s=n.error,o=n.loading,u=n.reset,l=n.setError,h=n.setValue,d=n.value,f=c(t,u);return(0,r.useEffect)((function(){if(f.current){var t=(null==e?void 0:e.snapshotListenOptions)?(0,i.cf)(f.current,e.snapshotListenOptions,h,l):(0,i.cf)(f.current,h,l);return function(){t()}}h(void 0)}),[f.current]),[d,o,s]}},47516:(t,e,n)=>{n.d(e,{PRb:()=>s,dqF:()=>r,y1O:()=>o});var i=n(44405);function r(t){return(0,i.w_)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M16 2H8C4.691 2 2 4.691 2 8v13a1 1 0 0 0 1 1h13c3.309 0 6-2.691 6-6V8c0-3.309-2.691-6-6-6zm4 14c0 2.206-1.794 4-4 4H4V8c0-2.206 1.794-4 4-4h8c2.206 0 4 1.794 4 4v8z"}},{tag:"path",attr:{d:"M11 6h2v8h-2zm0 10h2v2h-2z"}}]})(t)}function s(t){return(0,i.w_)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"m21.426 11.095-17-8A.999.999 0 0 0 3.03 4.242L4.969 12 3.03 19.758a.998.998 0 0 0 1.396 1.147l17-8a1 1 0 0 0 0-1.81zM5.481 18.197l.839-3.357L12 12 6.32 9.16l-.839-3.357L18.651 12l-13.17 6.197z"}}]})(t)}function o(t){return(0,i.w_)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"m18.988 2.012 3 3L19.701 7.3l-3-3zM8 16h3l7.287-7.287-3-3L8 13z"}},{tag:"path",attr:{d:"M19 19H8.158c-.026 0-.053.01-.079.01-.033 0-.066-.009-.1-.01H5V5h6.847l2-2H5c-1.103 0-2 .896-2 2v14c0 1.104.897 2 2 2h14a2 2 0 0 0 2-2v-8.668l-2 2V19z"}}]})(t)}},70231:(t,e,n)=>{n.d(e,{Wh:()=>a,g_g:()=>l,gjK:()=>s,gmG:()=>u,l_A:()=>r,uYL:()=>o});var i=n(44405);function r(t){return(0,i.w_)({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"}}]})(t)}function s(t){return(0,i.w_)({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M579.8 267.7c56.5-56.5 56.5-148 0-204.5c-50-50-128.8-56.5-186.3-15.4l-1.6 1.1c-14.4 10.3-17.7 30.3-7.4 44.6s30.3 17.7 44.6 7.4l1.6-1.1c32.1-22.9 76-19.3 103.8 8.6c31.5 31.5 31.5 82.5 0 114L422.3 334.8c-31.5 31.5-82.5 31.5-114 0c-27.9-27.9-31.5-71.8-8.6-103.8l1.1-1.6c10.3-14.4 6.9-34.4-7.4-44.6s-34.4-6.9-44.6 7.4l-1.1 1.6C206.5 251.2 213 330 263 380c56.5 56.5 148 56.5 204.5 0L579.8 267.7zM60.2 244.3c-56.5 56.5-56.5 148 0 204.5c50 50 128.8 56.5 186.3 15.4l1.6-1.1c14.4-10.3 17.7-30.3 7.4-44.6s-30.3-17.7-44.6-7.4l-1.6 1.1c-32.1 22.9-76 19.3-103.8-8.6C74 372 74 321 105.5 289.5L217.7 177.2c31.5-31.5 82.5-31.5 114 0c27.9 27.9 31.5 71.8 8.6 103.9l-1.1 1.6c-10.3 14.4-6.9 34.4 7.4 44.6s34.4 6.9 44.6-7.4l1.1-1.6C433.5 260.8 427 182 377 132c-56.5-56.5-148-56.5-204.5 0L60.2 244.3z"}}]})(t)}function o(t){return(0,i.w_)({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M192 0C139 0 96 43 96 96V256c0 53 43 96 96 96s96-43 96-96V96c0-53-43-96-96-96zM64 216c0-13.3-10.7-24-24-24s-24 10.7-24 24v40c0 89.1 66.2 162.7 152 174.4V464H120c-13.3 0-24 10.7-24 24s10.7 24 24 24h72 72c13.3 0 24-10.7 24-24s-10.7-24-24-24H216V430.4c85.8-11.7 152-85.3 152-174.4V216c0-13.3-10.7-24-24-24s-24 10.7-24 24v40c0 70.7-57.3 128-128 128s-128-57.3-128-128V216z"}}]})(t)}function a(t){return(0,i.w_)({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M48 64C21.5 64 0 85.5 0 112V400c0 26.5 21.5 48 48 48H80c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48H48zm192 0c-26.5 0-48 21.5-48 48V400c0 26.5 21.5 48 48 48h32c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48H240z"}}]})(t)}function u(t){return(0,i.w_)({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"}}]})(t)}function l(t){return(0,i.w_)({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M80 160c0-35.3 28.7-64 64-64h32c35.3 0 64 28.7 64 64v3.6c0 21.8-11.1 42.1-29.4 53.8l-42.2 27.1c-25.2 16.2-40.4 44.1-40.4 74V320c0 17.7 14.3 32 32 32s32-14.3 32-32v-1.4c0-8.2 4.2-15.8 11-20.2l42.2-27.1c36.6-23.6 58.8-64.1 58.8-107.7V160c0-70.7-57.3-128-128-128H144C73.3 32 16 89.3 16 160c0 17.7 14.3 32 32 32s32-14.3 32-32zm80 320a40 40 0 1 0 0-80 40 40 0 1 0 0 80z"}}]})(t)}},51649:(t,e,n)=>{n.d(e,{DVR:()=>a,Gy1:()=>s,QAE:()=>o,qAq:()=>r});var i=n(44405);function r(t){return(0,i.w_)({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M431 320.6c0-4.4 1.2-8.6 3.3-12.2.6-1.1 1.4-2.1 2.1-3.1 17.4-26 27.6-57.1 27.6-90.3.3-92.2-77.5-167-173.7-167-83.9 0-153.9 57.1-170.3 132.9-2.4 11.1-3.7 22.4-3.7 34.2 0 92.3 74.8 169.1 171 169.1 15.3 0 35.9-4.6 47.2-7.7 11.3-3.1 22.5-7.2 25.4-8.3 2.9-1.1 6.1-1.7 9.3-1.7 3.6 0 7 .7 10.1 2l56.7 20.1s2.4 1 3.9 1c4.4 0 8-3.5 8-8 0-1-.5-2.7-.5-2.7L431 320.6z"}},{tag:"path",attr:{d:"M318.5 392.5c-3.6 1-8.2 2.1-13.2 3.2-10.5 2.2-23.9 4.5-34 4.5-96.2 0-171-76.8-171-169.1 0-6.6.7-15 1.5-21.4.6-4.3 1.3-8.6 2.3-12.8 1-4.5 2.2-9 3.5-13.4l-8 7.1C66.8 219.2 48 260 48 302.5c0 29.3 8.5 57.5 24.8 82 2.3 3.5 3.6 6.2 3.2 8-.4 1.8-11.9 62-11.9 62-.6 2.9.5 5.8 2.7 7.7 1.5 1.2 3.3 1.8 5.1 1.8 1 0 2-.2 2.9-.6l56.1-22.1c1.8-.7 3.7-1.1 5.7-1.1 0 0 2.4-.2 6.3 1.3 18.9 7.4 39.8 12 60.7 12 46.6 0 90.4-20.1 120.1-55.1 0 0 3.2-4.4 6.9-9.6-3.7 1.3-7.9 2.6-12.1 3.7z"}}]})(t)}function s(t){return(0,i.w_)({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M186.301 339.893L96 249.461l-32 30.507L186.301 402 448 140.506 416 110z"}}]})(t)}function o(t){return(0,i.w_)({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M405 136.798L375.202 107 256 226.202 136.798 107 107 136.798 226.202 256 107 375.202 136.798 405 256 285.798 375.202 405 405 375.202 285.798 256z"}}]})(t)}function a(t){return(0,i.w_)({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M387.581 139.712L356.755 109 216.913 248.319l30.831 30.719 139.837-139.326zM481.172 109L247.744 340.469l-91.39-91.051-30.827 30.715L247.744 403 512 139.712 481.172 109zM0 280.133L123.321 403l30.829-30.713L31.934 249.418 0 280.133z"}}]})(t)}},5434:(t,e,n)=>{n.d(e,{AMb:()=>o,jZM:()=>a,kIL:()=>r,sOJ:()=>s,xg7:()=>u});var i=n(44405);function r(t){return(0,i.w_)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"}},{tag:"path",attr:{d:"M6 19h12v2H6z"}}]})(t)}function s(t){return(0,i.w_)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}}]})(t)}function o(t){return(0,i.w_)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm7.46 7.12l-2.78 1.15a4.982 4.982 0 00-2.95-2.94l1.15-2.78c2.1.8 3.77 2.47 4.58 4.57zM12 15c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zM9.13 4.54l1.17 2.78a5 5 0 00-2.98 2.97L4.54 9.13a7.984 7.984 0 014.59-4.59zM4.54 14.87l2.78-1.15a4.968 4.968 0 002.97 2.96l-1.17 2.78a7.996 7.996 0 01-4.58-4.59zm10.34 4.59l-1.15-2.78a4.978 4.978 0 002.95-2.97l2.78 1.17a8.007 8.007 0 01-4.58 4.58z"}}]})(t)}function a(t){return(0,i.w_)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{fill:"none"},child:[{tag:"path",attr:{d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M0 0h24v24H0z"}}]},{tag:"path",attr:{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"}}]})(t)}function u(t){return(0,i.w_)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z",opacity:".87"}},{tag:"path",attr:{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3.59-13L12 10.59 8.41 7 7 8.41 10.59 12 7 15.59 8.41 17 12 13.41 15.59 17 17 15.59 13.41 12 17 8.41z"}}]})(t)}},79352:(t,e,n)=>{n.d(e,{G1z:()=>s,_v3:()=>a,kc8:()=>r,xEs:()=>o});var i=n(44405);function r(t){return(0,i.w_)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12 15.0006L7.75732 10.758L9.17154 9.34375L12 12.1722L14.8284 9.34375L16.2426 10.758L12 15.0006Z"}}]})(t)}function s(t){return(0,i.w_)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M14.8287 7.7574L9.1718 13.4143C8.78127 13.8048 8.78127 14.4379 9.1718 14.8285C9.56232 15.219 10.1955 15.219 10.586 14.8285L16.2429 9.17161C17.4144 8.00004 17.4144 6.10055 16.2429 4.92897C15.0713 3.7574 13.1718 3.7574 12.0002 4.92897L6.34337 10.5858C4.39075 12.5384 4.39075 15.7043 6.34337 17.6569C8.29599 19.6095 11.4618 19.6095 13.4144 17.6569L19.0713 12L20.4855 13.4143L14.8287 19.0711C12.095 21.8048 7.66283 21.8048 4.92916 19.0711C2.19549 16.3374 2.19549 11.9053 4.92916 9.17161L10.586 3.51476C12.5386 1.56214 15.7045 1.56214 17.6571 3.51476C19.6097 5.46738 19.6097 8.63321 17.6571 10.5858L12.0002 16.2427C10.8287 17.4143 8.92916 17.4143 7.75759 16.2427C6.58601 15.0711 6.58601 13.1716 7.75759 12L13.4144 6.34319L14.8287 7.7574Z"}}]})(t)}function o(t){return(0,i.w_)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M11.9998 3C10.3429 3 8.99976 4.34315 8.99976 6V10C8.99976 11.6569 10.3429 13 11.9998 13C13.6566 13 14.9998 11.6569 14.9998 10V6C14.9998 4.34315 13.6566 3 11.9998 3ZM11.9998 1C14.7612 1 16.9998 3.23858 16.9998 6V10C16.9998 12.7614 14.7612 15 11.9998 15C9.23833 15 6.99976 12.7614 6.99976 10V6C6.99976 3.23858 9.23833 1 11.9998 1ZM3.05469 11H5.07065C5.55588 14.3923 8.47329 17 11.9998 17C15.5262 17 18.4436 14.3923 18.9289 11H20.9448C20.4837 15.1716 17.1714 18.4839 12.9998 18.9451V23H10.9998V18.9451C6.82814 18.4839 3.51584 15.1716 3.05469 11Z"}}]})(t)}function a(t){return(0,i.w_)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M16.4259 17.839L21.1935 22.6066L22.6077 21.1924L2.80874 1.3934L1.39453 2.80761L7.00113 8.41421V10C7.00113 12.7614 9.23971 15 12.0011 15C12.4835 15 12.9499 14.9317 13.3912 14.8042L14.9413 16.3544C14.0474 16.7688 13.0513 17 12.0011 17C8.47466 17 5.55725 14.3923 5.07202 11H3.05606C3.51721 15.1716 6.82952 18.4839 11.0011 18.9451V23H13.0011V18.9451C14.2351 18.8087 15.3939 18.4228 16.4259 17.839ZM11.5538 12.9669C10.2551 12.7727 9.22843 11.7461 9.03426 10.4473L11.5538 12.9669ZM19.3757 15.1604L17.9333 13.7179C18.4417 12.9084 18.789 11.9874 18.9302 11H20.9462C20.7763 12.5366 20.2197 13.9565 19.3757 15.1604ZM16.4668 12.2514L14.9183 10.703C14.9725 10.4775 15.0011 10.2421 15.0011 10V6C15.0011 4.34315 13.658 3 12.0011 3C10.7069 3 9.60408 3.81956 9.18335 4.96802L7.68672 3.47139C8.55524 1.99268 10.1623 1 12.0011 1C14.7626 1 17.0011 3.23858 17.0011 6V10C17.0011 10.8099 16.8086 11.5748 16.4668 12.2514Z"}}]})(t)}},8514:(t,e,n)=>{n.d(e,{Z:()=>_});var i=n(87462),r=n(63366),s=n(67294);const o=s.useLayoutEffect;var a=function(t,e){"function"!=typeof t?t.current=e:t(e)};const u=function(t,e){var n=(0,s.useRef)();return(0,s.useCallback)((function(i){t.current=i,n.current&&a(n.current,null),n.current=e,e&&a(e,i)}),[e])};var l={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},c=function(t){Object.keys(l).forEach((function(e){t.style.setProperty(e,l[e],"important")}))},h=null,d=function(t,e){var n=t.scrollHeight;return"border-box"===e.sizingStyle.boxSizing?n+e.borderSize:n-e.paddingSize};var f=function(){},p=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak"],m=!!document.documentElement.currentStyle,g=function(t){var e=window.getComputedStyle(t);if(null===e)return null;var n,i=(n=e,p.reduce((function(t,e){return t[e]=n[e],t}),{})),r=i.boxSizing;return""===r?null:(m&&"border-box"===r&&(i.width=parseFloat(i.width)+parseFloat(i.borderRightWidth)+parseFloat(i.borderLeftWidth)+parseFloat(i.paddingRight)+parseFloat(i.paddingLeft)+"px"),{sizingStyle:i,paddingSize:parseFloat(i.paddingBottom)+parseFloat(i.paddingTop),borderSize:parseFloat(i.borderBottomWidth)+parseFloat(i.borderTopWidth)})};function y(t,e,n){var i,r,a=(i=n,r=s.useRef(i),o((function(){r.current=i})),r);s.useLayoutEffect((function(){var n=function(t){return a.current(t)};if(t)return t.addEventListener(e,n),function(){return t.removeEventListener(e,n)}}),[])}var v=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],w=function(t,e){var n=t.cacheMeasurements,o=t.maxRows,a=t.minRows,l=t.onChange,p=void 0===l?f:l,m=t.onHeightChange,w=void 0===m?f:m,_=(0,r.Z)(t,v),b=void 0!==_.value,E=s.useRef(null),T=u(E,e),S=s.useRef(0),C=s.useRef(),I=function(){var t=E.current,e=n&&C.current?C.current:g(t);if(e){C.current=e;var i=function(t,e,n,i){void 0===n&&(n=1),void 0===i&&(i=1/0),h||((h=document.createElement("textarea")).setAttribute("tabindex","-1"),h.setAttribute("aria-hidden","true"),c(h)),null===h.parentNode&&document.body.appendChild(h);var r=t.paddingSize,s=t.borderSize,o=t.sizingStyle,a=o.boxSizing;Object.keys(o).forEach((function(t){var e=t;h.style[e]=o[e]})),c(h),h.value=e;var u=d(h,t);h.value=e,u=d(h,t),h.value="x";var l=h.scrollHeight-r,f=l*n;"border-box"===a&&(f=f+r+s),u=Math.max(f,u);var p=l*i;return"border-box"===a&&(p=p+r+s),[u=Math.min(p,u),l]}(e,t.value||t.placeholder||"x",a,o),r=i[0],s=i[1];S.current!==r&&(S.current=r,t.style.setProperty("height",r+"px","important"),w(r,{rowHeight:s}))}};return s.useLayoutEffect(I),y(window,"resize",I),function(t){y(document.fonts,"loadingdone",t)}(I),s.createElement("textarea",(0,i.Z)({},_,{onChange:function(t){b||I(),p(t)},ref:T}))},_=s.forwardRef(w)},28965:(t,e,n)=>{function i(t){return" \r\n\t".indexOf(t)>=0}function r(t){for(var e,n,r,s=["topLevel"],o=0,a=function(t){return s.push(t)},u=function(t){return s[s.length-1]=t},l=function(t){null==e&&(e=o,n=s.length,r=t)},c=function(t){t===r&&(e=void 0,n=void 0,r=void 0)},h=function(){return s.pop()},d=function(){return o--},f=function(t){if("0"<=t&&t<="9")a("number");else switch(t){case'"':return void a("string");case"-":return void a("numberNeedsDigit");case"t":return void a("true");case"f":return void a("false");case"n":return void a("null");case"[":return void a("arrayNeedsValue");case"{":return void a("objectNeedsKey")}},p=t.length;o<p;o++){var m=t[o];switch(s[s.length-1]){case"topLevel":f(m);break;case"string":switch(m){case'"':h();break;case"\\":l("stringEscape"),a("stringEscaped")}break;case"stringEscaped":"u"===m?a("stringUnicode"):(c("stringEscape"),h());break;case"stringUnicode":o-t.lastIndexOf("u",o)==4&&(c("stringEscape"),h());break;case"number":"."===m?u("numberNeedsDigit"):"e"===m||"E"===m?u("numberNeedsExponent"):(m<"0"||m>"9")&&(d(),h());break;case"numberNeedsDigit":u("number");break;case"numberNeedsExponent":u("+"===m||"-"===m?"numberNeedsDigit":"number");break;case"true":case"false":case"null":(m<"a"||m>"z")&&(d(),h());break;case"arrayNeedsValue":"]"===m?h():i(m)||(c("collectionItem"),u("arrayNeedsComma"),f(m));break;case"arrayNeedsComma":"]"===m?h():","===m&&(l("collectionItem"),u("arrayNeedsValue"));break;case"objectNeedsKey":"}"===m?h():'"'===m&&(l("collectionItem"),u("objectNeedsColon"),a("string"));break;case"objectNeedsColon":":"===m&&u("objectNeedsValue");break;case"objectNeedsValue":i(m)||(c("collectionItem"),u("objectNeedsComma"),f(m));break;case"objectNeedsComma":"}"===m?h():","===m&&(l("collectionItem"),u("objectNeedsKey"))}}null!=n&&(s.length=n);for(var g=[null!=e?t.slice(0,e):t],y=function(e){return g.push(e.slice(t.length-t.lastIndexOf(e[0])))},v=s.length-1;v>=0;v--)switch(s[v]){case"string":g.push('"');break;case"numberNeedsDigit":case"numberNeedsExponent":g.push("0");break;case"true":y("true");break;case"false":y("false");break;case"null":y("null");break;case"arrayNeedsValue":case"arrayNeedsComma":g.push("]");break;case"objectNeedsKey":case"objectNeedsColon":case"objectNeedsValue":case"objectNeedsComma":g.push("}")}return g.join("")}n.d(e,{Z:()=>r})},10389:(t,e,n)=>{n.d(e,{Jn:()=>F,qX:()=>P,Xd:()=>N,wN:()=>L,Mq:()=>B,ZF:()=>U,KN:()=>j});var i=n(8463),r=n(53333),s=n(74444);const o=(t,e)=>e.some((e=>t instanceof e));let a,u;const l=new WeakMap,c=new WeakMap,h=new WeakMap,d=new WeakMap,f=new WeakMap;let p={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return c.get(t);if("objectStoreNames"===e)return t.objectStoreNames||h.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return y(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function m(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(u||(u=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(v(this),e),y(l.get(this))}:function(...e){return y(t.apply(v(this),e))}:function(e,...n){const i=t.call(v(this),e,...n);return h.set(i,e.sort?e.sort():[e]),y(i)}}function g(t){return"function"==typeof t?m(t):(t instanceof IDBTransaction&&function(t){if(c.has(t))return;const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",s),t.removeEventListener("abort",s)},r=()=>{e(),i()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",r),t.addEventListener("error",s),t.addEventListener("abort",s)}));c.set(t,e)}(t),o(t,a||(a=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,p):t)}function y(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("success",r),t.removeEventListener("error",s)},r=()=>{e(y(t.result)),i()},s=()=>{n(t.error),i()};t.addEventListener("success",r),t.addEventListener("error",s)}));return e.then((e=>{e instanceof IDBCursor&&l.set(e,t)})).catch((()=>{})),f.set(e,t),e}(t);if(d.has(t))return d.get(t);const e=g(t);return e!==t&&(d.set(t,e),f.set(e,t)),e}const v=t=>f.get(t);const w=["get","getKey","getAll","getAllKeys","count"],_=["put","add","delete","clear"],b=new Map;function E(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(b.get(e))return b.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,r=_.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!w.includes(n))return;const s=async function(t,...e){const s=this.transaction(t,r?"readwrite":"readonly");let o=s.store;return i&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),r&&s.done]))[0]};return b.set(e,s),s}p=(t=>({...t,get:(e,n,i)=>E(e,n)||t.get(e,n,i),has:(e,n)=>!!E(e,n)||t.has(e,n)}))(p);class T{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const S="@firebase/app",C="0.9.25",I=new r.Yd("@firebase/app"),A="[DEFAULT]",k={[S]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},D=new Map,x=new Map;function R(t,e){try{t.container.addComponent(e)}catch(n){I.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function N(t){const e=t.name;if(x.has(e))return I.debug(`There were multiple attempts to register component ${e}.`),!1;x.set(e,t);for(const e of D.values())R(e,t);return!0}function P(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function L(t,e,n=A){P(t,e).clearInstance(n)}const O={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},M=new s.LL("app","Firebase",O);class V{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new i.wA("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw M.create("app-deleted",{appName:this._name})}}const F="10.7.1";function U(t,e={}){let n=t;if("object"!=typeof e){e={name:e}}const r=Object.assign({name:A,automaticDataCollectionEnabled:!1},e),o=r.name;if("string"!=typeof o||!o)throw M.create("bad-app-name",{appName:String(o)});if(n||(n=(0,s.aH)()),!n)throw M.create("no-options");const a=D.get(o);if(a){if((0,s.vZ)(n,a.options)&&(0,s.vZ)(r,a.config))return a;throw M.create("duplicate-app",{appName:o})}const u=new i.H0(o);for(const t of x.values())u.addComponent(t);const l=new V(n,r,u);return D.set(o,l),l}function B(t=A){const e=D.get(t);if(!e&&t===A&&(0,s.aH)())return U();if(!e)throw M.create("no-app",{appName:t});return e}function j(t,e,n){var r;let s=null!==(r=k[t])&&void 0!==r?r:t;n&&(s+=`-${n}`);const o=s.match(/\s|\//),a=e.match(/\s|\//);if(o||a){const t=[`Unable to register library "${s}" with version "${e}":`];return o&&t.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&a&&t.push("and"),a&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void I.warn(t.join(" "))}N(new i.wA(`${s}-version`,(()=>({library:s,version:e})),"VERSION"))}const q="firebase-heartbeat-database",z=1,$="firebase-heartbeat-store";let H=null;function G(){return H||(H=function(t,e,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(t,e),a=y(o);return i&&o.addEventListener("upgradeneeded",(t=>{i(y(o.result),t.oldVersion,t.newVersion,y(o.transaction),t)})),n&&o.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),a.then((t=>{s&&t.addEventListener("close",(()=>s())),r&&t.addEventListener("versionchange",(t=>r(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}(q,z,{upgrade:(t,e)=>{if(0===e)t.createObjectStore($)}}).catch((t=>{throw M.create("idb-open",{originalErrorMessage:t.message})}))),H}async function K(t,e){try{const n=(await G()).transaction($,"readwrite"),i=n.objectStore($);await i.put(e,W(t)),await n.done}catch(t){if(t instanceof s.ZR)I.warn(t.message);else{const e=M.create("idb-set",{originalErrorMessage:null==t?void 0:t.message});I.warn(e.message)}}}function W(t){return`${t.name}!${t.options.appId}`}class Q{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new Y(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){var t,e;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=X();if((null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==i&&!this._heartbeatsCache.heartbeats.some((t=>t.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var t;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const e=X(),{heartbeatsToSend:n,unsentEntries:i}=function(t,e=1024){const n=[];let i=t.slice();for(const r of t){const t=n.find((t=>t.agent===r.agent));if(t){if(t.dates.push(r.date),J(n)>e){t.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),J(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),r=(0,s.L)(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function X(){return(new Date).toISOString().substring(0,10)}class Y{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,s.hl)()&&(0,s.eu)().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){try{const e=await G();return await e.transaction($).objectStore($).get(W(t))}catch(t){if(t instanceof s.ZR)I.warn(t.message);else{const e=M.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});I.warn(e.message)}}}(this.app);return(null==t?void 0:t.heartbeats)?t:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return K(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return K(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function J(t){return(0,s.L)(JSON.stringify({version:2,heartbeats:t})).length}var Z;Z="",N(new i.wA("platform-logger",(t=>new T(t)),"PRIVATE")),N(new i.wA("heartbeat",(t=>new Q(t)),"PRIVATE")),j(S,C,Z),j(S,C,"esm2017"),j("fire-js","")},8463:(t,e,n)=>{n.d(e,{H0:()=>a,wA:()=>r});var i=n(74444);class r{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const s="[DEFAULT]";class o{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new i.BH;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(i)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:s})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t=s){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t=s){return this.instances.has(t)}getOptions(t=s){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(t)&&e.resolve(i)}return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(t),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&t(s,i),()=>{r.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===s?void 0:i),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var i;return n||null}normalizeInstanceIdentifier(t=s){return this.component?this.component.multipleInstances?t:s:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class a{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new o(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}},53333:(t,e,n)=>{n.d(e,{Yd:()=>l,in:()=>r});const i=[];var r;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(r||(r={}));const s={debug:r.DEBUG,verbose:r.VERBOSE,info:r.INFO,warn:r.WARN,error:r.ERROR,silent:r.SILENT},o=r.INFO,a={[r.DEBUG]:"log",[r.VERBOSE]:"log",[r.INFO]:"info",[r.WARN]:"warn",[r.ERROR]:"error"},u=(t,e,...n)=>{if(e<t.logLevel)return;(new Date).toISOString();if(!a[e])throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class l{constructor(t){this.name=t,this._logLevel=o,this._logHandler=u,this._userLogHandler=null,i.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in r))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?s[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,r.DEBUG,...t),this._logHandler(this,r.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,r.VERBOSE,...t),this._logHandler(this,r.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,r.INFO,...t),this._logHandler(this,r.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,r.WARN,...t),this._logHandler(this,r.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,r.ERROR,...t),this._logHandler(this,r.ERROR,...t)}}},57897:(t,e,n)=>{n.d(e,{f:()=>r});var i=n(85893),r=t=>(0,i.jsx)("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 0 24 24",width:"1em",...t,children:(0,i.jsx)("path",{d:"M12 2a10 10 0 1010 10A10.016 10.016 0 0012 2zm3.36 12.3a.754.754 0 010 1.06.748.748 0 01-1.06 0l-2.3-2.3-2.3 2.3a.748.748 0 01-1.06 0 .754.754 0 010-1.06l2.3-2.3-2.3-2.3A.75.75 0 019.7 8.64l2.3 2.3 2.3-2.3a.75.75 0 011.06 1.06l-2.3 2.3z",fill:"currentColor"})})},54720:(t,e,n)=>{n.d(e,{e:()=>i,x:()=>r});var i=t=>(null==t?void 0:t.length)<=4?t:null==t?void 0:t.slice(0,3),r=(...t)=>{let e=" ";for(const n of t)if("string"==typeof n&&n.length>0){e=n;break}return e}},14868:(t,e,n)=>{n.d(e,{Q:()=>a});var i=n(67294),r=n(9975),s=n(69786),o=n(61718);function a(t,e,n){let{validationBehavior:a,focus:l}=t;(0,s.b)((()=>{if("native"===a&&(null==n?void 0:n.current)){let i=e.realtimeValidation.isInvalid?e.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";n.current.setCustomValidity(i),n.current.hasAttribute("title")||(n.current.title=""),e.realtimeValidation.isInvalid||e.updateValidation({isInvalid:!(t=n.current).validity.valid,validationDetails:u(t),validationErrors:t.validationMessage?[t.validationMessage]:[]})}var t}));let c=(0,o.i)((()=>{e.resetValidation()})),h=(0,o.i)((t=>{var i;e.displayValidation.isInvalid||e.commitValidation();let s=null==n||null===(i=n.current)||void 0===i?void 0:i.form;var o;!t.defaultPrevented&&n&&s&&function(t){for(let e=0;e<t.elements.length;e++){let n=t.elements[e];if(!n.validity.valid)return n}return null}(s)===n.current&&(l?l():null===(o=n.current)||void 0===o||o.focus(),(0,r._w)("keyboard"));t.preventDefault()})),d=(0,o.i)((()=>{e.commitValidation()}));(0,i.useEffect)((()=>{let t=null==n?void 0:n.current;if(!t)return;let e=t.form;return t.addEventListener("invalid",h),t.addEventListener("change",d),null==e||e.addEventListener("reset",c),()=>{t.removeEventListener("invalid",h),t.removeEventListener("change",d),null==e||e.removeEventListener("reset",c)}}),[n,h,d,c,a])}function u(t){let e=t.validity;return{badInput:e.badInput,customError:e.customError,patternMismatch:e.patternMismatch,rangeOverflow:e.rangeOverflow,rangeUnderflow:e.rangeUnderflow,stepMismatch:e.stepMismatch,tooLong:e.tooLong,tooShort:e.tooShort,typeMismatch:e.typeMismatch,valueMissing:e.valueMissing,valid:e.valid}}},15967:(t,e,n)=>{n.d(e,{U:()=>o});var i=n(50912),r=n(38073),s=n(61476);function o(t){let{description:e,errorMessage:n,isInvalid:o,validationState:a}=t,{labelProps:u,fieldProps:l}=(0,i.N)(t),c=(0,r.mp)([Boolean(e),Boolean(n),o,a]),h=(0,r.mp)([Boolean(e),Boolean(n),o,a]);return l=(0,s.d)(l,{"aria-describedby":[c,h,t["aria-describedby"]].filter(Boolean).join(" ")||void 0}),{labelProps:u,fieldProps:l,descriptionProps:{id:c},errorMessageProps:{id:h}}}},50912:(t,e,n)=>{n.d(e,{N:()=>s});var i=n(38073),r=n(79955);function s(t){let{id:e,label:n,"aria-labelledby":s,"aria-label":o,labelElementType:a="label"}=t;e=(0,i.Me)(e);let u=(0,i.Me)(),l={};return n&&(s=s?`${u} ${s}`:u,l={id:u,htmlFor:"label"===a?e:void 0}),{labelProps:l,fieldProps:(0,r.b)({id:e,"aria-label":o,"aria-labelledby":s})}}},83666:(t,e,n)=>{n.d(e,{h:()=>f});var i=n(67294),r=n(3136),s=n(85952),o=n(78837),a=n(61476),u=n(99373),l=n(15967),c=n(68587),h=n(14868),d=n(48750);function f(t,e){let{inputElementType:n="input",isDisabled:f=!1,isRequired:p=!1,isReadOnly:m=!1,type:g="text",validationBehavior:y="aria"}=t,[v,w]=(0,u.z)(t.value,t.defaultValue||"",t.onChange),{focusableProps:_}=(0,c.k)(t,e),b=(0,d.Q3)({...t,value:v}),{isInvalid:E,validationErrors:T,validationDetails:S}=b.displayValidation,{labelProps:C,fieldProps:I,descriptionProps:A,errorMessageProps:k}=(0,l.U)({...t,isInvalid:E,errorMessage:t.errorMessage||T}),D=(0,r.z)(t,{labelable:!0});const x={type:g,pattern:t.pattern};return(0,s.y)(e,v,w),(0,h.Q)(t,b,e),(0,i.useEffect)((()=>{if(e.current instanceof(0,o.k)(e.current).HTMLTextAreaElement){let t=e.current;Object.defineProperty(t,"defaultValue",{get:()=>t.value,set:()=>{},configurable:!0})}}),[e]),{labelProps:C,inputProps:(0,a.d)(D,"input"===n&&x,{disabled:f,readOnly:m,required:p&&"native"===y,"aria-required":p&&"aria"===y||void 0,"aria-invalid":E||void 0,"aria-errormessage":t["aria-errormessage"],"aria-activedescendant":t["aria-activedescendant"],"aria-autocomplete":t["aria-autocomplete"],"aria-haspopup":t["aria-haspopup"],value:v,onChange:t=>w(t.target.value),autoComplete:t.autoComplete,autoCapitalize:t.autoCapitalize,maxLength:t.maxLength,minLength:t.minLength,name:t.name,placeholder:t.placeholder,inputMode:t.inputMode,onCopy:t.onCopy,onCut:t.onCut,onPaste:t.onPaste,onCompositionEnd:t.onCompositionEnd,onCompositionStart:t.onCompositionStart,onCompositionUpdate:t.onCompositionUpdate,onSelect:t.onSelect,onBeforeInput:t.onBeforeInput,onInput:t.onInput,..._,...I}),descriptionProps:A,errorMessageProps:k,isInvalid:E,validationErrors:T,validationDetails:S}}},85952:(t,e,n)=>{n.d(e,{y:()=>s});var i=n(61718),r=n(67294);function s(t,e,n){let s=(0,r.useRef)(e),o=(0,i.i)((()=>{n&&n(s.current)}));(0,r.useEffect)((()=>{var e;let n=null==t||null===(e=t.current)||void 0===e?void 0:e.form;return null==n||n.addEventListener("reset",o),()=>{null==n||n.removeEventListener("reset",o)}}),[t,o])}},79955:(t,e,n)=>{n.d(e,{b:()=>r});var i=n(38073);function r(t,e){let{id:n,"aria-label":r,"aria-labelledby":s}=t;if(n=(0,i.Me)(n),s&&r){let t=new Set([n,...s.trim().split(/\s+/)]);s=[...t].join(" ")}else s&&(s=s.trim().split(/\s+/).join(" "));return r||s||!e||(r=e),{id:n,"aria-label":r,"aria-labelledby":s}}},48750:(t,e,n)=>{n.d(e,{PS:()=>o,Q3:()=>l,W0:()=>f,tL:()=>u});var i=n(67294);const r={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},s={...r,customError:!0,valid:!1},o={isInvalid:!1,validationDetails:r,validationErrors:[]},a=(0,i.createContext)({}),u="__formValidationState"+Date.now();function l(t){if(t[u]){let{realtimeValidation:e,displayValidation:n,updateValidation:i,resetValidation:r,commitValidation:s}=t[u];return{realtimeValidation:e,displayValidation:n,updateValidation:i,resetValidation:r,commitValidation:s}}return function(t){let{isInvalid:e,validationState:n,name:r,value:u,builtinValidation:l,validate:f,validationBehavior:p="aria"}=t;n&&(e||(e="invalid"===n));let m=void 0!==e?{isInvalid:e,validationErrors:[],validationDetails:s}:null,g=(0,i.useMemo)((()=>h(function(t,e){if("function"==typeof t){let n=t(e);if(n&&"boolean"!=typeof n)return c(n)}return[]}(f,u))),[f,u]);(null==l?void 0:l.validationDetails.valid)&&(l=null);let y=(0,i.useContext)(a),v=(0,i.useMemo)((()=>r?Array.isArray(r)?r.flatMap((t=>c(y[t]))):c(y[r]):[]),[y,r]),[w,_]=(0,i.useState)(y),[b,E]=(0,i.useState)(!1);y!==w&&(_(y),E(!1));let T=(0,i.useMemo)((()=>h(b?[]:v)),[b,v]),S=(0,i.useRef)(o),[C,I]=(0,i.useState)(o),A=(0,i.useRef)(o),k=()=>{if(!D)return;x(!1);let t=g||l||S.current;d(t,A.current)||(A.current=t,I(t))},[D,x]=(0,i.useState)(!1);return(0,i.useEffect)(k),{realtimeValidation:m||T||g||l||o,displayValidation:"native"===p?m||T||C:m||T||g||l||C,updateValidation(t){"aria"!==p||d(C,t)?S.current=t:I(t)},resetValidation(){let t=o;d(t,A.current)||(A.current=t,I(t)),"native"===p&&x(!1),E(!0)},commitValidation(){"native"===p&&x(!0),E(!0)}}}(t)}function c(t){return t?Array.isArray(t)?t:[t]:[]}function h(t){return t.length?{isInvalid:!0,validationErrors:t,validationDetails:s}:null}function d(t,e){return t===e||t&&e&&t.isInvalid===e.isInvalid&&t.validationErrors.length===e.validationErrors.length&&t.validationErrors.every(((t,n)=>t===e.validationErrors[n]))&&Object.entries(t.validationDetails).every((([t,n])=>e.validationDetails[t]===n))}function f(...t){let e=new Set,n=!1,i={...r};for(let r of t){var s,o;for(let t of r.validationErrors)e.add(t);n||(n=r.isInvalid);for(let t in i)(s=i)[o=t]||(s[o]=r.validationDetails[t])}return i.valid=!n,{isInvalid:n,validationErrors:[...e],validationDetails:i}}},99373:(t,e,n)=>{n.d(e,{z:()=>r});var i=n(67294);function r(t,e,n){let[r,s]=(0,i.useState)(t||e),o=(0,i.useRef)(void 0!==t),a=void 0!==t;(0,i.useEffect)((()=>{o.current;o.current=a}),[a]);let u=a?t:r,l=(0,i.useCallback)(((t,...e)=>{let i=(t,...e)=>{n&&(Object.is(u,t)||n(t,...e)),a||(u=t)};if("function"==typeof t){s(((n,...r)=>{let s=t(a?u:n,...r);return i(s,...e),a?n:s}))}else a||s(t),i(t,...e)}),[a,u,n]);return[u,l]}},83977:(t,e,n)=>{n.d(e,{ZF:()=>i.ZF});var i=n(10389);(0,i.KN)("firebase","10.7.1","app")},43953:(t,e,n)=>{n.d(e,{JU:()=>Cc,ad:()=>xc,cf:()=>dh,Eo:()=>Ic,pl:()=>hh});var i,r=n(10389),s=n(8463),o=n(53333),a=n(74444),u="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},l={},c=c||{},h=u||self;function d(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function f(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var p="closure_uid_"+(1e9*Math.random()>>>0),m=0;function g(t,e,n){return t.call.apply(t.bind,arguments)}function y(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function v(t,e,n){return(v=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?g:y).apply(null,arguments)}function w(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function _(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(t,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return e.prototype[n].apply(t,r)}}function b(){this.s=this.s,this.o=this.o}b.prototype.s=!1,b.prototype.sa=function(){var t;!this.s&&(this.s=!0,this.N(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,p)&&t[p]||(t[p]=++m))},b.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const E=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function T(t){const e=t.length;if(0<e){const n=Array(e);for(let i=0;i<e;i++)n[i]=t[i];return n}return[]}function S(t,e){for(let e=1;e<arguments.length;e++){const n=arguments[e];if(d(n)){const e=t.length||0,i=n.length||0;t.length=e+i;for(let r=0;r<i;r++)t[e+r]=n[r]}else t.push(n)}}function C(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}C.prototype.h=function(){this.defaultPrevented=!0};var I=function(){if(!h.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const t=()=>{};h.addEventListener("test",t,e),h.removeEventListener("test",t,e)}catch(t){}return t}();function A(t){return/^[\s\xa0]*$/.test(t)}function k(){var t=h.navigator;return t&&(t=t.userAgent)?t:""}function D(t){return-1!=k().indexOf(t)}function x(t){return x[" "](t),t}x[" "]=function(){};var R,N,P,L=D("Opera"),O=D("Trident")||D("MSIE"),M=D("Edge"),V=M||O,F=D("Gecko")&&!(-1!=k().toLowerCase().indexOf("webkit")&&!D("Edge"))&&!(D("Trident")||D("MSIE"))&&!D("Edge"),U=-1!=k().toLowerCase().indexOf("webkit")&&!D("Edge");function B(){var t=h.document;return t?t.documentMode:void 0}t:{var j="",q=(N=k(),F?/rv:([^\);]+)(\)|;)/.exec(N):M?/Edge\/([\d\.]+)/.exec(N):O?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(N):U?/WebKit\/(\S+)/.exec(N):L?/(?:Version)[ \/]?(\S+)/.exec(N):void 0);if(q&&(j=q?q[1]:""),O){var z=B();if(null!=z&&z>parseFloat(j)){R=String(z);break t}}R=j}if(h.document&&O){var $=B();P=$||(parseInt(R,10)||void 0)}else P=void 0;var H=P;function G(t,e){if(C.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(F){t:{try{x(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:K[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&G.$.h.call(this)}}_(G,C);var K={2:"touch",3:"pen",4:"mouse"};G.prototype.h=function(){G.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var W="closure_listenable_"+(1e6*Math.random()|0),Q=0;function X(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.la=r,this.key=++Q,this.fa=this.ia=!1}function Y(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function J(t,e,n){for(const i in t)e.call(n,t[i],i,t)}function Z(t){const e={};for(const n in t)e[n]=t[n];return e}const tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t,e){let n,i;for(let e=1;e<arguments.length;e++){for(n in i=arguments[e],i)t[n]=i[n];for(let e=0;e<tt.length;e++)n=tt[e],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function nt(t){this.src=t,this.g={},this.h=0}function it(t,e){var n=e.type;if(n in t.g){var i,r=t.g[n],s=E(r,e);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(Y(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function rt(t,e,n,i){for(var r=0;r<t.length;++r){var s=t[r];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==i)return r}return-1}nt.prototype.add=function(t,e,n,i,r){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=rt(t,e,i,r);return-1<o?(e=t[o],n||(e.ia=!1)):((e=new X(e,this.src,s,!!i,r)).ia=n,t.push(e)),e};var st="closure_lm_"+(1e6*Math.random()|0),ot={};function at(t,e,n,i,r){if(i&&i.once)return lt(t,e,n,i,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)at(t,e[s],n,i,r);return null}return n=gt(n),t&&t[W]?t.O(e,n,f(i)?!!i.capture:!!i,r):ut(t,e,n,!1,i,r)}function ut(t,e,n,i,r,s){if(!e)throw Error("Invalid event type");var o=f(r)?!!r.capture:!!r,a=pt(t);if(a||(t[st]=a=new nt(t)),(n=a.add(e,n,i,o,s)).proxy)return n;if(i=function(){function t(n){return e.call(t.src,t.listener,n)}const e=ft;return t}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)I||(r=o),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(dt(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function lt(t,e,n,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)lt(t,e[s],n,i,r);return null}return n=gt(n),t&&t[W]?t.P(e,n,f(i)?!!i.capture:!!i,r):ut(t,e,n,!0,i,r)}function ct(t,e,n,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)ct(t,e[s],n,i,r);else i=f(i)?!!i.capture:!!i,n=gt(n),t&&t[W]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(n=rt(s=t.g[e],n,i,r))&&(Y(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--)))):t&&(t=pt(t))&&(e=t.g[e.toString()],t=-1,e&&(t=rt(e,n,i,r)),(n=-1<t?e[t]:null)&&ht(n))}function ht(t){if("number"!=typeof t&&t&&!t.fa){var e=t.src;if(e&&e[W])it(e.i,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(dt(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=pt(e))?(it(n,t),0==n.h&&(n.src=null,e[st]=null)):Y(t)}}}function dt(t){return t in ot?ot[t]:ot[t]="on"+t}function ft(t,e){if(t.fa)t=!0;else{e=new G(e,this);var n=t.listener,i=t.la||t.src;t.ia&&ht(t),t=n.call(i,e)}return t}function pt(t){return(t=t[st])instanceof nt?t:null}var mt="__closure_events_fn_"+(1e9*Math.random()>>>0);function gt(t){return"function"==typeof t?t:(t[mt]||(t[mt]=function(e){return t.handleEvent(e)}),t[mt])}function yt(){b.call(this),this.i=new nt(this),this.S=this,this.J=null}function vt(t,e){var n,i=t.J;if(i)for(n=[];i;i=i.J)n.push(i);if(t=t.S,i=e.type||e,"string"==typeof e)e=new C(e,t);else if(e instanceof C)e.target=e.target||t;else{var r=e;et(e=new C(i,t),r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];r=wt(o,i,!0,e)&&r}if(r=wt(o=e.g=t,i,!0,e)&&r,r=wt(o,i,!1,e)&&r,n)for(s=0;s<n.length;s++)r=wt(o=e.g=n[s],i,!1,e)&&r}function wt(t,e,n,i){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,u=o.la||o.src;o.ia&&it(t.i,o),r=!1!==a.call(u,i)&&r}}return r&&!i.defaultPrevented}_(yt,b),yt.prototype[W]=!0,yt.prototype.removeEventListener=function(t,e,n,i){ct(this,t,e,n,i)},yt.prototype.N=function(){if(yt.$.N.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],i=0;i<n.length;i++)Y(n[i]);delete e.g[t],e.h--}}this.J=null},yt.prototype.O=function(t,e,n,i){return this.i.add(String(t),e,!1,n,i)},yt.prototype.P=function(t,e,n,i){return this.i.add(String(t),e,!0,n,i)};var _t=h.JSON.stringify;function bt(){var t=kt;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Et=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new Tt),(t=>t.reset()));class Tt{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function St(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function Ct(t){h.setTimeout((()=>{throw t}),0)}let It,At=!1,kt=new class{constructor(){this.h=this.g=null}add(t,e){const n=Et.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}},Dt=()=>{const t=h.Promise.resolve(void 0);It=()=>{t.then(xt)}};var xt=()=>{for(var t;t=bt();){try{t.h.call(t.g)}catch(t){Ct(t)}var e=Et;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}At=!1};function Rt(t,e){yt.call(this),this.h=t||1,this.g=e||h,this.j=v(this.qb,this),this.l=Date.now()}function Nt(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}function Pt(t,e,n){if("function"==typeof t)n&&(t=v(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=v(t.handleEvent,t)}return 2147483647<Number(e)?-1:h.setTimeout(t,e||0)}function Lt(t){t.g=Pt((()=>{t.g=null,t.i&&(t.i=!1,Lt(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}_(Rt,yt),(i=Rt.prototype).ga=!1,i.T=null,i.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),vt(this,"tick"),this.ga&&(Nt(this),this.start()))}},i.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},i.N=function(){Rt.$.N.call(this),Nt(this),delete this.g};class Ot extends b{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:Lt(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Mt(t){b.call(this),this.h=t,this.g={}}_(Mt,b);var Vt=[];function Ft(t,e,n,i){Array.isArray(n)||(n&&(Vt[0]=n.toString()),n=Vt);for(var r=0;r<n.length;r++){var s=at(e,n[r],i||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function Ut(t){J(t.g,(function(t,e){this.g.hasOwnProperty(e)&&ht(t)}),t),t.g={}}function Bt(){this.g=!0}function jt(t,e,n,i){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return _t(n)}catch(t){return e}}(t,n)+(i?" "+i:"")}))}Mt.prototype.N=function(){Mt.$.N.call(this),Ut(this)},Mt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Bt.prototype.Ea=function(){this.g=!1},Bt.prototype.info=function(){};var qt={},zt=null;function $t(){return zt=zt||new yt}function Ht(t){C.call(this,qt.Ta,t)}function Gt(t){const e=$t();vt(e,new Ht(e))}function Kt(t,e){C.call(this,qt.STAT_EVENT,t),this.stat=e}function Wt(t){const e=$t();vt(e,new Kt(e,t))}function Qt(t,e){C.call(this,qt.Ua,t),this.size=e}function Xt(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return h.setTimeout((function(){t()}),e)}qt.Ta="serverreachability",_(Ht,C),qt.STAT_EVENT="statevent",_(Kt,C),qt.Ua="timingevent",_(Qt,C);var Yt={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Jt={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Zt(){}function te(t){return t.h||(t.h=t.i())}function ee(){}Zt.prototype.h=null;var ne,ie={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function re(){C.call(this,"d")}function se(){C.call(this,"c")}function oe(){}function ae(t,e,n,i){this.l=t,this.j=e,this.m=n,this.W=i||1,this.U=new Mt(this),this.P=le,t=V?125:void 0,this.V=new Rt(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new ue}function ue(){this.i=null,this.g="",this.h=!1}_(re,C),_(se,C),_(oe,Zt),oe.prototype.g=function(){return new XMLHttpRequest},oe.prototype.i=function(){return{}},ne=new oe;var le=45e3,ce={},he={};function de(t,e,n){t.L=1,t.A=Re(Ie(e)),t.u=n,t.S=!0,fe(t,null)}function fe(t,e){t.G=Date.now(),ye(t),t.B=Ie(t.A);var n=t.B,i=t.W;Array.isArray(i)||(i=[String(i)]),$e(n.i,"t",i),t.o=0,n=t.l.J,t.h=new ue,t.g=Hn(t.l,n?e:null,!t.u),0<t.O&&(t.M=new Ot(v(t.Pa,t,t.g),t.O)),Ft(t.U,t.g,"readystatechange",t.nb),e=t.I?Z(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),Gt(),function(t,e,n,i,r,s){t.info((function(){if(t.g)if(s)for(var o="",a=s.split("&"),u=0;u<a.length;u++){var l=a[u].split("=");if(1<l.length){var c=l[0];l=l[1];var h=c.split("_");o=2<=h.length&&"type"==h[1]?o+(c+"=")+l+"&":o+(c+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.v,t.B,t.m,t.W,t.u)}function pe(t){return!!t.g&&("GET"==t.v&&2!=t.L&&t.l.Ha)}function me(t,e,n){let i,r=!0;for(;!t.J&&t.o<n.length;){if(i=ge(t,n),i==he){4==e&&(t.s=4,Wt(14),r=!1),jt(t.j,t.m,null,"[Incomplete Response]");break}if(i==ce){t.s=4,Wt(15),jt(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}jt(t.j,t.m,i,null),Ee(t,i)}pe(t)&&0!=t.o&&(t.h.g=t.h.g.slice(t.o),t.o=0),4!=e||0!=n.length||t.h.h||(t.s=1,Wt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,(e=t.l).g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Vn(e),e.M=!0,Wt(11))):(jt(t.j,t.m,n,"[Invalid Chunked Response]"),be(t),_e(t))}function ge(t,e){var n=t.o,i=e.indexOf("\n",n);return-1==i?he:(n=Number(e.substring(n,i)),isNaN(n)?ce:(i+=1)+n>e.length?he:(e=e.slice(i,i+n),t.o=i+n,e))}function ye(t){t.Y=Date.now()+t.P,ve(t,t.P)}function ve(t,e){if(null!=t.C)throw Error("WatchDog timer not null");t.C=Xt(v(t.lb,t),e)}function we(t){t.C&&(h.clearTimeout(t.C),t.C=null)}function _e(t){0==t.l.H||t.J||Bn(t.l,t)}function be(t){we(t);var e=t.M;e&&"function"==typeof e.sa&&e.sa(),t.M=null,Nt(t.V),Ut(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function Ee(t,e){try{var n=t.l;if(0!=n.H&&(n.g==t||Ye(n.i,t)))if(!t.K&&Ye(n.i,t)&&3==n.H){try{var i=n.Ja.g.parse(e)}catch(t){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){t:if(!n.u){if(n.g){if(!(n.g.G+3e3<t.G))break t;Un(n),Dn(n)}Mn(n),Wt(18)}}else n.Fa=r[1],0<n.Fa-n.V&&37500>r[2]&&n.G&&0==n.A&&!n.v&&(n.v=Xt(v(n.ib,n),6e3));if(1>=Xe(n.i)&&n.oa){try{n.oa()}catch(t){}n.oa=void 0}}else qn(n,11)}else if((t.K||n.g==t)&&Un(n),!A(e))for(r=n.Ja.g.parse(e),e=0;e<r.length;e++){let l=r[e];if(n.V=l[0],l=l[1],2==n.H)if("c"==l[0]){n.K=l[1],n.pa=l[2];const e=l[3];null!=e&&(n.ra=e,n.l.info("VER="+n.ra));const r=l[4];null!=r&&(n.Ga=r,n.l.info("SVER="+n.Ga));const c=l[5];null!=c&&"number"==typeof c&&0<c&&(i=1.5*c,n.L=i,n.l.info("backChannelRequestTimeoutMs_="+i)),i=n;const h=t.g;if(h){const t=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var s=i.i;s.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(Je(s,s.h),s.h=null))}if(i.F){const t=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(i.Da=t,xe(i.I,i.F,t))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=t;if((i=n).wa=$n(i,i.J?i.pa:null,i.Y),o.K){Ze(i.i,o);var a=o,u=i.L;u&&a.setTimeout(u),a.C&&(we(a),ye(a)),i.g=o}else On(i);0<n.j.length&&Rn(n)}else"stop"!=l[0]&&"close"!=l[0]||qn(n,7);else 3==n.H&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?qn(n,7):kn(n):"noop"!=l[0]&&n.h&&n.h.Aa(l),n.A=0)}Gt()}catch(t){}}function Te(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(d(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.ta&&"function"==typeof t.ta)return t.ta();if(!t.Z||"function"!=typeof t.Z){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(d(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const i in t)e[n++]=i;return e}}}(t),i=function(t){if(t.Z&&"function"==typeof t.Z)return t.Z();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(d(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t),r=i.length,s=0;s<r;s++)e.call(void 0,i[s],n&&n[s],t)}(i=ae.prototype).setTimeout=function(t){this.P=t},i.nb=function(t){t=t.target;const e=this.M;e&&3==En(t)?e.l():this.Pa(t)},i.Pa=function(t){try{if(t==this.g)t:{const c=En(this.g);var e=this.g.Ia();this.g.da();if(!(3>c)&&(3!=c||V||this.g&&(this.h.h||this.g.ja()||Tn(this.g)))){this.J||4!=c||7==e||Gt(),we(this);var n=this.g.da();this.ca=n;e:if(pe(this)){var i=Tn(this.g);t="";var r=i.length,s=4==En(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){be(this),_e(this);var o="";break e}this.h.i=new h.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,t+=this.h.i.decode(i[e],{stream:s&&e==r-1});i.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(t,e,n,i,r,s,o){t.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+"\n"+n+"\n"+s+" "+o}))}(this.j,this.v,this.B,this.m,this.W,c,n),this.i){if(this.aa&&!this.K){e:{if(this.g){var a,u=this.g;if((a=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(a)){var l=a;break e}}l=null}if(!(n=l)){this.i=!1,this.s=3,Wt(12),be(this),_e(this);break t}jt(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ee(this,n)}this.S?(me(this,c,o),V&&this.i&&3==c&&(Ft(this.U,this.V,"tick",this.mb),this.V.start())):(jt(this.j,this.m,o,null),Ee(this,o)),4==c&&be(this),this.i&&!this.J&&(4==c?Bn(this.l,this):(this.i=!1,ye(this)))}else(function(t){const e={};t=(t.g&&2<=En(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<t.length;i++){if(A(t[i]))continue;var n=St(t[i]);const r=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const s=e[r]||[];e[r]=s,s.push(n)}!function(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,(function(t){return t.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,Wt(12)):(this.s=0,Wt(13)),be(this),_e(this)}}}catch(t){}},i.mb=function(){if(this.g){var t=En(this.g),e=this.g.ja();this.o<e.length&&(we(this),me(this,t,e),this.i&&4!=t&&ye(this))}},i.cancel=function(){this.J=!0,be(this)},i.lb=function(){this.C=null;const t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.B),2!=this.L&&(Gt(),Wt(17)),be(this),this.s=2,_e(this)):ve(this,this.Y-t)};var Se=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ce(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Ce){this.h=t.h,Ae(this,t.j),this.s=t.s,this.g=t.g,ke(this,t.m),this.l=t.l;var e=t.i,n=new Be;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),De(this,n),this.o=t.o}else t&&(e=String(t).match(Se))?(this.h=!1,Ae(this,e[1]||"",!0),this.s=Ne(e[2]||""),this.g=Ne(e[3]||"",!0),ke(this,e[4]),this.l=Ne(e[5]||"",!0),De(this,e[6]||"",!0),this.o=Ne(e[7]||"")):(this.h=!1,this.i=new Be(null,this.h))}function Ie(t){return new Ce(t)}function Ae(t,e,n){t.j=n?Ne(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function ke(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function De(t,e,n){e instanceof Be?(t.i=e,function(t,e){e&&!t.j&&(je(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(qe(this,e),$e(this,n,t))}),t)),t.j=e}(t.i,t.h)):(n||(e=Pe(e,Fe)),t.i=new Be(e,t.h))}function xe(t,e,n){t.i.set(e,n)}function Re(t){return xe(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Ne(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Pe(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Le),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Le(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ce.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Pe(e,Oe,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(Pe(e,Oe,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(Pe(n,"/"==n.charAt(0)?Ve:Me,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Pe(n,Ue)),t.join("")};var Oe=/[#\/\?@]/g,Me=/[#\?:]/g,Ve=/[#\?]/g,Fe=/[#\?@]/g,Ue=/#/g;function Be(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function je(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var s=t[n].substring(0,i);r=t[n].substring(i+1)}else s=t[n];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function qe(t,e){je(t),e=He(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function ze(t,e){return je(t),e=He(t,e),t.g.has(e)}function $e(t,e,n){qe(t,e),0<n.length&&(t.i=null,t.g.set(He(t,e),T(n)),t.h+=n.length)}function He(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(i=Be.prototype).add=function(t,e){je(this),this.i=null,t=He(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},i.forEach=function(t,e){je(this),this.g.forEach((function(n,i){n.forEach((function(n){t.call(e,n,i,this)}),this)}),this)},i.ta=function(){je(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let i=0;i<e.length;i++){const r=t[i];for(let t=0;t<r.length;t++)n.push(e[i])}return n},i.Z=function(t){je(this);let e=[];if("string"==typeof t)ze(this,t)&&(e=e.concat(this.g.get(He(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},i.set=function(t,e){return je(this),this.i=null,ze(this,t=He(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},i.get=function(t,e){return t&&0<(t=this.Z(t)).length?String(t[0]):e},i.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var i=e[n];const s=encodeURIComponent(String(i)),o=this.Z(i);for(i=0;i<o.length;i++){var r=s;""!==o[i]&&(r+="="+encodeURIComponent(String(o[i]))),t.push(r)}}return this.i=t.join("&")};var Ge=class{constructor(t,e){this.g=t,this.map=e}};function Ke(t){this.l=t||We,h.PerformanceNavigationTiming?t=0<(t=h.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(h.g&&h.g.Ka&&h.g.Ka()&&h.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var We=10;function Qe(t){return!!t.h||!!t.g&&t.g.size>=t.j}function Xe(t){return t.h?1:t.g?t.g.size:0}function Ye(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function Je(t,e){t.g?t.g.add(e):t.h=e}function Ze(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function tn(t){if(null!=t.h)return t.i.concat(t.h.F);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return T(t.i)}Ke.prototype.cancel=function(){if(this.i=tn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var en=class{stringify(t){return h.JSON.stringify(t,void 0)}parse(t){return h.JSON.parse(t,void 0)}};function nn(){this.g=new en}function rn(t,e,n){const i=n||"";try{Te(t,(function(t,n){let r=t;f(t)&&(r=_t(t)),e.push(i+n+"="+encodeURIComponent(r))}))}catch(t){throw e.push(i+"type="+encodeURIComponent("_badmap")),t}}function sn(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}function on(t){this.l=t.ec||null,this.j=t.ob||!1}function an(t,e){yt.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=un,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}_(on,Zt),on.prototype.g=function(){return new an(this.l,this.j)},on.prototype.i=function(t){return function(){return t}}({}),_(an,yt);var un=0;function ln(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}function cn(t){t.readyState=4,t.l=null,t.j=null,t.A=null,hn(t)}function hn(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(i=an.prototype).open=function(t,e){if(this.readyState!=un)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,hn(this)},i.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||h).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},i.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,cn(this)),this.readyState=un},i.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,hn(this)),this.g&&(this.readyState=3,hn(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==h.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;ln(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))},i.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?cn(this):hn(this),3==this.readyState&&ln(this)}},i.Za=function(t){this.g&&(this.response=this.responseText=t,cn(this))},i.Ya=function(t){this.g&&(this.response=t,cn(this))},i.ka=function(){this.g&&cn(this)},i.setRequestHeader=function(t,e){this.v.append(t,e)},i.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(an.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var dn=h.JSON.parse;function fn(t){yt.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=pn,this.L=this.M=!1}_(fn,yt);var pn="",mn=/^https?$/i,gn=["POST","PUT"];function yn(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,vn(t),_n(t)}function vn(t){t.F||(t.F=!0,vt(t,"complete"),vt(t,"error"))}function wn(t){if(t.h&&void 0!==c&&(!t.C[1]||4!=En(t)||2!=t.da()))if(t.v&&4==En(t))Pt(t.La,0,t);else if(vt(t,"readystatechange"),4==En(t)){t.h=!1;try{const o=t.da();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var i;if(i=0===o){var r=String(t.I).match(Se)[1]||null;!r&&h.self&&h.self.location&&(r=h.self.location.protocol.slice(0,-1)),i=!mn.test(r?r.toLowerCase():"")}n=i}if(n)vt(t,"complete"),vt(t,"success");else{t.m=6;try{var s=2<En(t)?t.g.statusText:""}catch(t){s=""}t.j=s+" ["+t.da()+"]",vn(t)}}finally{_n(t)}}}function _n(t,e){if(t.g){bn(t);const n=t.g,i=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||vt(t,"ready");try{n.onreadystatechange=i}catch(t){}}}function bn(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(h.clearTimeout(t.A),t.A=null)}function En(t){return t.g?t.g.readyState:0}function Tn(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case pn:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Sn(t){let e="";return J(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function Cn(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}i||(n=Sn(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):xe(t,e,n))}function In(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function An(t){this.Ga=0,this.j=[],this.l=new Bt,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=In("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=In("baseRetryDelayMs",5e3,t),this.hb=In("retryDelaySeedMs",1e4,t),this.eb=In("forwardChannelMaxRetries",2,t),this.xa=In("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new Ke(t&&t.concurrentRequestLimit),this.Ja=new nn,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function kn(t){if(xn(t),3==t.H){var e=t.W++,n=Ie(t.I);if(xe(n,"SID",t.K),xe(n,"RID",e),xe(n,"TYPE","terminate"),Pn(t,n),(e=new ae(t,t.l,e)).L=2,e.A=Re(Ie(n)),n=!1,h.navigator&&h.navigator.sendBeacon)try{n=h.navigator.sendBeacon(e.A.toString(),"")}catch(t){}!n&&h.Image&&((new Image).src=e.A,n=!0),n||(e.g=Hn(e.l,null),e.g.ha(e.A)),e.G=Date.now(),ye(e)}zn(t)}function Dn(t){t.g&&(Vn(t),t.g.cancel(),t.g=null)}function xn(t){Dn(t),t.u&&(h.clearTimeout(t.u),t.u=null),Un(t),t.i.cancel(),t.m&&("number"==typeof t.m&&h.clearTimeout(t.m),t.m=null)}function Rn(t){if(!Qe(t.i)&&!t.m){t.m=!0;var e=t.Na;It||Dt(),At||(It(),At=!0),kt.add(e,t),t.C=0}}function Nn(t,e){var n;n=e?e.m:t.W++;const i=Ie(t.I);xe(i,"SID",t.K),xe(i,"RID",n),xe(i,"AID",t.V),Pn(t,i),t.o&&t.s&&Cn(i,t.o,t.s),n=new ae(t,t.l,n,t.C+1),null===t.o&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=Ln(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),Je(t.i,n),de(n,i,e)}function Pn(t,e){t.na&&J(t.na,(function(t,n){xe(e,n,t)})),t.h&&Te({},(function(t,n){xe(e,n,t)}))}function Ln(t,e,n){n=Math.min(t.j.length,n);var i=t.h?v(t.h.Va,t.h,t):null;t:{var r=t.j;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=r[0].g,t.push("ofs="+e)):e=0:t.push("ofs="+e);let s=!0;for(let o=0;o<n;o++){let n=r[o].g;const a=r[o].map;if(n-=e,0>n)e=Math.max(0,r[o].g-100),s=!1;else try{rn(a,t,"req"+n+"_")}catch(t){i&&i(a)}}if(s){i=t.join("&");break t}}}return t=t.j.splice(0,n),e.F=t,i}function On(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;It||Dt(),At||(It(),At=!0),kt.add(e,t),t.A=0}}function Mn(t){return!(t.g||t.u||3<=t.A)&&(t.ba++,t.u=Xt(v(t.Ma,t),jn(t,t.A)),t.A++,!0)}function Vn(t){null!=t.B&&(h.clearTimeout(t.B),t.B=null)}function Fn(t){t.g=new ae(t,t.l,"rpc",t.ba),null===t.o&&(t.g.I=t.s),t.g.O=0;var e=Ie(t.wa);xe(e,"RID","rpc"),xe(e,"SID",t.K),xe(e,"AID",t.V),xe(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&xe(e,"TO",t.qa),xe(e,"TYPE","xmlhttp"),Pn(t,e),t.o&&t.s&&Cn(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=Re(Ie(e)),n.u=null,n.S=!0,fe(n,t)}function Un(t){null!=t.v&&(h.clearTimeout(t.v),t.v=null)}function Bn(t,e){var n=null;if(t.g==e){Un(t),Vn(t),t.g=null;var i=2}else{if(!Ye(t.i,e))return;n=e.F,Ze(t.i,e),i=1}if(0!=t.H)if(e.i)if(1==i){n=e.u?e.u.length:0,e=Date.now()-e.G;var r=t.C;vt(i=$t(),new Qt(i,n)),Rn(t)}else On(t);else if(3==(r=e.s)||0==r&&0<e.ca||!(1==i&&function(t,e){return!(Xe(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.j=e.F.concat(t.j),0):1==t.H||2==t.H||t.C>=(t.cb?0:t.eb)||(t.m=Xt(v(t.Na,t,e),jn(t,t.C)),t.C++,0)))}(t,e)||2==i&&Mn(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),r){case 1:qn(t,5);break;case 4:qn(t,10);break;case 3:qn(t,6);break;default:qn(t,2)}}function jn(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function qn(t,e){if(t.l.info("Error code "+e),2==e){var n=null;t.h&&(n=null);var i=v(t.pb,t);n||(n=new Ce("//www.google.com/images/cleardot.gif"),h.location&&"http"==h.location.protocol||Ae(n,"https"),Re(n)),function(t,e){const n=new Bt;if(h.Image){const i=new Image;i.onload=w(sn,n,i,"TestLoadImage: loaded",!0,e),i.onerror=w(sn,n,i,"TestLoadImage: error",!1,e),i.onabort=w(sn,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=w(sn,n,i,"TestLoadImage: timeout",!1,e),h.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=t}else e(!1)}(n.toString(),i)}else Wt(2);t.H=0,t.h&&t.h.za(e),zn(t),xn(t)}function zn(t){if(t.H=0,t.ma=[],t.h){const e=tn(t.i);0==e.length&&0==t.j.length||(S(t.ma,e),S(t.ma,t.j),t.i.i.length=0,T(t.j),t.j.length=0),t.h.ya()}}function $n(t,e,n){var i=n instanceof Ce?Ie(n):new Ce(n);if(""!=i.g)e&&(i.g=e+"."+i.g),ke(i,i.m);else{var r=h.location;i=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var s=new Ce(null);i&&Ae(s,i),e&&(s.g=e),r&&ke(s,r),n&&(s.l=n),i=s}return n=t.F,e=t.Da,n&&e&&xe(i,n,e),xe(i,"VER",t.ra),Pn(t,i),i}function Hn(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=t.Ha&&!t.va?new fn(new on({ob:n})):new fn(t.va)).Oa(t.J),e}function Gn(){}function Kn(){if(O&&!(10<=Number(H)))throw Error("Environmental error: no available transport.")}function Wn(t,e){yt.call(this),this.g=new An(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!A(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!A(e)&&(this.g.F=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new Yn(this)}function Qn(t){re.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Xn(){se.call(this),this.status=1}function Yn(t){this.g=t}function Jn(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function Zn(t,e,n){n||(n=0);var i=Array(16);if("string"==typeof e)for(var r=0;16>r;++r)i[r]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(r=0;16>r;++r)i[r]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],r=t.g[2];var s=t.g[3],o=e+(s^n&(r^s))+i[0]+3614090360&4294967295;o=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=(n=(r=(s=(e=n+(o<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(r^s))+i[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(r^s))+i[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(r^s))+i[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(n^r))+i[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(e^n))+i[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^r&(s^e))+i[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(r^s&(n^r))+i[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(n^r))+i[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(n^r))+i[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(n^r))+i[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(e^n))+i[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^n&(s^e))+i[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(r^s))+i[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(n^r^s)+i[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^r^s)+i[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^r^s)+i[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^r^s)+i[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^r)+i[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^n)+i[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^e)+i[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(r^(n|~s))+i[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~n))+i[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~e))+i[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(r^(n|~s))+i[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~n))+i[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~e))+i[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(r^(n|~s))+i[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~n))+i[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~e))+i[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=n+((o=e+(r^(n|~s))+i[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~r))+i[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((r=s+((o=r+(e^(s|~n))+i[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+i[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+r&4294967295,t.g[3]=t.g[3]+s&4294967295}function ti(t,e){this.h=e;for(var n=[],i=!0,r=t.length-1;0<=r;r--){var s=0|t[r];i&&s==e||(n[r]=s,i=!1)}this.g=n}(i=fn.prototype).Oa=function(t){this.M=t},i.ha=function(t,e,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():ne.g(),this.C=this.u?te(this.u):te(ne),this.g.onreadystatechange=v(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(t){return void yn(this,t)}if(t=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)n.set(r,i[r]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const t of i.keys())n.set(t,i.get(t))}i=Array.from(n.keys()).find((t=>"content-type"==t.toLowerCase())),r=h.FormData&&t instanceof h.FormData,!(0<=E(gn,e))||i||r||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[t,e]of n)this.g.setRequestHeader(t,e);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{bn(this),0<this.B&&((this.L=function(t){return O&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=v(this.ua,this)):this.A=Pt(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){yn(this,t)}},i.ua=function(){void 0!==c&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,vt(this,"timeout"),this.abort(8))},i.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,vt(this,"complete"),vt(this,"abort"),_n(this))},i.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),_n(this,!0)),fn.$.N.call(this)},i.La=function(){this.s||(this.G||this.v||this.l?wn(this):this.kb())},i.kb=function(){wn(this)},i.isActive=function(){return!!this.g},i.da=function(){try{return 2<En(this)?this.g.status:-1}catch(t){return-1}},i.ja=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},i.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),dn(e)}},i.Ia=function(){return this.m},i.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(i=An.prototype).ra=8,i.H=1,i.Na=function(t){if(this.m)if(this.m=null,1==this.H){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const r=new ae(this,this.l,t);let s=this.s;if(this.U&&(s?(s=Z(s),et(s,this.U)):s=this.U),null!==this.o||this.O||(r.I=s,s=null),this.P)t:{for(var e=0,n=0;n<this.j.length;n++){var i=this.j[n];if(void 0===(i="__data__"in i.map&&"string"==typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=n;break t}if(4096===e||n===this.j.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=Ln(this,r,e),xe(n=Ie(this.I),"RID",t),xe(n,"CVER",22),this.F&&xe(n,"X-HTTP-Session-Id",this.F),Pn(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(Sn(s)))+"&"+e:this.o&&Cn(n,this.o,s)),Je(this.i,r),this.bb&&xe(n,"TYPE","init"),this.P?(xe(n,"$req",e),xe(n,"SID","null"),r.aa=!0,de(r,n,null)):de(r,n,e),this.H=2}}else 3==this.H&&(t?Nn(this,t):0==this.j.length||Qe(this.i)||Nn(this))},i.Ma=function(){if(this.u=null,Fn(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Xt(v(this.jb,this),t)}},i.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Wt(10),Dn(this),Fn(this))},i.ib=function(){null!=this.v&&(this.v=null,Dn(this),Mn(this),Wt(19))},i.pb=function(t){t?(this.l.info("Successfully pinged google.com"),Wt(2)):(this.l.info("Failed to ping google.com"),Wt(1))},i.isActive=function(){return!!this.h&&this.h.isActive(this)},(i=Gn.prototype).Ba=function(){},i.Aa=function(){},i.za=function(){},i.ya=function(){},i.isActive=function(){return!0},i.Va=function(){},Kn.prototype.g=function(t,e){return new Wn(t,e)},_(Wn,yt),Wn.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;Wt(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=$n(t,null,t.Y),Rn(t)},Wn.prototype.close=function(){kn(this.g)},Wn.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=_t(t),t=n);e.j.push(new Ge(e.fb++,t)),3==e.H&&Rn(e)},Wn.prototype.N=function(){this.g.h=null,delete this.j,kn(this.g),delete this.g,Wn.$.N.call(this)},_(Qn,re),_(Xn,se),_(Yn,Gn),Yn.prototype.Ba=function(){vt(this.g,"a")},Yn.prototype.Aa=function(t){vt(this.g,new Qn(t))},Yn.prototype.za=function(t){vt(this.g,new Xn)},Yn.prototype.ya=function(){vt(this.g,"b")},_(Jn,(function(){this.blockSize=-1})),Jn.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Jn.prototype.j=function(t,e){void 0===e&&(e=t.length);for(var n=e-this.blockSize,i=this.m,r=this.h,s=0;s<e;){if(0==r)for(;s<=n;)Zn(this,t,s),s+=this.blockSize;if("string"==typeof t){for(;s<e;)if(i[r++]=t.charCodeAt(s++),r==this.blockSize){Zn(this,i),r=0;break}}else for(;s<e;)if(i[r++]=t[s++],r==this.blockSize){Zn(this,i),r=0;break}}this.h=r,this.i+=e},Jn.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var i=0;32>i;i+=8)t[n++]=this.g[e]>>>i&255;return t};var ei={};function ni(t){return-128<=t&&128>t?function(t,e){var n=ei;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,(function(t){return new ti([0|t],0>t?-1:0)})):new ti([0|t],0>t?-1:0)}function ii(t){if(isNaN(t)||!isFinite(t))return si;if(0>t)return ci(ii(-t));for(var e=[],n=1,i=0;t>=n;i++)e[i]=t/n|0,n*=ri;return new ti(e,0)}var ri=4294967296,si=ni(0),oi=ni(1),ai=ni(16777216);function ui(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function li(t){return-1==t.h}function ci(t){for(var e=t.g.length,n=[],i=0;i<e;i++)n[i]=~t.g[i];return new ti(n,~t.h).add(oi)}function hi(t,e){return t.add(ci(e))}function di(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function fi(t,e){this.g=t,this.h=e}function pi(t,e){if(ui(e))throw Error("division by zero");if(ui(t))return new fi(si,si);if(li(t))return e=pi(ci(t),e),new fi(ci(e.g),ci(e.h));if(li(e))return e=pi(t,ci(e)),new fi(ci(e.g),e.h);if(30<t.g.length){if(li(t)||li(e))throw Error("slowDivide_ only works with positive integers.");for(var n=oi,i=e;0>=i.X(t);)n=mi(n),i=mi(i);var r=gi(n,1),s=gi(i,1);for(i=gi(i,2),n=gi(n,2);!ui(i);){var o=s.add(i);0>=o.X(t)&&(r=r.add(n),s=o),i=gi(i,1),n=gi(n,1)}return e=hi(t,r.R(e)),new fi(r,e)}for(r=si;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),i=48>=(i=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,i-48),o=(s=ii(n)).R(e);li(o)||0<o.X(t);)o=(s=ii(n-=i)).R(e);ui(s)&&(s=oi),r=r.add(s),t=hi(t,o)}return new fi(r,t)}function mi(t){for(var e=t.g.length+1,n=[],i=0;i<e;i++)n[i]=t.D(i)<<1|t.D(i-1)>>>31;return new ti(n,t.h)}function gi(t,e){var n=e>>5;e%=32;for(var i=t.g.length-n,r=[],s=0;s<i;s++)r[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new ti(r,t.h)}(i=ti.prototype).ea=function(){if(li(this))return-ci(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var i=this.D(n);t+=(0<=i?i:ri+i)*e,e*=ri}return t},i.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(ui(this))return"0";if(li(this))return"-"+ci(this).toString(t);for(var e=ii(Math.pow(t,6)),n=this,i="";;){var r=pi(n,e).g,s=((0<(n=hi(n,r.R(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(ui(n=r))return s+i;for(;6>s.length;)s="0"+s;i=s+i}},i.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},i.X=function(t){return li(t=hi(this,t))?-1:ui(t)?0:1},i.abs=function(){return li(this)?ci(this):this},i.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0,r=0;r<=e;r++){var s=i+(65535&this.D(r))+(65535&t.D(r)),o=(s>>>16)+(this.D(r)>>>16)+(t.D(r)>>>16);i=o>>>16,s&=65535,o&=65535,n[r]=o<<16|s}return new ti(n,-2147483648&n[n.length-1]?-1:0)},i.R=function(t){if(ui(this)||ui(t))return si;if(li(this))return li(t)?ci(this).R(ci(t)):ci(ci(this).R(t));if(li(t))return ci(this.R(ci(t)));if(0>this.X(ai)&&0>t.X(ai))return ii(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],i=0;i<2*e;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var r=0;r<t.g.length;r++){var s=this.D(i)>>>16,o=65535&this.D(i),a=t.D(r)>>>16,u=65535&t.D(r);n[2*i+2*r]+=o*u,di(n,2*i+2*r),n[2*i+2*r+1]+=s*u,di(n,2*i+2*r+1),n[2*i+2*r+1]+=o*a,di(n,2*i+2*r+1),n[2*i+2*r+2]+=s*a,di(n,2*i+2*r+2)}for(i=0;i<e;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=e;i<2*e;i++)n[i]=0;return new ti(n,0)},i.gb=function(t){return pi(this,t).h},i.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)&t.D(i);return new ti(n,this.h&t.h)},i.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)|t.D(i);return new ti(n,this.h|t.h)},i.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)^t.D(i);return new ti(n,this.h^t.h)},Kn.prototype.createWebChannel=Kn.prototype.g,Wn.prototype.send=Wn.prototype.u,Wn.prototype.open=Wn.prototype.m,Wn.prototype.close=Wn.prototype.close,Yt.NO_ERROR=0,Yt.TIMEOUT=8,Yt.HTTP_ERROR=6,Jt.COMPLETE="complete",ee.EventType=ie,ie.OPEN="a",ie.CLOSE="b",ie.ERROR="c",ie.MESSAGE="d",yt.prototype.listen=yt.prototype.O,fn.prototype.listenOnce=fn.prototype.P,fn.prototype.getLastError=fn.prototype.Sa,fn.prototype.getLastErrorCode=fn.prototype.Ia,fn.prototype.getStatus=fn.prototype.da,fn.prototype.getResponseJson=fn.prototype.Wa,fn.prototype.getResponseText=fn.prototype.ja,fn.prototype.send=fn.prototype.ha,fn.prototype.setWithCredentials=fn.prototype.Oa,Jn.prototype.digest=Jn.prototype.l,Jn.prototype.reset=Jn.prototype.reset,Jn.prototype.update=Jn.prototype.j,ti.prototype.add=ti.prototype.add,ti.prototype.multiply=ti.prototype.R,ti.prototype.modulo=ti.prototype.gb,ti.prototype.compare=ti.prototype.X,ti.prototype.toNumber=ti.prototype.ea,ti.prototype.toString=ti.prototype.toString,ti.prototype.getBits=ti.prototype.D,ti.fromNumber=ii,ti.fromString=function t(e,n){if(0==e.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return ci(t(e.substring(1),n));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=ii(Math.pow(n,8)),r=si,s=0;s<e.length;s+=8){var o=Math.min(8,e.length-s),a=parseInt(e.substring(s,s+o),n);8>o?(o=ii(Math.pow(n,o)),r=r.R(o).add(ii(a))):r=(r=r.R(i)).add(ii(a))}return r};var yi=l.createWebChannelTransport=function(){return new Kn},vi=l.getStatEventTarget=function(){return $t()},wi=l.ErrorCode=Yt,_i=l.EventType=Jt,bi=l.Event=qt,Ei=l.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Ti=(l.FetchXmlHttpFactory=on,l.WebChannel=ee),Si=l.XhrIo=fn,Ci=l.Md5=Jn,Ii=l.Integer=ti;const Ai="@firebase/firestore";class ki{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}ki.UNAUTHENTICATED=new ki(null),ki.GOOGLE_CREDENTIALS=new ki("google-credentials-uid"),ki.FIRST_PARTY=new ki("first-party-uid"),ki.MOCK_USER=new ki("mock-user");let Di="10.7.0";const xi=new o.Yd("@firebase/firestore");function Ri(){return xi.logLevel}function Ni(t,...e){if(xi.logLevel<=o.in.DEBUG){const n=e.map(Oi);xi.debug(`Firestore (${Di}): ${t}`,...n)}}function Pi(t,...e){if(xi.logLevel<=o.in.ERROR){const n=e.map(Oi);xi.error(`Firestore (${Di}): ${t}`,...n)}}function Li(t,...e){if(xi.logLevel<=o.in.WARN){const n=e.map(Oi);xi.warn(`Firestore (${Di}): ${t}`,...n)}}function Oi(t){if("string"==typeof t)return t;try{return function(t){return JSON.stringify(t)}(t)}catch(e){return t}}function Mi(t="Unexpected state"){const e=`FIRESTORE (${Di}) INTERNAL ASSERTION FAILED: `+t;throw Pi(e),new Error(e)}function Vi(t,e){t||Mi()}function Fi(t,e){return t}const Ui={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Bi extends a.ZR{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ji{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class qi{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class zi{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(ki.UNAUTHENTICATED)))}shutdown(){}}class $i{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class Hi{constructor(t){this.t=t,this.currentUser=ki.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const i=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let r=new ji;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new ji,t.enqueueRetryable((()=>i(this.currentUser)))};const s=()=>{const e=r;t.enqueueRetryable((async()=>{await e.promise,await i(this.currentUser)}))},o=t=>{Ni("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((t=>o(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(Ni("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new ji)}}),0),s()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(Ni("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(Vi("string"==typeof e.accessToken),new qi(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return Vi(null===t||"string"==typeof t),new ki(t)}}class Gi{constructor(t,e,n){this.l=t,this.h=e,this.P=n,this.type="FirstParty",this.user=ki.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Ki{constructor(t,e,n){this.l=t,this.h=e,this.P=n}getToken(){return Promise.resolve(new Gi(this.l,this.h,this.P))}start(t,e){t.enqueueRetryable((()=>e(ki.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Wi{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Qi{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,e){const n=t=>{null!=t.error&&Ni("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.R;return this.R=t.token,Ni("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const i=t=>{Ni("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.A.onInit((t=>i(t))),setTimeout((()=>{if(!this.appCheck){const t=this.A.getImmediate({optional:!0});t?i(t):Ni("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(Vi("string"==typeof t.token),this.R=t.token,new Wi(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Xi(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class Yi{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(256/62);let n="";for(;n.length<20;){const i=Xi(40);for(let r=0;r<i.length;++r)n.length<20&&i[r]<e&&(n+=t.charAt(i[r]%62))}return n}}function Ji(t,e){return t<e?-1:t>e?1:0}function Zi(t,e,n){return t.length===e.length&&t.every(((t,i)=>n(t,e[i])))}class tr{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Bi(Ui.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Bi(Ui.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Bi(Ui.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Bi(Ui.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return tr.fromMillis(Date.now())}static fromDate(t){return tr.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new tr(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?Ji(this.nanoseconds,t.nanoseconds):Ji(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class er{constructor(t){this.timestamp=t}static fromTimestamp(t){return new er(t)}static min(){return new er(new tr(0,0))}static max(){return new er(new tr(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class nr{constructor(t,e,n){void 0===e?e=0:e>t.length&&Mi(),void 0===n?n=t.length-e:n>t.length-e&&Mi(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===nr.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof nr?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const n=t.get(i),r=e.get(i);if(n<r)return-1;if(n>r)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class ir extends nr{construct(t,e,n){return new ir(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new Bi(Ui.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new ir(e)}static emptyPath(){return new ir([])}}const rr=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class sr extends nr{construct(t,e,n){return new sr(t,e,n)}static isValidIdentifier(t){return rr.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),sr.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new sr(["__name__"])}static fromServerFormat(t){const e=[];let n="",i=0;const r=()=>{if(0===n.length)throw new Bi(Ui.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let s=!1;for(;i<t.length;){const e=t[i];if("\\"===e){if(i+1===t.length)throw new Bi(Ui.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[i+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new Bi(Ui.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,i+=2}else"`"===e?(s=!s,i++):"."!==e||s?(n+=e,i++):(r(),i++)}if(r(),s)throw new Bi(Ui.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new sr(e)}static emptyPath(){return new sr([])}}class or{constructor(t){this.path=t}static fromPath(t){return new or(ir.fromString(t))}static fromName(t){return new or(ir.fromString(t).popFirst(5))}static empty(){return new or(ir.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===ir.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return ir.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new or(new ir(t.slice()))}}class ar{constructor(t,e,n,i){this.indexId=t,this.collectionGroup=e,this.fields=n,this.indexState=i}}ar.UNKNOWN_ID=-1;function ur(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,r=er.fromTimestamp(1e9===i?new tr(n+1,0):new tr(n,i));return new cr(r,or.empty(),e)}function lr(t){return new cr(t.readTime,t.key,-1)}class cr{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new cr(er.min(),or.empty(),-1)}static max(){return new cr(er.max(),or.empty(),-1)}}function hr(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=or.comparator(t.documentKey,e.documentKey),0!==n?n:Ji(t.largestBatchId,e.largestBatchId))}const dr="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class fr{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function pr(t){if(t.code!==Ui.FAILED_PRECONDITION||t.message!==dr)throw t;Ni("LocalStore","Unexpectedly lost primary lease")}class mr{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&Mi(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new mr(((n,i)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,i)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof mr?e:mr.resolve(e)}catch(t){return mr.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):mr.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):mr.reject(e)}static resolve(t){return new mr(((e,n)=>{e(t)}))}static reject(t){return new mr(((e,n)=>{n(t)}))}static waitFor(t){return new mr(((e,n)=>{let i=0,r=0,s=!1;t.forEach((t=>{++i,t.next((()=>{++r,s&&r===i&&e()}),(t=>n(t)))})),s=!0,r===i&&e()}))}static or(t){let e=mr.resolve(!1);for(const n of t)e=e.next((t=>t?mr.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,i)=>{n.push(e.call(this,t,i))})),this.waitFor(n)}static mapArray(t,e){return new mr(((n,i)=>{const r=t.length,s=new Array(r);let o=0;for(let a=0;a<r;a++){const u=a;e(t[u]).next((t=>{s[u]=t,++o,o===r&&n(s)}),(t=>i(t)))}}))}static doWhile(t,e){return new mr(((n,i)=>{const r=()=>{!0===t()?e().next((()=>{r()}),i):n()};r()}))}}function gr(t){return"IndexedDbTransactionError"===t.name}class yr{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.se(t),this.oe=t=>e.writeSequenceNumber(t))}se(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.oe&&this.oe(t),t}}function vr(t){return null==t}function wr(t){return 0===t&&1/t==-1/0}function _r(t){return"number"==typeof t&&Number.isInteger(t)&&!wr(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}yr._e=-1;const br=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Er=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Tr=Er;function Sr(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Cr(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ir(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class Ar{constructor(t,e){this.comparator=t,this.root=e||Dr.EMPTY}insert(t,e){return new Ar(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Dr.BLACK,null,null))}remove(t){return new Ar(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Dr.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new kr(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new kr(this.root,t,this.comparator,!1)}getReverseIterator(){return new kr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new kr(this.root,t,this.comparator,!0)}}class kr{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=e?n(t.key,e):1,e&&i&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(0===r){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Dr{constructor(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:Dr.RED,this.left=null!=i?i:Dr.EMPTY,this.right=null!=r?r:Dr.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,r){return new Dr(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const r=n(t,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Dr.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return Dr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Dr.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Dr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Mi();if(this.right.isRed())throw Mi();const t=this.left.check();if(t!==this.right.check())throw Mi();return t+(this.isRed()?0:1)}}Dr.EMPTY=null,Dr.RED=!0,Dr.BLACK=!1,Dr.EMPTY=new class{constructor(){this.size=0}get key(){throw Mi()}get value(){throw Mi()}get color(){throw Mi()}get left(){throw Mi()}get right(){throw Mi()}copy(t,e,n,i,r){return this}insert(t,e,n){return new Dr(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class xr{constructor(t){this.comparator=t,this.data=new Ar(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new Rr(this.data.getIterator())}getIteratorFrom(t){return new Rr(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof xr))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(t,i))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new xr(this.comparator);return e.data=t,e}}class Rr{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Nr{constructor(t){this.fields=t,t.sort(sr.comparator)}static empty(){return new Nr([])}unionWith(t){let e=new xr(sr.comparator);for(const t of this.fields)e=e.add(t);for(const n of t)e=e.add(n);return new Nr(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Zi(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class Pr extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Lr{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new Pr("Invalid base64 string: "+t):t}}(t);return new Lr(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new Lr(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Ji(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Lr.EMPTY_BYTE_STRING=new Lr("");const Or=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Mr(t){if(Vi(!!t),"string"==typeof t){let e=0;const n=Or.exec(t);if(Vi(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Vr(t.seconds),nanos:Vr(t.nanos)}}function Vr(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Fr(t){return"string"==typeof t?Lr.fromBase64String(t):Lr.fromUint8Array(t)}function Ur(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Br(t){const e=t.mapValue.fields.__previous_value__;return Ur(e)?Br(e):e}function jr(t){const e=Mr(t.mapValue.fields.__local_write_time__.timestampValue);return new tr(e.seconds,e.nanos)}class qr{constructor(t,e,n,i,r,s,o,a,u){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=u}}class zr{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new zr("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof zr&&t.projectId===this.projectId&&t.database===this.database}}const $r={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Hr(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ur(t)?4:rs(t)?9007199254740991:10:Mi()}function Gr(t,e){if(t===e)return!0;const n=Hr(t);if(n!==Hr(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return jr(t).isEqual(jr(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=Mr(t.timestampValue),i=Mr(e.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Fr(t.bytesValue).isEqual(Fr(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Vr(t.geoPointValue.latitude)===Vr(e.geoPointValue.latitude)&&Vr(t.geoPointValue.longitude)===Vr(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Vr(t.integerValue)===Vr(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=Vr(t.doubleValue),i=Vr(e.doubleValue);return n===i?wr(n)===wr(i):isNaN(n)&&isNaN(i)}return!1}(t,e);case 9:return Zi(t.arrayValue.values||[],e.arrayValue.values||[],Gr);case 10:return function(t,e){const n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(Sr(n)!==Sr(i))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===i[t]||!Gr(n[t],i[t])))return!1;return!0}(t,e);default:return Mi()}}function Kr(t,e){return void 0!==(t.values||[]).find((t=>Gr(t,e)))}function Wr(t,e){if(t===e)return 0;const n=Hr(t),i=Hr(e);if(n!==i)return Ji(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ji(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=Vr(t.integerValue||t.doubleValue),i=Vr(e.integerValue||e.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(t,e);case 3:return Qr(t.timestampValue,e.timestampValue);case 4:return Qr(jr(t),jr(e));case 5:return Ji(t.stringValue,e.stringValue);case 6:return function(t,e){const n=Fr(t),i=Fr(e);return n.compareTo(i)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),i=e.split("/");for(let t=0;t<n.length&&t<i.length;t++){const e=Ji(n[t],i[t]);if(0!==e)return e}return Ji(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=Ji(Vr(t.latitude),Vr(e.latitude));return 0!==n?n:Ji(Vr(t.longitude),Vr(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],i=e.values||[];for(let t=0;t<n.length&&t<i.length;++t){const e=Wr(n[t],i[t]);if(e)return e}return Ji(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===$r.mapValue&&e===$r.mapValue)return 0;if(t===$r.mapValue)return 1;if(e===$r.mapValue)return-1;const n=t.fields||{},i=Object.keys(n),r=e.fields||{},s=Object.keys(r);i.sort(),s.sort();for(let t=0;t<i.length&&t<s.length;++t){const e=Ji(i[t],s[t]);if(0!==e)return e;const o=Wr(n[i[t]],r[s[t]]);if(0!==o)return o}return Ji(i.length,s.length)}(t.mapValue,e.mapValue);default:throw Mi()}}function Qr(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ji(t,e);const n=Mr(t),i=Mr(e),r=Ji(n.seconds,i.seconds);return 0!==r?r:Ji(n.nanos,i.nanos)}function Xr(t){return Yr(t)}function Yr(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=Mr(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(t){return Fr(t).toBase64()}(t.bytesValue):"referenceValue"in t?function(t){return or.fromName(t).toString()}(t.referenceValue):"geoPointValue"in t?function(t){return`geo(${t.latitude},${t.longitude})`}(t.geoPointValue):"arrayValue"in t?function(t){let e="[",n=!0;for(const i of t.values||[])n?n=!1:e+=",",e+=Yr(i);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",i=!0;for(const r of e)i?i=!1:n+=",",n+=`${r}:${Yr(t.fields[r])}`;return n+"}"}(t.mapValue):Mi()}function Jr(t){return!!t&&"integerValue"in t}function Zr(t){return!!t&&"arrayValue"in t}function ts(t){return!!t&&"nullValue"in t}function es(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ns(t){return!!t&&"mapValue"in t}function is(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Cr(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=is(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=is(t.arrayValue.values[n]);return e}return Object.assign({},t)}function rs(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}class ss{constructor(t){this.value=t}static empty(){return new ss({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!ns(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=is(e)}setAll(t){let e=sr.emptyPath(),n={},i=[];t.forEach(((t,r)=>{if(!e.isImmediateParentOf(r)){const t=this.getFieldsMap(e);this.applyChanges(t,n,i),n={},i=[],e=r.popLast()}t?n[r.lastSegment()]=is(t):i.push(r.lastSegment())}));const r=this.getFieldsMap(e);this.applyChanges(r,n,i)}delete(t){const e=this.field(t.popLast());ns(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Gr(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];ns(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){Cr(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new ss(is(this.value))}}function os(t){const e=[];return Cr(t.fields,((t,n)=>{const i=new sr([t]);if(ns(n)){const t=os(n.mapValue).fields;if(0===t.length)e.push(i);else for(const n of t)e.push(i.child(n))}else e.push(i)})),new Nr(e)}class as{constructor(t,e,n,i,r,s,o){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.createTime=r,this.data=s,this.documentState=o}static newInvalidDocument(t){return new as(t,0,er.min(),er.min(),er.min(),ss.empty(),0)}static newFoundDocument(t,e,n,i){return new as(t,1,e,er.min(),n,i,0)}static newNoDocument(t,e){return new as(t,2,e,er.min(),er.min(),ss.empty(),0)}static newUnknownDocument(t,e){return new as(t,3,e,er.min(),er.min(),ss.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(er.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=ss.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=ss.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=er.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof as&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new as(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class us{constructor(t,e){this.position=t,this.inclusive=e}}function ls(t,e,n){let i=0;for(let r=0;r<t.position.length;r++){const s=e[r],o=t.position[r];if(i=s.field.isKeyField()?or.comparator(or.fromName(o.referenceValue),n.key):Wr(o,n.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function cs(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Gr(t.position[n],e.position[n]))return!1;return!0}class hs{constructor(t,e="asc"){this.field=t,this.dir=e}}function ds(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class fs{}class ps extends fs{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new Es(t,e,n):"array-contains"===e?new Is(t,n):"in"===e?new As(t,n):"not-in"===e?new ks(t,n):"array-contains-any"===e?new Ds(t,n):new ps(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new Ts(t,n):new Ss(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(Wr(e,this.value)):null!==e&&Hr(this.value)===Hr(e)&&this.matchesComparison(Wr(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Mi()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ms extends fs{constructor(t,e){super(),this.filters=t,this.op=e,this.ue=null}static create(t,e){return new ms(t,e)}matches(t){return gs(this)?void 0===this.filters.find((e=>!e.matches(t))):void 0!==this.filters.find((e=>e.matches(t)))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function gs(t){return"and"===t.op}function ys(t){return vs(t)&&gs(t)}function vs(t){for(const e of t.filters)if(e instanceof ms)return!1;return!0}function ws(t){if(t instanceof ps)return t.field.canonicalString()+t.op.toString()+Xr(t.value);if(ys(t))return t.filters.map((t=>ws(t))).join(",");{const e=t.filters.map((t=>ws(t))).join(",");return`${t.op}(${e})`}}function _s(t,e){return t instanceof ps?function(t,e){return e instanceof ps&&t.op===e.op&&t.field.isEqual(e.field)&&Gr(t.value,e.value)}(t,e):t instanceof ms?function(t,e){return e instanceof ms&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce(((t,n,i)=>t&&_s(n,e.filters[i])),!0)}(t,e):void Mi()}function bs(t){return t instanceof ps?function(t){return`${t.field.canonicalString()} ${t.op} ${Xr(t.value)}`}(t):t instanceof ms?function(t){return t.op.toString()+" {"+t.getFilters().map(bs).join(" ,")+"}"}(t):"Filter"}class Es extends ps{constructor(t,e,n){super(t,e,n),this.key=or.fromName(n.referenceValue)}matches(t){const e=or.comparator(t.key,this.key);return this.matchesComparison(e)}}class Ts extends ps{constructor(t,e){super(t,"in",e),this.keys=Cs("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class Ss extends ps{constructor(t,e){super(t,"not-in",e),this.keys=Cs("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function Cs(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>or.fromName(t.referenceValue)))}class Is extends ps{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Zr(e)&&Kr(e.arrayValue,this.value)}}class As extends ps{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Kr(this.value.arrayValue,e)}}class ks extends ps{constructor(t,e){super(t,"not-in",e)}matches(t){if(Kr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!Kr(this.value.arrayValue,e)}}class Ds extends ps{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Zr(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>Kr(this.value.arrayValue,t)))}}class xs{constructor(t,e=null,n=[],i=[],r=null,s=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=s,this.endAt=o,this.ce=null}}function Rs(t,e=null,n=[],i=[],r=null,s=null,o=null){return new xs(t,e,n,i,r,s,o)}function Ns(t){const e=Fi(t);if(null===e.ce){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>ws(t))).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),vr(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>Xr(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>Xr(t))).join(",")),e.ce=t}return e.ce}function Ps(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!ds(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!_s(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!cs(t.startAt,e.startAt)&&cs(t.endAt,e.endAt)}function Ls(t){return or.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}class Os{constructor(t,e=null,n=[],i=[],r=null,s="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=s,this.startAt=o,this.endAt=a,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function Ms(t,e,n,i,r,s,o,a){return new Os(t,e,n,i,r,s,o,a)}function Vs(t){return new Os(t)}function Fs(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function Us(t){return null!==t.collectionGroup}function Bs(t){const e=Fi(t);if(null===e.le){e.le=[];const t=new Set;for(const n of e.explicitOrderBy)e.le.push(n),t.add(n.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc",i=function(t){let e=new xr(sr.comparator);return t.filters.forEach((t=>{t.getFlattenedFilters().forEach((t=>{t.isInequality()&&(e=e.add(t.field))}))})),e}(e);i.forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.le.push(new hs(i,n))})),t.has(sr.keyField().canonicalString())||e.le.push(new hs(sr.keyField(),n))}return e.le}function js(t){const e=Fi(t);return e.he||(e.he=qs(e,Bs(t))),e.he}function qs(t,e){if("F"===t.limitType)return Rs(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((t=>{const e="desc"===t.dir?"asc":"desc";return new hs(t.field,e)}));const n=t.endAt?new us(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new us(t.startAt.position,t.startAt.inclusive):null;return Rs(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}}function zs(t,e,n){return new Os(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function $s(t,e){return Ps(js(t),js(e))&&t.limitType===e.limitType}function Hs(t){return`${Ns(js(t))}|lt:${t.limitType}`}function Gs(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>bs(t))).join(", ")}]`),vr(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>Xr(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>Xr(t))).join(",")),`Target(${e})`}(js(t))}; limitType=${t.limitType})`}function Ks(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):or.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of Bs(t))if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const i=ls(t,e,n);return t.inclusive?i<=0:i<0}(t.startAt,Bs(t),e))&&!(t.endAt&&!function(t,e,n){const i=ls(t,e,n);return t.inclusive?i>=0:i>0}(t.endAt,Bs(t),e))}(t,e)}function Ws(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Qs(t){return(e,n)=>{let i=!1;for(const r of Bs(t)){const t=Xs(r,e,n);if(0!==t)return t;i=i||r.field.isKeyField()}return 0}}function Xs(t,e,n){const i=t.field.isKeyField()?or.comparator(e.key,n.key):function(t,e,n){const i=e.data.field(t),r=n.data.field(t);return null!==i&&null!==r?Wr(i,r):Mi()}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return Mi()}}class Ys{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,i]of n)if(this.equalsFn(e,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(void 0===i)return this.inner[n]=[[t,e]],void this.innerSize++;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],t))return void(i[n]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return 1===n.length?delete this.inner[e]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){Cr(this.inner,((e,n)=>{for(const[e,i]of n)t(e,i)}))}isEmpty(){return Ir(this.inner)}size(){return this.innerSize}}const Js=new Ar(or.comparator);function Zs(){return Js}const to=new Ar(or.comparator);function eo(...t){let e=to;for(const n of t)e=e.insert(n.key,n);return e}function no(t){let e=to;return t.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function io(){return so()}function ro(){return so()}function so(){return new Ys((t=>t.toString()),((t,e)=>t.isEqual(e)))}const oo=new Ar(or.comparator),ao=new xr(or.comparator);function uo(...t){let e=ao;for(const n of t)e=e.add(n);return e}const lo=new xr(Ji);function co(){return lo}function ho(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:wr(e)?"-0":e}}function fo(t){return{integerValue:""+t}}function po(t,e){return _r(e)?fo(e):ho(t,e)}class mo{constructor(){this._=void 0}}function go(t,e,n){return t instanceof wo?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&Ur(e)&&(e=Br(e)),e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof _o?bo(t,e):t instanceof Eo?To(t,e):function(t,e){const n=vo(t,e),i=Co(n)+Co(t.Ie);return Jr(n)&&Jr(t.Ie)?fo(i):ho(t.serializer,i)}(t,e)}function yo(t,e,n){return t instanceof _o?bo(t,e):t instanceof Eo?To(t,e):n}function vo(t,e){return t instanceof So?function(t){return Jr(t)||function(t){return!!t&&"doubleValue"in t}(t)}(e)?e:{integerValue:0}:null}class wo extends mo{}class _o extends mo{constructor(t){super(),this.elements=t}}function bo(t,e){const n=Io(e);for(const e of t.elements)n.some((t=>Gr(t,e)))||n.push(e);return{arrayValue:{values:n}}}class Eo extends mo{constructor(t){super(),this.elements=t}}function To(t,e){let n=Io(e);for(const e of t.elements)n=n.filter((t=>!Gr(t,e)));return{arrayValue:{values:n}}}class So extends mo{constructor(t,e){super(),this.serializer=t,this.Ie=e}}function Co(t){return Vr(t.integerValue||t.doubleValue)}function Io(t){return Zr(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Ao{constructor(t,e){this.version=t,this.transformResults=e}}class ko{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new ko}static exists(t){return new ko(void 0,t)}static updateTime(t){return new ko(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Do(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class xo{}function Ro(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new jo(t.key,ko.none()):new Mo(t.key,t.data,ko.none());{const n=t.data,i=ss.empty();let r=new xr(sr.comparator);for(let t of e.fields)if(!r.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?i.delete(t):i.set(t,e),r=r.add(t)}return new Vo(t.key,i,new Nr(r.toArray()),ko.none())}}function No(t,e,n){t instanceof Mo?function(t,e,n){const i=t.value.clone(),r=Uo(t.fieldTransforms,e,n.transformResults);i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):t instanceof Vo?function(t,e,n){if(!Do(t.precondition,e))return void e.convertToUnknownDocument(n.version);const i=Uo(t.fieldTransforms,e,n.transformResults),r=e.data;r.setAll(Fo(t)),r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Po(t,e,n,i){return t instanceof Mo?function(t,e,n,i){if(!Do(t.precondition,e))return n;const r=t.value.clone(),s=Bo(t.fieldTransforms,i,e);return r.setAll(s),e.convertToFoundDocument(e.version,r).setHasLocalMutations(),null}(t,e,n,i):t instanceof Vo?function(t,e,n,i){if(!Do(t.precondition,e))return n;const r=Bo(t.fieldTransforms,i,e),s=e.data;return s.setAll(Fo(t)),s.setAll(r),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map((t=>t.field)))}(t,e,n,i):function(t,e,n){return Do(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function Lo(t,e){let n=null;for(const i of t.fieldTransforms){const t=e.data.field(i.field),r=vo(i.transform,t||null);null!=r&&(null===n&&(n=ss.empty()),n.set(i.field,r))}return n||null}function Oo(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Zi(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof _o&&e instanceof _o||t instanceof Eo&&e instanceof Eo?Zi(t.elements,e.elements,Gr):t instanceof So&&e instanceof So?Gr(t.Ie,e.Ie):t instanceof wo&&e instanceof wo}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Mo extends xo{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Vo extends xo{constructor(t,e,n,i,r=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function Fo(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function Uo(t,e,n){const i=new Map;Vi(t.length===n.length);for(let r=0;r<n.length;r++){const s=t[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,yo(o,a,n[r]))}return i}function Bo(t,e,n){const i=new Map;for(const r of t){const t=r.transform,s=n.data.field(r.field);i.set(r.field,go(t,s,e))}return i}class jo extends xo{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class qo extends xo{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class zo{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const i=this.mutations[e];i.key.isEqual(t.key)&&No(i,t,n[e])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=Po(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=Po(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=ro();return this.mutations.forEach((i=>{const r=t.get(i.key),s=r.overlayedDocument;let o=this.applyToLocalView(s,r.mutatedFields);o=e.has(i.key)?null:o;const a=Ro(s,o);null!==a&&n.set(i.key,a),s.isValidDocument()||s.convertToNoDocument(er.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),uo())}isEqual(t){return this.batchId===t.batchId&&Zi(this.mutations,t.mutations,((t,e)=>Oo(t,e)))&&Zi(this.baseMutations,t.baseMutations,((t,e)=>Oo(t,e)))}}class $o{constructor(t,e,n,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=i}static from(t,e,n){Vi(t.mutations.length===n.length);let i=oo;const r=t.mutations;for(let t=0;t<r.length;t++)i=i.insert(r[t].key,n[t].version);return new $o(t,e,n,i)}}class Ho{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Go{constructor(t,e){this.count=t,this.unchangedNames=e}}var Ko,Wo;function Qo(t){switch(t){default:return Mi();case Ui.CANCELLED:case Ui.UNKNOWN:case Ui.DEADLINE_EXCEEDED:case Ui.RESOURCE_EXHAUSTED:case Ui.INTERNAL:case Ui.UNAVAILABLE:case Ui.UNAUTHENTICATED:return!1;case Ui.INVALID_ARGUMENT:case Ui.NOT_FOUND:case Ui.ALREADY_EXISTS:case Ui.PERMISSION_DENIED:case Ui.FAILED_PRECONDITION:case Ui.ABORTED:case Ui.OUT_OF_RANGE:case Ui.UNIMPLEMENTED:case Ui.DATA_LOSS:return!0}}function Xo(t){if(void 0===t)return Pi("GRPC error has no .code"),Ui.UNKNOWN;switch(t){case Ko.OK:return Ui.OK;case Ko.CANCELLED:return Ui.CANCELLED;case Ko.UNKNOWN:return Ui.UNKNOWN;case Ko.DEADLINE_EXCEEDED:return Ui.DEADLINE_EXCEEDED;case Ko.RESOURCE_EXHAUSTED:return Ui.RESOURCE_EXHAUSTED;case Ko.INTERNAL:return Ui.INTERNAL;case Ko.UNAVAILABLE:return Ui.UNAVAILABLE;case Ko.UNAUTHENTICATED:return Ui.UNAUTHENTICATED;case Ko.INVALID_ARGUMENT:return Ui.INVALID_ARGUMENT;case Ko.NOT_FOUND:return Ui.NOT_FOUND;case Ko.ALREADY_EXISTS:return Ui.ALREADY_EXISTS;case Ko.PERMISSION_DENIED:return Ui.PERMISSION_DENIED;case Ko.FAILED_PRECONDITION:return Ui.FAILED_PRECONDITION;case Ko.ABORTED:return Ui.ABORTED;case Ko.OUT_OF_RANGE:return Ui.OUT_OF_RANGE;case Ko.UNIMPLEMENTED:return Ui.UNIMPLEMENTED;case Ko.DATA_LOSS:return Ui.DATA_LOSS;default:return Mi()}}(Wo=Ko||(Ko={}))[Wo.OK=0]="OK",Wo[Wo.CANCELLED=1]="CANCELLED",Wo[Wo.UNKNOWN=2]="UNKNOWN",Wo[Wo.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Wo[Wo.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Wo[Wo.NOT_FOUND=5]="NOT_FOUND",Wo[Wo.ALREADY_EXISTS=6]="ALREADY_EXISTS",Wo[Wo.PERMISSION_DENIED=7]="PERMISSION_DENIED",Wo[Wo.UNAUTHENTICATED=16]="UNAUTHENTICATED",Wo[Wo.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Wo[Wo.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Wo[Wo.ABORTED=10]="ABORTED",Wo[Wo.OUT_OF_RANGE=11]="OUT_OF_RANGE",Wo[Wo.UNIMPLEMENTED=12]="UNIMPLEMENTED",Wo[Wo.INTERNAL=13]="INTERNAL",Wo[Wo.UNAVAILABLE=14]="UNAVAILABLE",Wo[Wo.DATA_LOSS=15]="DATA_LOSS";let Yo=null;function Jo(){return new TextEncoder}const Zo=new Ii([4294967295,4294967295],0);function ta(t){const e=Jo().encode(t),n=new Ci;return n.update(e),new Uint8Array(n.digest())}function ea(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ii([n,i],0),new Ii([r,s],0)]}class na{constructor(t,e,n){if(this.bitmap=t,this.padding=e,this.hashCount=n,e<0||e>=8)throw new ia(`Invalid padding: ${e}`);if(n<0)throw new ia(`Invalid hash count: ${n}`);if(t.length>0&&0===this.hashCount)throw new ia(`Invalid hash count: ${n}`);if(0===t.length&&0!==e)throw new ia(`Invalid padding when bitmap length is 0: ${e}`);this.Te=8*t.length-e,this.Ee=Ii.fromNumber(this.Te)}de(t,e,n){let i=t.add(e.multiply(Ii.fromNumber(n)));return 1===i.compare(Zo)&&(i=new Ii([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(t){return 0!=(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(0===this.Te)return!1;const e=ta(t),[n,i]=ea(e);for(let t=0;t<this.hashCount;t++){const e=this.de(n,i,t);if(!this.Ae(e))return!1}return!0}static create(t,e,n){const i=t%8==0?0:8-t%8,r=new Uint8Array(Math.ceil(t/8)),s=new na(r,i,e);return n.forEach((t=>s.insert(t))),s}insert(t){if(0===this.Te)return;const e=ta(t),[n,i]=ea(e);for(let t=0;t<this.hashCount;t++){const e=this.de(n,i,t);this.Re(e)}}Re(t){const e=Math.floor(t/8),n=t%8;this.bitmap[e]|=1<<n}}class ia extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class ra{constructor(t,e,n,i,r){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const i=new Map;return i.set(t,sa.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new ra(er.min(),i,new Ar(Ji),Zs(),uo())}}class sa{constructor(t,e,n,i,r){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new sa(n,e,uo(),uo(),uo())}}class oa{constructor(t,e,n,i){this.Ve=t,this.removedTargetIds=e,this.key=n,this.me=i}}class aa{constructor(t,e){this.targetId=t,this.fe=e}}class ua{constructor(t,e,n=Lr.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}}class la{constructor(){this.ge=0,this.pe=da(),this.ye=Lr.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(t){t.approximateByteSize()>0&&(this.Se=!0,this.ye=t)}ve(){let t=uo(),e=uo(),n=uo();return this.pe.forEach(((i,r)=>{switch(r){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:n=n.add(i);break;default:Mi()}})),new sa(this.ye,this.we,t,e,n)}Fe(){this.Se=!1,this.pe=da()}Me(t,e){this.Se=!0,this.pe=this.pe.insert(t,e)}xe(t){this.Se=!0,this.pe=this.pe.remove(t)}Oe(){this.ge+=1}Ne(){this.ge-=1,Vi(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class ca{constructor(t){this.Le=t,this.ke=new Map,this.qe=Zs(),this.Qe=ha(),this.Ke=new Ar(Ji)}$e(t){for(const e of t.Ve)t.me&&t.me.isFoundDocument()?this.Ue(e,t.me):this.We(e,t.key,t.me);for(const e of t.removedTargetIds)this.We(e,t.key,t.me)}Ge(t){this.forEachTarget(t,(e=>{const n=this.ze(e);switch(t.state){case 0:this.je(e)&&n.Ce(t.resumeToken);break;case 1:n.Ne(),n.be||n.Fe(),n.Ce(t.resumeToken);break;case 2:n.Ne(),n.be||this.removeTarget(e);break;case 3:this.je(e)&&(n.Be(),n.Ce(t.resumeToken));break;case 4:this.je(e)&&(this.He(e),n.Ce(t.resumeToken));break;default:Mi()}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ke.forEach(((t,n)=>{this.je(n)&&e(n)}))}Je(t){const e=t.targetId,n=t.fe.count,i=this.Ye(e);if(i){const r=i.target;if(Ls(r))if(0===n){const t=new or(r.path);this.We(e,t,as.newNoDocument(t,er.min()))}else Vi(1===n);else{const i=this.Ze(e);if(i!==n){const n=this.Xe(t),r=n?this.et(n,t,i):1;if(0!==r){this.He(e);const t=2===r?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(e,t)}null==Yo||Yo.tt(function(t,e,n,i,r){var s,o,a,u,l,c;const h={localCacheCount:t,existenceFilterCount:e.count,databaseId:n.database,projectId:n.projectId},d=e.unchangedNames;return d&&(h.bloomFilter={applied:0===r,hashCount:null!==(s=null==d?void 0:d.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(u=null===(a=null===(o=null==d?void 0:d.bits)||void 0===o?void 0:o.bitmap)||void 0===a?void 0:a.length)&&void 0!==u?u:0,padding:null!==(c=null===(l=null==d?void 0:d.bits)||void 0===l?void 0:l.padding)&&void 0!==c?c:0,mightContain:t=>{var e;return null!==(e=null==i?void 0:i.mightContain(t))&&void 0!==e&&e}}),h}(i,t.fe,this.Le.nt(),n,r))}}}}Xe(t){const e=t.fe.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:r=0}=e;let s,o;try{s=Fr(n).toUint8Array()}catch(t){if(t instanceof Pr)return Li("Decoding the base64 bloom filter in existence filter failed ("+t.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw t}try{o=new na(s,i,r)}catch(t){return Li(t instanceof ia?"BloomFilter error: ":"Applying bloom filter failed: ",t),null}return 0===o.Te?null:o}et(t,e,n){return e.fe.count===n-this.rt(t,e.targetId)?0:2}rt(t,e){const n=this.Le.getRemoteKeysForTarget(e);let i=0;return n.forEach((n=>{const r=this.Le.nt(),s=`projects/${r.projectId}/databases/${r.database}/documents/${n.path.canonicalString()}`;t.mightContain(s)||(this.We(e,n,null),i++)})),i}it(t){const e=new Map;this.ke.forEach(((n,i)=>{const r=this.Ye(i);if(r){if(n.current&&Ls(r.target)){const e=new or(r.target.path);null!==this.qe.get(e)||this.st(i,e)||this.We(i,e,as.newNoDocument(e,t))}n.De&&(e.set(i,n.ve()),n.Fe())}}));let n=uo();this.Qe.forEach(((t,e)=>{let i=!0;e.forEachWhile((t=>{const e=this.Ye(t);return!e||"TargetPurposeLimboResolution"===e.purpose||(i=!1,!1)})),i&&(n=n.add(t))})),this.qe.forEach(((e,n)=>n.setReadTime(t)));const i=new ra(t,e,this.Ke,this.qe,n);return this.qe=Zs(),this.Qe=ha(),this.Ke=new Ar(Ji),i}Ue(t,e){if(!this.je(t))return;const n=this.st(t,e.key)?2:0;this.ze(t).Me(e.key,n),this.qe=this.qe.insert(e.key,e),this.Qe=this.Qe.insert(e.key,this.ot(e.key).add(t))}We(t,e,n){if(!this.je(t))return;const i=this.ze(t);this.st(t,e)?i.Me(e,1):i.xe(e),this.Qe=this.Qe.insert(e,this.ot(e).delete(t)),n&&(this.qe=this.qe.insert(e,n))}removeTarget(t){this.ke.delete(t)}Ze(t){const e=this.ze(t).ve();return this.Le.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Oe(t){this.ze(t).Oe()}ze(t){let e=this.ke.get(t);return e||(e=new la,this.ke.set(t,e)),e}ot(t){let e=this.Qe.get(t);return e||(e=new xr(Ji),this.Qe=this.Qe.insert(t,e)),e}je(t){const e=null!==this.Ye(t);return e||Ni("WatchChangeAggregator","Detected inactive target",t),e}Ye(t){const e=this.ke.get(t);return e&&e.be?null:this.Le._t(t)}He(t){this.ke.set(t,new la),this.Le.getRemoteKeysForTarget(t).forEach((e=>{this.We(t,e,null)}))}st(t,e){return this.Le.getRemoteKeysForTarget(t).has(e)}}function ha(){return new Ar(or.comparator)}function da(){return new Ar(or.comparator)}const fa={asc:"ASCENDING",desc:"DESCENDING"},pa={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ma={and:"AND",or:"OR"};class ga{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function ya(t,e){return t.useProto3Json||vr(e)?e:{value:e}}function va(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function wa(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function _a(t,e){return va(t,e.toTimestamp())}function ba(t){return Vi(!!t),er.fromTimestamp(function(t){const e=Mr(t);return new tr(e.seconds,e.nanos)}(t))}function Ea(t,e){return function(t){return new ir(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Ta(t){const e=ir.fromString(t);return Vi(za(e)),e}function Sa(t,e){return Ea(t.databaseId,e.path)}function Ca(t,e){const n=Ta(e);if(n.get(1)!==t.databaseId.projectId)throw new Bi(Ui.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Bi(Ui.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new or(Da(n))}function Ia(t,e){return Ea(t.databaseId,e)}function Aa(t){const e=Ta(t);return 4===e.length?ir.emptyPath():Da(e)}function ka(t){return new ir(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Da(t){return Vi(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function xa(t,e,n){return{name:Sa(t,e),fields:n.value.mapValue.fields}}function Ra(t,e){let n;if(e instanceof Mo)n={update:xa(t,e.key,e.value)};else if(e instanceof jo)n={delete:Sa(t,e.key)};else if(e instanceof Vo)n={update:xa(t,e.key,e.data),updateMask:qa(e.fieldMask)};else{if(!(e instanceof qo))return Mi();n={verify:Sa(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof wo)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof _o)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Eo)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof So)return{fieldPath:e.field.canonicalString(),increment:n.Ie};throw Mi()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:_a(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Mi()}(t,e.precondition)),n}function Na(t,e){return{documents:[Ia(t,e.path)]}}function Pa(t,e){const n={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(n.parent=Ia(t,i),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Ia(t,i.popLast()),n.structuredQuery.from=[{collectionId:i.lastSegment()}]);const r=function(t){if(0!==t.length)return ja(ms.create(t,"and"))}(e.filters);r&&(n.structuredQuery.where=r);const s=function(t){if(0!==t.length)return t.map((t=>function(t){return{field:Ua(t.field),direction:Ma(t.dir)}}(t)))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const o=ya(t,e.limit);return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt=function(t){return{before:t.inclusive,values:t.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(t){return{before:!t.inclusive,values:t.position}}(e.endAt)),n}function La(t){let e=Aa(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){Vi(1===i);const t=n.from[0];t.allDescendants?r=t.collectionId:e=e.child(t.collectionId)}let s=[];n.where&&(s=function(t){const e=Oa(t);return e instanceof ms&&ys(e)?e.getFilters():[e]}(n.where));let o=[];n.orderBy&&(o=function(t){return t.map((t=>function(t){return new hs(Ba(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)))}(n.orderBy));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,vr(e)?null:e}(n.limit));let u=null;n.startAt&&(u=function(t){const e=!!t.before,n=t.values||[];return new us(n,e)}(n.startAt));let l=null;return n.endAt&&(l=function(t){const e=!t.before,n=t.values||[];return new us(n,e)}(n.endAt)),Ms(e,r,o,s,a,"F",u,l)}function Oa(t){return void 0!==t.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Ba(t.unaryFilter.field);return ps.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Ba(t.unaryFilter.field);return ps.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Ba(t.unaryFilter.field);return ps.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=Ba(t.unaryFilter.field);return ps.create(r,"!=",{nullValue:"NULL_VALUE"});default:return Mi()}}(t):void 0!==t.fieldFilter?function(t){return ps.create(Ba(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Mi()}}(t.fieldFilter.op),t.fieldFilter.value)}(t):void 0!==t.compositeFilter?function(t){return ms.create(t.compositeFilter.filters.map((t=>Oa(t))),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return Mi()}}(t.compositeFilter.op))}(t):Mi()}function Ma(t){return fa[t]}function Va(t){return pa[t]}function Fa(t){return ma[t]}function Ua(t){return{fieldPath:t.canonicalString()}}function Ba(t){return sr.fromServerFormat(t.fieldPath)}function ja(t){return t instanceof ps?function(t){if("=="===t.op){if(es(t.value))return{unaryFilter:{field:Ua(t.field),op:"IS_NAN"}};if(ts(t.value))return{unaryFilter:{field:Ua(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(es(t.value))return{unaryFilter:{field:Ua(t.field),op:"IS_NOT_NAN"}};if(ts(t.value))return{unaryFilter:{field:Ua(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ua(t.field),op:Va(t.op),value:t.value}}}(t):t instanceof ms?function(t){const e=t.getFilters().map((t=>ja(t)));return 1===e.length?e[0]:{compositeFilter:{op:Fa(t.op),filters:e}}}(t):Mi()}function qa(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function za(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class $a{constructor(t,e,n,i,r=er.min(),s=er.min(),o=Lr.EMPTY_BYTE_STRING,a=null){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(t){return new $a(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new $a(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new $a(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new $a(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class Ha{constructor(t){this.ut=t}}function Ga(t){const e=La({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?zs(e,e.limit,"L"):e}class Ka{constructor(){}ht(t,e){this.Pt(t,e),e.It()}Pt(t,e){if("nullValue"in t)this.Tt(e,5);else if("booleanValue"in t)this.Tt(e,10),e.Et(t.booleanValue?1:0);else if("integerValue"in t)this.Tt(e,15),e.Et(Vr(t.integerValue));else if("doubleValue"in t){const n=Vr(t.doubleValue);isNaN(n)?this.Tt(e,13):(this.Tt(e,15),wr(n)?e.Et(0):e.Et(n))}else if("timestampValue"in t){const n=t.timestampValue;this.Tt(e,20),"string"==typeof n?e.dt(n):(e.dt(`${n.seconds||""}`),e.Et(n.nanos||0))}else if("stringValue"in t)this.At(t.stringValue,e),this.Rt(e);else if("bytesValue"in t)this.Tt(e,30),e.Vt(Fr(t.bytesValue)),this.Rt(e);else if("referenceValue"in t)this.ft(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.Tt(e,45),e.Et(n.latitude||0),e.Et(n.longitude||0)}else"mapValue"in t?rs(t)?this.Tt(e,Number.MAX_SAFE_INTEGER):(this.gt(t.mapValue,e),this.Rt(e)):"arrayValue"in t?(this.yt(t.arrayValue,e),this.Rt(e)):Mi()}At(t,e){this.Tt(e,25),this.wt(t,e)}wt(t,e){e.dt(t)}gt(t,e){const n=t.fields||{};this.Tt(e,55);for(const t of Object.keys(n))this.At(t,e),this.Pt(n[t],e)}yt(t,e){const n=t.values||[];this.Tt(e,50);for(const t of n)this.Pt(t,e)}ft(t,e){this.Tt(e,37),or.fromName(t).path.forEach((t=>{this.Tt(e,60),this.wt(t,e)}))}Tt(t,e){t.Et(e)}Rt(t){t.Et(2)}}Ka.St=new Ka;class Wa{constructor(){this.on=new Qa}addToCollectionParentIndex(t,e){return this.on.add(e),mr.resolve()}getCollectionParents(t,e){return mr.resolve(this.on.getEntries(e))}addFieldIndex(t,e){return mr.resolve()}deleteFieldIndex(t,e){return mr.resolve()}deleteAllFieldIndexes(t){return mr.resolve()}createTargetIndexes(t,e){return mr.resolve()}getDocumentsMatchingTarget(t,e){return mr.resolve(null)}getIndexType(t,e){return mr.resolve(0)}getFieldIndexes(t,e){return mr.resolve([])}getNextCollectionGroupToUpdate(t){return mr.resolve(null)}getMinOffset(t,e){return mr.resolve(cr.min())}getMinOffsetFromCollectionGroup(t,e){return mr.resolve(cr.min())}updateCollectionGroup(t,e,n){return mr.resolve()}updateIndexEntries(t,e){return mr.resolve()}}class Qa{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new xr(ir.comparator),r=!i.has(n);return this.index[e]=i.add(n),r}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new xr(ir.comparator)).toArray()}}new Uint8Array(0);class Xa{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new Xa(t,Xa.DEFAULT_COLLECTION_PERCENTILE,Xa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Xa.DEFAULT_COLLECTION_PERCENTILE=10,Xa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Xa.DEFAULT=new Xa(41943040,Xa.DEFAULT_COLLECTION_PERCENTILE,Xa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Xa.DISABLED=new Xa(-1,0,0);class Ya{constructor(t){this.xn=t}next(){return this.xn+=2,this.xn}static On(){return new Ya(0)}static Nn(){return new Ya(-1)}}class Ja{constructor(){this.changes=new Ys((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,as.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?mr.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class Za{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class tu{constructor(t,e,n,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((i=>(n=i,this.remoteDocumentCache.getEntry(t,e)))).next((t=>(null!==n&&Po(n.mutation,t,Nr.empty(),tr.now()),t)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.getLocalViewOfDocuments(t,e,uo()).next((()=>e))))}getLocalViewOfDocuments(t,e,n=uo()){const i=io();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,n).next((t=>{let e=eo();return t.forEach(((t,n)=>{e=e.insert(t,n.overlayedDocument)})),e}))))}getOverlayedDocuments(t,e){const n=io();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,uo())))}populateOverlays(t,e,n){const i=[];return n.forEach((t=>{e.has(t)||i.push(t)})),this.documentOverlayCache.getOverlays(t,i).next((t=>{t.forEach(((t,n)=>{e.set(t,n)}))}))}computeViews(t,e,n,i){let r=Zs();const s=so(),o=so();return e.forEach(((t,e)=>{const o=n.get(e.key);i.has(e.key)&&(void 0===o||o.mutation instanceof Vo)?r=r.insert(e.key,e):void 0!==o?(s.set(e.key,o.mutation.getFieldMask()),Po(o.mutation,e,o.mutation.getFieldMask(),tr.now())):s.set(e.key,Nr.empty())})),this.recalculateAndSaveOverlays(t,r).next((t=>(t.forEach(((t,e)=>s.set(t,e))),e.forEach(((t,e)=>{var n;return o.set(t,new Za(e,null!==(n=s.get(t))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(t,e){const n=so();let i=new Ar(((t,e)=>t-e)),r=uo();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>{for(const r of t)r.keys().forEach((t=>{const s=e.get(t);if(null===s)return;let o=n.get(t)||Nr.empty();o=r.applyToLocalView(s,o),n.set(t,o);const a=(i.get(r.batchId)||uo()).add(t);i=i.insert(r.batchId,a)}))})).next((()=>{const s=[],o=i.getReverseIterator();for(;o.hasNext();){const i=o.getNext(),a=i.key,u=i.value,l=ro();u.forEach((t=>{if(!r.has(t)){const i=Ro(e.get(t),n.get(t));null!==i&&l.set(t,i),r=r.add(t)}})),s.push(this.documentOverlayCache.saveOverlays(t,a,l))}return mr.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.recalculateAndSaveOverlays(t,e)))}getDocumentsMatchingQuery(t,e,n,i){return function(t){return or.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):Us(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,i):this.getDocumentsMatchingCollectionQuery(t,e,n,i)}getNextDocuments(t,e,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,i).next((r=>{const s=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,i-r.size):mr.resolve(io());let o=-1,a=r;return s.next((e=>mr.forEach(e,((e,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),r.get(e)?mr.resolve():this.remoteDocumentCache.getEntry(t,e).next((t=>{a=a.insert(e,t)}))))).next((()=>this.populateOverlays(t,e,r))).next((()=>this.computeViews(t,a,e,uo()))).next((t=>({batchId:o,changes:no(t)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new or(e)).next((t=>{let e=eo();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}getDocumentsMatchingCollectionGroupQuery(t,e,n,i){const r=e.collectionGroup;let s=eo();return this.indexManager.getCollectionParents(t,r).next((o=>mr.forEach(o,(o=>{const a=function(t,e){return new Os(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,o.child(r));return this.getDocumentsMatchingCollectionQuery(t,a,n,i).next((t=>{t.forEach(((t,e)=>{s=s.insert(t,e)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(t,e,n,i){let r;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next((s=>(r=s,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,r,i)))).next((t=>{r.forEach(((e,n)=>{const i=n.getKey();null===t.get(i)&&(t=t.insert(i,as.newInvalidDocument(i)))}));let n=eo();return t.forEach(((t,i)=>{const s=r.get(t);void 0!==s&&Po(s.mutation,i,Nr.empty(),tr.now()),Ks(e,i)&&(n=n.insert(t,i))})),n}))}}class eu{constructor(t){this.serializer=t,this.ur=new Map,this.cr=new Map}getBundleMetadata(t,e){return mr.resolve(this.ur.get(e))}saveBundleMetadata(t,e){return this.ur.set(e.id,function(t){return{id:t.id,version:t.version,createTime:ba(t.createTime)}}(e)),mr.resolve()}getNamedQuery(t,e){return mr.resolve(this.cr.get(e))}saveNamedQuery(t,e){return this.cr.set(e.name,function(t){return{name:t.name,query:Ga(t.bundledQuery),readTime:ba(t.readTime)}}(e)),mr.resolve()}}class nu{constructor(){this.overlays=new Ar(or.comparator),this.lr=new Map}getOverlay(t,e){return mr.resolve(this.overlays.get(e))}getOverlays(t,e){const n=io();return mr.forEach(e,(e=>this.getOverlay(t,e).next((t=>{null!==t&&n.set(e,t)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((n,i)=>{this.lt(t,e,i)})),mr.resolve()}removeOverlaysForBatchId(t,e,n){const i=this.lr.get(n);return void 0!==i&&(i.forEach((t=>this.overlays=this.overlays.remove(t))),this.lr.delete(n)),mr.resolve()}getOverlaysForCollection(t,e,n){const i=io(),r=e.length+1,s=new or(e.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const t=o.getNext().value,s=t.getKey();if(!e.isPrefixOf(s.path))break;s.path.length===r&&t.largestBatchId>n&&i.set(t.getKey(),t)}return mr.resolve(i)}getOverlaysForCollectionGroup(t,e,n,i){let r=new Ar(((t,e)=>t-e));const s=this.overlays.getIterator();for(;s.hasNext();){const t=s.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=r.get(t.largestBatchId);null===e&&(e=io(),r=r.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=io(),a=r.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((t,e)=>o.set(t,e))),!(o.size()>=i)););return mr.resolve(o)}lt(t,e,n){const i=this.overlays.get(n.key);if(null!==i){const t=this.lr.get(i.largestBatchId).delete(n.key);this.lr.set(i.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new Ho(e,n));let r=this.lr.get(e);void 0===r&&(r=uo(),this.lr.set(e,r)),this.lr.set(e,r.add(n.key))}}class iu{constructor(){this.hr=new xr(ru.Pr),this.Ir=new xr(ru.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(t,e){const n=new ru(t,e);this.hr=this.hr.add(n),this.Ir=this.Ir.add(n)}Er(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.dr(new ru(t,e))}Ar(t,e){t.forEach((t=>this.removeReference(t,e)))}Rr(t){const e=new or(new ir([])),n=new ru(e,t),i=new ru(e,t+1),r=[];return this.Ir.forEachInRange([n,i],(t=>{this.dr(t),r.push(t.key)})),r}Vr(){this.hr.forEach((t=>this.dr(t)))}dr(t){this.hr=this.hr.delete(t),this.Ir=this.Ir.delete(t)}mr(t){const e=new or(new ir([])),n=new ru(e,t),i=new ru(e,t+1);let r=uo();return this.Ir.forEachInRange([n,i],(t=>{r=r.add(t.key)})),r}containsKey(t){const e=new ru(t,0),n=this.hr.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class ru{constructor(t,e){this.key=t,this.gr=e}static Pr(t,e){return or.comparator(t.key,e.key)||Ji(t.gr,e.gr)}static Tr(t,e){return Ji(t.gr,e.gr)||or.comparator(t.key,e.key)}}class su{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.pr=1,this.yr=new xr(ru.Pr)}checkEmpty(t){return mr.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,i){const r=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new zo(r,e,n,i);this.mutationQueue.push(s);for(const e of i)this.yr=this.yr.add(new ru(e.key,r)),this.indexManager.addToCollectionParentIndex(t,e.key.path.popLast());return mr.resolve(s)}lookupMutationBatch(t,e){return mr.resolve(this.wr(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this.Sr(n),r=i<0?0:i;return mr.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return mr.resolve(0===this.mutationQueue.length?-1:this.pr-1)}getAllMutationBatches(t){return mr.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new ru(e,0),i=new ru(e,Number.POSITIVE_INFINITY),r=[];return this.yr.forEachInRange([n,i],(t=>{const e=this.wr(t.gr);r.push(e)})),mr.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new xr(Ji);return e.forEach((t=>{const e=new ru(t,0),i=new ru(t,Number.POSITIVE_INFINITY);this.yr.forEachInRange([e,i],(t=>{n=n.add(t.gr)}))})),mr.resolve(this.br(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let r=n;or.isDocumentKey(r)||(r=r.child(""));const s=new ru(new or(r),0);let o=new xr(Ji);return this.yr.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===i&&(o=o.add(t.gr)),!0)}),s),mr.resolve(this.br(o))}br(t){const e=[];return t.forEach((t=>{const n=this.wr(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){Vi(0===this.Dr(e.batchId,"removed")),this.mutationQueue.shift();let n=this.yr;return mr.forEach(e.mutations,(i=>{const r=new ru(i.key,e.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.yr=n}))}Fn(t){}containsKey(t,e){const n=new ru(e,0),i=this.yr.firstAfterOrEqual(n);return mr.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,mr.resolve()}Dr(t,e){return this.Sr(t)}Sr(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}wr(t){const e=this.Sr(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class ou{constructor(t){this.Cr=t,this.docs=new Ar(or.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,i=this.docs.get(n),r=i?i.size:0,s=this.Cr(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:s}),this.size+=s-r,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return mr.resolve(n?n.document.mutableCopy():as.newInvalidDocument(e))}getEntries(t,e){let n=Zs();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():as.newInvalidDocument(t))})),mr.resolve(n)}getDocumentsMatchingQuery(t,e,n,i){let r=Zs();const s=e.path,o=new or(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:t,value:{document:o}}=a.getNext();if(!s.isPrefixOf(t.path))break;t.path.length>s.length+1||hr(lr(o),n)<=0||(i.has(o.key)||Ks(e,o))&&(r=r.insert(o.key,o.mutableCopy()))}return mr.resolve(r)}getAllFromCollectionGroup(t,e,n,i){Mi()}vr(t,e){return mr.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new au(this)}getSize(t){return mr.resolve(this.size)}}class au extends Ja{constructor(t){super(),this._r=t}applyChanges(t){const e=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?e.push(this._r.addEntry(t,i)):this._r.removeEntry(n)})),mr.waitFor(e)}getFromCache(t,e){return this._r.getEntry(t,e)}getAllFromCache(t,e){return this._r.getEntries(t,e)}}class uu{constructor(t){this.persistence=t,this.Fr=new Ys((t=>Ns(t)),Ps),this.lastRemoteSnapshotVersion=er.min(),this.highestTargetId=0,this.Mr=0,this.Or=new iu,this.targetCount=0,this.Nr=Ya.On()}forEachTarget(t,e){return this.Fr.forEach(((t,n)=>e(n))),mr.resolve()}getLastRemoteSnapshotVersion(t){return mr.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return mr.resolve(this.Mr)}allocateTargetId(t){return this.highestTargetId=this.Nr.next(),mr.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Mr&&(this.Mr=e),mr.resolve()}kn(t){this.Fr.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Nr=new Ya(e),this.highestTargetId=e),t.sequenceNumber>this.Mr&&(this.Mr=t.sequenceNumber)}addTargetData(t,e){return this.kn(e),this.targetCount+=1,mr.resolve()}updateTargetData(t,e){return this.kn(e),mr.resolve()}removeTargetData(t,e){return this.Fr.delete(e.target),this.Or.Rr(e.targetId),this.targetCount-=1,mr.resolve()}removeTargets(t,e,n){let i=0;const r=[];return this.Fr.forEach(((s,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.Fr.delete(s),r.push(this.removeMatchingKeysForTargetId(t,o.targetId)),i++)})),mr.waitFor(r).next((()=>i))}getTargetCount(t){return mr.resolve(this.targetCount)}getTargetData(t,e){const n=this.Fr.get(e)||null;return mr.resolve(n)}addMatchingKeys(t,e,n){return this.Or.Er(e,n),mr.resolve()}removeMatchingKeys(t,e,n){this.Or.Ar(e,n);const i=this.persistence.referenceDelegate,r=[];return i&&e.forEach((e=>{r.push(i.markPotentiallyOrphaned(t,e))})),mr.waitFor(r)}removeMatchingKeysForTargetId(t,e){return this.Or.Rr(e),mr.resolve()}getMatchingKeysForTargetId(t,e){const n=this.Or.mr(e);return mr.resolve(n)}containsKey(t,e){return mr.resolve(this.Or.containsKey(e))}}class lu{constructor(t,e){this.Br={},this.overlays={},this.Lr=new yr(0),this.kr=!1,this.kr=!0,this.referenceDelegate=t(this),this.qr=new uu(this),this.indexManager=new Wa,this.remoteDocumentCache=function(t){return new ou(t)}((t=>this.referenceDelegate.Qr(t))),this.serializer=new Ha(e),this.Kr=new eu(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new nu,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.Br[t.toKey()];return n||(n=new su(e,this.referenceDelegate),this.Br[t.toKey()]=n),n}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(t,e,n){Ni("MemoryPersistence","Starting transaction:",t);const i=new cu(this.Lr.next());return this.referenceDelegate.$r(),n(i).next((t=>this.referenceDelegate.Ur(i).next((()=>t)))).toPromise().then((t=>(i.raiseOnCommittedEvent(),t)))}Wr(t,e){return mr.or(Object.values(this.Br).map((n=>()=>n.containsKey(t,e))))}}class cu extends fr{constructor(t){super(),this.currentSequenceNumber=t}}class hu{constructor(t){this.persistence=t,this.Gr=new iu,this.zr=null}static jr(t){return new hu(t)}get Hr(){if(this.zr)return this.zr;throw Mi()}addReference(t,e,n){return this.Gr.addReference(n,e),this.Hr.delete(n.toString()),mr.resolve()}removeReference(t,e,n){return this.Gr.removeReference(n,e),this.Hr.add(n.toString()),mr.resolve()}markPotentiallyOrphaned(t,e){return this.Hr.add(e.toString()),mr.resolve()}removeTarget(t,e){this.Gr.Rr(e.targetId).forEach((t=>this.Hr.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.Hr.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}$r(){this.zr=new Set}Ur(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return mr.forEach(this.Hr,(n=>{const i=or.fromPath(n);return this.Jr(t,i).next((t=>{t||e.removeEntry(i,er.min())}))})).next((()=>(this.zr=null,e.apply(t))))}updateLimboDocument(t,e){return this.Jr(t,e).next((t=>{t?this.Hr.delete(e.toString()):this.Hr.add(e.toString())}))}Qr(t){return 0}Jr(t,e){return mr.or([()=>mr.resolve(this.Gr.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Wr(t,e)])}}class du{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.ki=n,this.qi=i}static Qi(t,e){let n=uo(),i=uo();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:i=i.add(t.doc.key)}return new du(t,e.fromCache,n,i)}}class fu{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class pu{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(t,e){this.Gi=t,this.indexManager=e,this.Ki=!0}getDocumentsMatchingQuery(t,e,n,i){const r={result:null};return this.zi(t,e).next((t=>{r.result=t})).next((()=>{if(!r.result)return this.ji(t,e,i,n).next((t=>{r.result=t}))})).next((()=>{if(r.result)return;const n=new fu;return this.Hi(t,e,n).next((i=>{if(r.result=i,this.$i)return this.Ji(t,e,n,i.size)}))})).next((()=>r.result))}Ji(t,e,n,i){return n.documentReadCount<this.Ui?(Ri()<=o.in.DEBUG&&Ni("QueryEngine","SDK will not create cache indexes for query:",Gs(e),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),mr.resolve()):(Ri()<=o.in.DEBUG&&Ni("QueryEngine","Query:",Gs(e),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Wi*i?(Ri()<=o.in.DEBUG&&Ni("QueryEngine","The SDK decides to create cache indexes for query:",Gs(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,js(e))):mr.resolve())}zi(t,e){if(Fs(e))return mr.resolve(null);let n=js(e);return this.indexManager.getIndexType(t,n).next((i=>0===i?null:(null!==e.limit&&1===i&&(e=zs(e,null,"F"),n=js(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((i=>{const r=uo(...i);return this.Gi.getDocuments(t,r).next((i=>this.indexManager.getMinOffset(t,n).next((n=>{const s=this.Yi(e,i);return this.Zi(e,s,r,n.readTime)?this.zi(t,zs(e,null,"F")):this.Xi(t,s,e,n)}))))})))))}ji(t,e,n,i){return Fs(e)||i.isEqual(er.min())?mr.resolve(null):this.Gi.getDocuments(t,n).next((r=>{const s=this.Yi(e,r);return this.Zi(e,s,n,i)?mr.resolve(null):(Ri()<=o.in.DEBUG&&Ni("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Gs(e)),this.Xi(t,s,e,ur(i,-1)).next((t=>t)))}))}Yi(t,e){let n=new xr(Qs(t));return e.forEach(((e,i)=>{Ks(t,i)&&(n=n.add(i))})),n}Zi(t,e,n,i){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const r="F"===t.limitType?e.last():e.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Hi(t,e,n){return Ri()<=o.in.DEBUG&&Ni("QueryEngine","Using full collection scan to execute query:",Gs(e)),this.Gi.getDocumentsMatchingQuery(t,e,cr.min(),n)}Xi(t,e,n,i){return this.Gi.getDocumentsMatchingQuery(t,n,i).next((t=>(e.forEach((e=>{t=t.insert(e.key,e)})),t)))}}class mu{constructor(t,e,n,i){this.persistence=t,this.es=e,this.serializer=i,this.ts=new Ar(Ji),this.ns=new Ys((t=>Ns(t)),Ps),this.rs=new Map,this.ss=t.getRemoteDocumentCache(),this.qr=t.getTargetCache(),this.Kr=t.getBundleCache(),this.os(n)}os(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new tu(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.ts)))}}function gu(t,e,n,i){return new mu(t,e,n,i)}async function yu(t,e){const n=Fi(t);return await n.persistence.runTransaction("Handle user change","readonly",(t=>{let i;return n.mutationQueue.getAllMutationBatches(t).next((r=>(i=r,n.os(e),n.mutationQueue.getAllMutationBatches(t)))).next((e=>{const r=[],s=[];let o=uo();for(const t of i){r.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){s.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.localDocuments.getDocuments(t,o).next((t=>({_s:t,removedBatchIds:r,addedBatchIds:s})))}))}))}function vu(t){const e=Fi(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.qr.getLastRemoteSnapshotVersion(t)))}function wu(t,e,n){let i=uo(),r=uo();return n.forEach((t=>i=i.add(t))),e.getEntries(t,i).next((t=>{let i=Zs();return n.forEach(((n,s)=>{const o=t.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(r=r.add(n)),s.isNoDocument()&&s.version.isEqual(er.min())?(e.removeEntry(n,s.readTime),i=i.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(e.addEntry(s),i=i.insert(n,s)):Ni("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)})),{us:i,cs:r}}))}function _u(t,e){const n=Fi(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e))))}function bu(t,e){const n=Fi(t);return n.persistence.runTransaction("Allocate target","readwrite",(t=>{let i;return n.qr.getTargetData(t,e).next((r=>r?(i=r,mr.resolve(i)):n.qr.allocateTargetId(t).next((r=>(i=new $a(e,r,"TargetPurposeListen",t.currentSequenceNumber),n.qr.addTargetData(t,i).next((()=>i)))))))})).then((t=>{const i=n.ts.get(t.targetId);return(null===i||t.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ts=n.ts.insert(t.targetId,t),n.ns.set(e,t.targetId)),t}))}async function Eu(t,e,n){const i=Fi(t),r=i.ts.get(e),s=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",s,(t=>i.persistence.referenceDelegate.removeTarget(t,r)))}catch(t){if(!gr(t))throw t;Ni("LocalStore",`Failed to update sequence numbers for target ${e}: ${t}`)}i.ts=i.ts.remove(e),i.ns.delete(r.target)}function Tu(t,e,n){const i=Fi(t);let r=er.min(),s=uo();return i.persistence.runTransaction("Execute query","readwrite",(t=>function(t,e,n){const i=Fi(t),r=i.ns.get(n);return void 0!==r?mr.resolve(i.ts.get(r)):i.qr.getTargetData(e,n)}(i,t,js(e)).next((e=>{if(e)return r=e.lastLimboFreeSnapshotVersion,i.qr.getMatchingKeysForTargetId(t,e.targetId).next((t=>{s=t}))})).next((()=>i.es.getDocumentsMatchingQuery(t,e,n?r:er.min(),n?s:uo()))).next((t=>(Su(i,Ws(e),t),{documents:t,ls:s})))))}function Su(t,e,n){let i=t.rs.get(e)||er.min();n.forEach(((t,e)=>{e.readTime.compareTo(i)>0&&(i=e.readTime)})),t.rs.set(e,i)}class Cu{constructor(){this.activeTargetIds=co()}ds(t){this.activeTargetIds=this.activeTargetIds.add(t)}As(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Es(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Iu{constructor(){this.eo=new Cu,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.eo.ds(t),this.no[t]||"not-current"}updateQueryState(t,e,n){this.no[t]=e}removeLocalQueryTarget(t){this.eo.As(t)}isLocalQueryTarget(t){return this.eo.activeTargetIds.has(t)}clearQueryState(t){delete this.no[t]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(t){return this.eo.activeTargetIds.has(t)}start(){return this.eo=new Cu,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class Au{ro(t){}shutdown(){}}class ku{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(t){this.ao.push(t)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){Ni("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.ao)t(0)}_o(){Ni("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.ao)t(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Du=null;function xu(){return null===Du?Du=268435456+Math.round(2147483648*Math.random()):Du++,"0x"+Du.toString(16)}const Ru={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Nu{constructor(t){this.co=t.co,this.lo=t.lo}ho(t){this.Po=t}Io(t){this.To=t}onMessage(t){this.Eo=t}close(){this.lo()}send(t){this.co(t)}Ao(){this.Po()}Ro(t){this.To(t)}Vo(t){this.Eo(t)}}const Pu="WebChannelConnection";class Lu extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.mo=e+"://"+t.host,this.fo=`projects/${n}/databases/${i}`,this.po="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${i}`}get yo(){return!1}wo(t,e,n,i,r){const s=xu(),o=this.So(t,e);Ni("RestConnection",`Sending RPC '${t}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(a,i,r),this.Do(t,o,a,n).then((e=>(Ni("RestConnection",`Received RPC '${t}' ${s}: `,e),e)),(e=>{throw Li("RestConnection",`RPC '${t}' ${s} failed with error: `,e,"url: ",o,"request:",n),e}))}Co(t,e,n,i,r,s){return this.wo(t,e,n,i,r)}bo(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+Di,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}So(t,e){const n=Ru[t];return`${this.mo}/v1/${e}:${n}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Do(t,e,n,i){const r=xu();return new Promise(((s,o)=>{const a=new Si;a.setWithCredentials(!0),a.listenOnce(_i.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case wi.NO_ERROR:const e=a.getResponseJson();Ni(Pu,`XHR for RPC '${t}' ${r} received:`,JSON.stringify(e)),s(e);break;case wi.TIMEOUT:Ni(Pu,`RPC '${t}' ${r} timed out`),o(new Bi(Ui.DEADLINE_EXCEEDED,"Request time out"));break;case wi.HTTP_ERROR:const n=a.getStatus();if(Ni(Pu,`RPC '${t}' ${r} failed with status:`,n,"response text:",a.getResponseText()),n>0){let t=a.getResponseJson();Array.isArray(t)&&(t=t[0]);const e=null==t?void 0:t.error;if(e&&e.status&&e.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(Ui).indexOf(e)>=0?e:Ui.UNKNOWN}(e.status);o(new Bi(t,e.message))}else o(new Bi(Ui.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new Bi(Ui.UNAVAILABLE,"Connection failed."));break;default:Mi()}}finally{Ni(Pu,`RPC '${t}' ${r} completed.`)}}));const u=JSON.stringify(i);Ni(Pu,`RPC '${t}' ${r} sending request:`,i),a.send(e,"POST",u,n,15)}))}vo(t,e,n){const i=xu(),r=[this.mo,"/","google.firestore.v1.Firestore","/",t,"/channel"],s=yi(),o=vi(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;void 0!==u&&(a.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(a.useFetchStreams=!0),this.bo(a.initMessageHeaders,e,n),a.encodeInitMessageHeaders=!0;const l=r.join("");Ni(Pu,`Creating RPC '${t}' stream ${i}: ${l}`,a);const c=s.createWebChannel(l,a);let h=!1,d=!1;const f=new Nu({co:e=>{d?Ni(Pu,`Not sending because RPC '${t}' stream ${i} is closed:`,e):(h||(Ni(Pu,`Opening RPC '${t}' stream ${i} transport.`),c.open(),h=!0),Ni(Pu,`RPC '${t}' stream ${i} sending:`,e),c.send(e))},lo:()=>c.close()}),p=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return p(c,Ti.EventType.OPEN,(()=>{d||Ni(Pu,`RPC '${t}' stream ${i} transport opened.`)})),p(c,Ti.EventType.CLOSE,(()=>{d||(d=!0,Ni(Pu,`RPC '${t}' stream ${i} transport closed`),f.Ro())})),p(c,Ti.EventType.ERROR,(e=>{d||(d=!0,Li(Pu,`RPC '${t}' stream ${i} transport errored:`,e),f.Ro(new Bi(Ui.UNAVAILABLE,"The operation could not be completed")))})),p(c,Ti.EventType.MESSAGE,(e=>{var n;if(!d){const r=e.data[0];Vi(!!r);const s=r,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){Ni(Pu,`RPC '${t}' stream ${i} received error:`,o);const e=o.status;let n=function(t){const e=Ko[t];if(void 0!==e)return Xo(e)}(e),r=o.message;void 0===n&&(n=Ui.INTERNAL,r="Unknown error status: "+e+" with message "+o.message),d=!0,f.Ro(new Bi(n,r)),c.close()}else Ni(Pu,`RPC '${t}' stream ${i} received:`,r),f.Vo(r)}})),p(o,bi.STAT_EVENT,(e=>{e.stat===Ei.PROXY?Ni(Pu,`RPC '${t}' stream ${i} detected buffering proxy`):e.stat===Ei.NOPROXY&&Ni(Pu,`RPC '${t}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{f.Ao()}),0),f}}function Ou(){return"undefined"!=typeof document?document:null}function Mu(t){return new ga(t,!0)}class Vu{constructor(t,e,n=1e3,i=1.5,r=6e4){this.si=t,this.timerId=e,this.Fo=n,this.Mo=i,this.xo=r,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(t){this.cancel();const e=Math.floor(this.Oo+this.qo()),n=Math.max(0,Date.now()-this.Bo),i=Math.max(0,e-n);i>0&&Ni("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,(()=>(this.Bo=Date.now(),t()))),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){null!==this.No&&(this.No.skipDelay(),this.No=null)}cancel(){null!==this.No&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}class Fu{constructor(t,e,n,i,r,s,o,a){this.si=t,this.Ko=n,this.$o=i,this.connection=r,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new Vu(t,e)}jo(){return 1===this.state||5===this.state||this.Ho()}Ho(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Jo()}async stop(){this.jo()&&await this.close(0)}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&null===this.Wo&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,(()=>this.Xo())))}e_(t){this.t_(),this.stream.send(t)}async Xo(){if(this.Ho())return this.close(0)}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}async close(t,e){this.t_(),this.n_(),this.zo.cancel(),this.Uo++,4!==t?this.zo.reset():e&&e.code===Ui.RESOURCE_EXHAUSTED?(Pi(e.toString()),Pi("Using maximum backoff delay to prevent overloading the backend."),this.zo.Lo()):e&&e.code===Ui.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.r_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Io(e)}r_(){}auth(){this.state=1;const t=this.i_(this.Uo),e=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([t,n])=>{this.Uo===e&&this.s_(t,n)}),(e=>{t((()=>{const t=new Bi(Ui.UNKNOWN,"Fetching auth token failed: "+e.message);return this.o_(t)}))}))}s_(t,e){const n=this.i_(this.Uo);this.stream=this.__(t,e),this.stream.ho((()=>{n((()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,(()=>(this.Ho()&&(this.state=3),Promise.resolve()))),this.listener.ho())))})),this.stream.Io((t=>{n((()=>this.o_(t)))})),this.stream.onMessage((t=>{n((()=>this.onMessage(t)))}))}Jo(){this.state=5,this.zo.ko((async()=>{this.state=0,this.start()}))}o_(t){return Ni("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}i_(t){return e=>{this.si.enqueueAndForget((()=>this.Uo===t?e():(Ni("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Uu extends Fu{constructor(t,e,n,i,r,s){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,i,s),this.serializer=r}__(t,e){return this.connection.vo("Listen",t,e)}onMessage(t){this.zo.reset();const e=function(t,e){let n;if("targetChange"in e){e.targetChange;const i=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Mi()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(t,e){return t.useProto3Json?(Vi(void 0===e||"string"==typeof e),Lr.fromBase64String(e||"")):(Vi(void 0===e||e instanceof Uint8Array),Lr.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(t){const e=void 0===t.code?Ui.UNKNOWN:Xo(t.code);return new Bi(e,t.message||"")}(o);n=new ua(i,r,s,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=Ca(t,i.document.name),s=ba(i.document.updateTime),o=i.document.createTime?ba(i.document.createTime):er.min(),a=new ss({mapValue:{fields:i.document.fields}}),u=as.newFoundDocument(r,s,o,a),l=i.targetIds||[],c=i.removedTargetIds||[];n=new oa(l,c,u.key,u)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=Ca(t,i.document),s=i.readTime?ba(i.readTime):er.min(),o=as.newNoDocument(r,s),a=i.removedTargetIds||[];n=new oa([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=Ca(t,i.document),s=i.removedTargetIds||[];n=new oa([],s,r,null)}else{if(!("filter"in e))return Mi();{e.filter;const t=e.filter;t.targetId;const{count:i=0,unchangedNames:r}=t,s=new Go(i,r),o=t.targetId;n=new aa(o,s)}}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return er.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?er.min():e.readTime?ba(e.readTime):er.min()}(t);return this.listener.a_(e,n)}u_(t){const e={};e.database=ka(this.serializer),e.addTarget=function(t,e){let n;const i=e.target;if(n=Ls(i)?{documents:Na(t,i)}:{query:Pa(t,i)},n.targetId=e.targetId,e.resumeToken.approximateByteSize()>0){n.resumeToken=wa(t,e.resumeToken);const i=ya(t,e.expectedCount);null!==i&&(n.expectedCount=i)}else if(e.snapshotVersion.compareTo(er.min())>0){n.readTime=va(t,e.snapshotVersion.toTimestamp());const i=ya(t,e.expectedCount);null!==i&&(n.expectedCount=i)}return n}(this.serializer,t);const n=function(t,e){const n=function(t){switch(t){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Mi()}}(e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);n&&(e.labels=n),this.e_(e)}c_(t){const e={};e.database=ka(this.serializer),e.removeTarget=t,this.e_(e)}}class Bu extends Fu{constructor(t,e,n,i,r,s){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,i,s),this.serializer=r,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(t,e){return this.connection.vo("Write",t,e)}onMessage(t){if(Vi(!!t.streamToken),this.lastStreamToken=t.streamToken,this.l_){this.zo.reset();const e=function(t,e){return t&&t.length>0?(Vi(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?ba(t.updateTime):ba(e);return n.isEqual(er.min())&&(n=ba(e)),new Ao(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=ba(t.commitTime);return this.listener.I_(n,e)}return Vi(!t.writeResults||0===t.writeResults.length),this.l_=!0,this.listener.T_()}E_(){const t={};t.database=ka(this.serializer),this.e_(t)}P_(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>Ra(this.serializer,t)))};this.e_(e)}}class ju extends class{}{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=i,this.d_=!1}A_(){if(this.d_)throw new Bi(Ui.FAILED_PRECONDITION,"The client has already been terminated.")}wo(t,e,n){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,r])=>this.connection.wo(t,e,n,i,r))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Ui.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Bi(Ui.UNKNOWN,t.toString())}))}Co(t,e,n,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,s])=>this.connection.Co(t,e,n,r,s,i))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Ui.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Bi(Ui.UNKNOWN,t.toString())}))}terminate(){this.d_=!0}}class qu{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){0===this.V_&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve()))))}w_(t){"Online"===this.state?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.p_("Offline")))}set(t){this.S_(),this.V_=0,"Online"===t&&(this.f_=!1),this.p_(t)}p_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}y_(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(Pi(e),this.f_=!1):Ni("OnlineStateTracker",e)}S_(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}}class zu{constructor(t,e,n,i,r){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=r,this.F_.ro((t=>{n.enqueueAndForget((async()=>{Ju(this)&&(Ni("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=Fi(t);e.C_.add(4),await Hu(e),e.M_.set("Unknown"),e.C_.delete(4),await $u(e)}(this))}))})),this.M_=new qu(n,i)}}async function $u(t){if(Ju(t))for(const e of t.v_)await e(!0)}async function Hu(t){for(const e of t.v_)await e(!1)}function Gu(t,e){const n=Fi(t);n.D_.has(e.targetId)||(n.D_.set(e.targetId,e),Yu(n)?Xu(n):gl(n).Ho()&&Wu(n,e))}function Ku(t,e){const n=Fi(t),i=gl(n);n.D_.delete(e),i.Ho()&&Qu(n,e),0===n.D_.size&&(i.Ho()?i.Zo():Ju(n)&&n.M_.set("Unknown"))}function Wu(t,e){if(t.x_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(er.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}gl(t).u_(e)}function Qu(t,e){t.x_.Oe(e),gl(t).c_(e)}function Xu(t){t.x_=new ca({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.D_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),gl(t).start(),t.M_.g_()}function Yu(t){return Ju(t)&&!gl(t).jo()&&t.D_.size>0}function Ju(t){return 0===Fi(t).C_.size}function Zu(t){t.x_=void 0}async function tl(t){t.D_.forEach(((e,n)=>{Wu(t,e)}))}async function el(t,e){Zu(t),Yu(t)?(t.M_.w_(e),Xu(t)):t.M_.set("Unknown")}async function nl(t,e,n){if(t.M_.set("Online"),e instanceof ua&&2===e.state&&e.cause)try{await async function(t,e){const n=e.cause;for(const i of e.targetIds)t.D_.has(i)&&(await t.remoteSyncer.rejectListen(i,n),t.D_.delete(i),t.x_.removeTarget(i))}(t,e)}catch(n){Ni("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await il(t,n)}else if(e instanceof oa?t.x_.$e(e):e instanceof aa?t.x_.Je(e):t.x_.Ge(e),!n.isEqual(er.min()))try{const e=await vu(t.localStore);n.compareTo(e)>=0&&await function(t,e){const n=t.x_.it(e);return n.targetChanges.forEach(((n,i)=>{if(n.resumeToken.approximateByteSize()>0){const r=t.D_.get(i);r&&t.D_.set(i,r.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach(((e,n)=>{const i=t.D_.get(e);if(!i)return;t.D_.set(e,i.withResumeToken(Lr.EMPTY_BYTE_STRING,i.snapshotVersion)),Qu(t,e);const r=new $a(i.target,e,n,i.sequenceNumber);Wu(t,r)})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)}catch(e){Ni("RemoteStore","Failed to raise snapshot:",e),await il(t,e)}}async function il(t,e,n){if(!gr(e))throw e;t.C_.add(1),await Hu(t),t.M_.set("Offline"),n||(n=()=>vu(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Ni("RemoteStore","Retrying IndexedDB access"),await n(),t.C_.delete(1),await $u(t)}))}function rl(t,e){return e().catch((n=>il(t,n,e)))}async function sl(t){const e=Fi(t),n=yl(e);let i=e.b_.length>0?e.b_[e.b_.length-1].batchId:-1;for(;ol(e);)try{const t=await _u(e.localStore,i);if(null===t){0===e.b_.length&&n.Zo();break}i=t.batchId,al(e,t)}catch(t){await il(e,t)}ul(e)&&ll(e)}function ol(t){return Ju(t)&&t.b_.length<10}function al(t,e){t.b_.push(e);const n=yl(t);n.Ho()&&n.h_&&n.P_(e.mutations)}function ul(t){return Ju(t)&&!yl(t).jo()&&t.b_.length>0}function ll(t){yl(t).start()}async function cl(t){yl(t).E_()}async function hl(t){const e=yl(t);for(const n of t.b_)e.P_(n.mutations)}async function dl(t,e,n){const i=t.b_.shift(),r=$o.from(i,e,n);await rl(t,(()=>t.remoteSyncer.applySuccessfulWrite(r))),await sl(t)}async function fl(t,e){e&&yl(t).h_&&await async function(t,e){if(function(t){return Qo(t)&&t!==Ui.ABORTED}(e.code)){const n=t.b_.shift();yl(t).Yo(),await rl(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await sl(t)}}(t,e),ul(t)&&ll(t)}async function pl(t,e){const n=Fi(t);n.asyncQueue.verifyOperationInProgress(),Ni("RemoteStore","RemoteStore received new credentials");const i=Ju(n);n.C_.add(3),await Hu(n),i&&n.M_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.C_.delete(3),await $u(n)}async function ml(t,e){const n=Fi(t);e?(n.C_.delete(2),await $u(n)):e||(n.C_.add(2),await Hu(n),n.M_.set("Unknown"))}function gl(t){return t.O_||(t.O_=function(t,e,n){const i=Fi(t);return i.A_(),new Uu(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(t.datastore,t.asyncQueue,{ho:tl.bind(null,t),Io:el.bind(null,t),a_:nl.bind(null,t)}),t.v_.push((async e=>{e?(t.O_.Yo(),Yu(t)?Xu(t):t.M_.set("Unknown")):(await t.O_.stop(),Zu(t))}))),t.O_}function yl(t){return t.N_||(t.N_=function(t,e,n){const i=Fi(t);return i.A_(),new Bu(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(t.datastore,t.asyncQueue,{ho:cl.bind(null,t),Io:fl.bind(null,t),T_:hl.bind(null,t),I_:dl.bind(null,t)}),t.v_.push((async e=>{e?(t.N_.Yo(),await sl(t)):(await t.N_.stop(),t.b_.length>0&&(Ni("RemoteStore",`Stopping write stream with ${t.b_.length} pending writes`),t.b_=[]))}))),t.N_}class vl{constructor(t,e,n,i,r){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new ji,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,i,r){const s=Date.now()+n,o=new vl(t,e,s,i,r);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Bi(Ui.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function wl(t,e){if(Pi("AsyncQueue",`${e}: ${t}`),gr(t))return new Bi(Ui.UNAVAILABLE,`${e}: ${t}`);throw t}class _l{constructor(t){this.comparator=t?(e,n)=>t(e,n)||or.comparator(e.key,n.key):(t,e)=>or.comparator(t.key,e.key),this.keyedMap=eo(),this.sortedSet=new Ar(this.comparator)}static emptySet(t){return new _l(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,n)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof _l))return!1;if(this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(!t.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new _l;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}class bl{constructor(){this.B_=new Ar(or.comparator)}track(t){const e=t.doc.key,n=this.B_.get(e);n?0!==t.type&&3===n.type?this.B_=this.B_.insert(e,t):3===t.type&&1!==n.type?this.B_=this.B_.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.B_=this.B_.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.B_=this.B_.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.B_=this.B_.remove(e):1===t.type&&2===n.type?this.B_=this.B_.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.B_=this.B_.insert(e,{type:2,doc:t.doc}):Mi():this.B_=this.B_.insert(e,t)}L_(){const t=[];return this.B_.inorderTraversal(((e,n)=>{t.push(n)})),t}}class El{constructor(t,e,n,i,r,s,o,a,u){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=r,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=u}static fromInitialDocuments(t,e,n,i,r){const s=[];return e.forEach((t=>{s.push({type:0,doc:t})})),new El(t,e,_l.emptySet(e),s,n,i,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&$s(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let t=0;t<e.length;t++)if(e[t].type!==n[t].type||!e[t].doc.isEqual(n[t].doc))return!1;return!0}}class Tl{constructor(){this.k_=void 0,this.listeners=[]}}class Sl{constructor(){this.queries=new Ys((t=>Hs(t)),$s),this.onlineState="Unknown",this.q_=new Set}}async function Cl(t,e){const n=Fi(t),i=e.query;let r=!1,s=n.queries.get(i);if(s||(r=!0,s=new Tl),r)try{s.k_=await n.onListen(i)}catch(t){const n=wl(t,`Initialization of query '${Gs(e.query)}' failed`);return void e.onError(n)}n.queries.set(i,s),s.listeners.push(e),e.Q_(n.onlineState),s.k_&&e.K_(s.k_)&&Dl(n)}async function Il(t,e){const n=Fi(t),i=e.query;let r=!1;const s=n.queries.get(i);if(s){const t=s.listeners.indexOf(e);t>=0&&(s.listeners.splice(t,1),r=0===s.listeners.length)}if(r)return n.queries.delete(i),n.onUnlisten(i)}function Al(t,e){const n=Fi(t);let i=!1;for(const t of e){const e=t.query,r=n.queries.get(e);if(r){for(const e of r.listeners)e.K_(t)&&(i=!0);r.k_=t}}i&&Dl(n)}function kl(t,e,n){const i=Fi(t),r=i.queries.get(e);if(r)for(const t of r.listeners)t.onError(n);i.queries.delete(e)}function Dl(t){t.q_.forEach((t=>{t.next()}))}class xl{constructor(t,e,n){this.query=t,this.U_=e,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=n||{}}K_(t){if(!this.options.includeMetadataChanges){const e=[];for(const n of t.docChanges)3!==n.type&&e.push(n);t=new El(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.W_?this.z_(t)&&(this.U_.next(t),e=!0):this.j_(t,this.onlineState)&&(this.H_(t),e=!0),this.G_=t,e}onError(t){this.U_.error(t)}Q_(t){this.onlineState=t;let e=!1;return this.G_&&!this.W_&&this.j_(this.G_,t)&&(this.H_(this.G_),e=!0),e}j_(t,e){if(!t.fromCache)return!0;const n="Offline"!==e;return(!this.options.J_||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}z_(t){if(t.docChanges.length>0)return!0;const e=this.G_&&this.G_.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges}H_(t){t=El.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.W_=!0,this.U_.next(t)}}class Rl{constructor(t){this.key=t}}class Nl{constructor(t){this.key=t}}class Pl{constructor(t,e){this.query=t,this.ia=e,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=uo(),this.mutatedKeys=uo(),this._a=Qs(t),this.aa=new _l(this._a)}get ua(){return this.ia}ca(t,e){const n=e?e.la:new bl,i=e?e.aa:this.aa;let r=e?e.mutatedKeys:this.mutatedKeys,s=i,o=!1;const a="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,u="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(((t,e)=>{const l=i.get(t),c=Ks(this.query,e)?e:null,h=!!l&&this.mutatedKeys.has(l.key),d=!!c&&(c.hasLocalMutations||this.mutatedKeys.has(c.key)&&c.hasCommittedMutations);let f=!1;l&&c?l.data.isEqual(c.data)?h!==d&&(n.track({type:3,doc:c}),f=!0):this.ha(l,c)||(n.track({type:2,doc:c}),f=!0,(a&&this._a(c,a)>0||u&&this._a(c,u)<0)&&(o=!0)):!l&&c?(n.track({type:0,doc:c}),f=!0):l&&!c&&(n.track({type:1,doc:l}),f=!0,(a||u)&&(o=!0)),f&&(c?(s=s.add(c),r=d?r.add(t):r.delete(t)):(s=s.delete(t),r=r.delete(t)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const t="F"===this.query.limitType?s.last():s.first();s=s.delete(t.key),r=r.delete(t.key),n.track({type:1,doc:t})}return{aa:s,la:n,Zi:o,mutatedKeys:r}}ha(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n,i){const r=this.aa;this.aa=t.aa,this.mutatedKeys=t.mutatedKeys;const s=t.la.L_();s.sort(((t,e)=>function(t,e){const n=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Mi()}};return n(t)-n(e)}(t.type,e.type)||this._a(t.doc,e.doc))),this.Pa(n),i=null!=i&&i;const o=e&&!i?this.Ia():[],a=0===this.oa.size&&this.current&&!i?1:0,u=a!==this.sa;return this.sa=a,0!==s.length||u?{snapshot:new El(this.query,t.aa,r,s,t.mutatedKeys,0===a,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),Ta:o}:{Ta:o}}Q_(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({aa:this.aa,la:new bl,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(t){return!this.ia.has(t)&&!!this.aa.has(t)&&!this.aa.get(t).hasLocalMutations}Pa(t){t&&(t.addedDocuments.forEach((t=>this.ia=this.ia.add(t))),t.modifiedDocuments.forEach((t=>{})),t.removedDocuments.forEach((t=>this.ia=this.ia.delete(t))),this.current=t.current)}Ia(){if(!this.current)return[];const t=this.oa;this.oa=uo(),this.aa.forEach((t=>{this.Ea(t.key)&&(this.oa=this.oa.add(t.key))}));const e=[];return t.forEach((t=>{this.oa.has(t)||e.push(new Nl(t))})),this.oa.forEach((n=>{t.has(n)||e.push(new Rl(n))})),e}da(t){this.ia=t.ls,this.oa=uo();const e=this.ca(t.documents);return this.applyChanges(e,!0)}Aa(){return El.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,0===this.sa,this.hasCachedResults)}}class Ll{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class Ol{constructor(t){this.key=t,this.Ra=!1}}class Ml{constructor(t,e,n,i,r,s){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=s,this.Va={},this.ma=new Ys((t=>Hs(t)),$s),this.fa=new Map,this.ga=new Set,this.pa=new Ar(or.comparator),this.ya=new Map,this.wa=new iu,this.Sa={},this.ba=new Map,this.Da=Ya.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return!0===this.Ca}}async function Vl(t,e){const n=ec(t);let i,r;const s=n.ma.get(e);if(s)i=s.targetId,n.sharedClientState.addLocalQueryTarget(i),r=s.view.Aa();else{const t=await bu(n.localStore,js(e)),s=n.sharedClientState.addLocalQueryTarget(t.targetId);i=t.targetId,r=await Fl(n,e,i,"current"===s,t.resumeToken),n.isPrimaryClient&&Gu(n.remoteStore,t)}return r}async function Fl(t,e,n,i,r){t.va=(e,n,i)=>async function(t,e,n,i){let r=e.view.ca(n);r.Zi&&(r=await Tu(t.localStore,e.query,!1).then((({documents:t})=>e.view.ca(t,r))));const s=i&&i.targetChanges.get(e.targetId),o=i&&null!=i.targetMismatches.get(e.targetId),a=e.view.applyChanges(r,t.isPrimaryClient,s,o);return Ql(t,e.targetId,a.Ta),a.snapshot}(t,e,n,i);const s=await Tu(t.localStore,e,!0),o=new Pl(e,s.ls),a=o.ca(s.documents),u=sa.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==t.onlineState,r),l=o.applyChanges(a,t.isPrimaryClient,u);Ql(t,n,l.Ta);const c=new Ll(e,n,o);return t.ma.set(e,c),t.fa.has(n)?t.fa.get(n).push(e):t.fa.set(n,[e]),l.snapshot}async function Ul(t,e){const n=Fi(t),i=n.ma.get(e),r=n.fa.get(i.targetId);if(r.length>1)return n.fa.set(i.targetId,r.filter((t=>!$s(t,e)))),void n.ma.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Eu(n.localStore,i.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(i.targetId),Ku(n.remoteStore,i.targetId),Kl(n,i.targetId)})).catch(pr)):(Kl(n,i.targetId),await Eu(n.localStore,i.targetId,!0))}async function Bl(t,e){const n=Fi(t);try{const t=await function(t,e){const n=Fi(t),i=e.snapshotVersion;let r=n.ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(t=>{const s=n.ss.newChangeBuffer({trackRemovals:!0});r=n.ts;const o=[];e.targetChanges.forEach(((s,a)=>{const u=r.get(a);if(!u)return;o.push(n.qr.removeMatchingKeys(t,s.removedDocuments,a).next((()=>n.qr.addMatchingKeys(t,s.addedDocuments,a))));let l=u.withSequenceNumber(t.currentSequenceNumber);null!==e.targetMismatches.get(a)?l=l.withResumeToken(Lr.EMPTY_BYTE_STRING,er.min()).withLastLimboFreeSnapshotVersion(er.min()):s.resumeToken.approximateByteSize()>0&&(l=l.withResumeToken(s.resumeToken,i)),r=r.insert(a,l),function(t,e,n){return 0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(u,l,s)&&o.push(n.qr.updateTargetData(t,l))}));let a=Zs(),u=uo();if(e.documentUpdates.forEach((i=>{e.resolvedLimboDocuments.has(i)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(t,i))})),o.push(wu(t,s,e.documentUpdates).next((t=>{a=t.us,u=t.cs}))),!i.isEqual(er.min())){const e=n.qr.getLastRemoteSnapshotVersion(t).next((e=>n.qr.setTargetsMetadata(t,t.currentSequenceNumber,i)));o.push(e)}return mr.waitFor(o).next((()=>s.apply(t))).next((()=>n.localDocuments.getLocalViewOfDocuments(t,a,u))).next((()=>a))})).then((t=>(n.ts=r,t)))}(n.localStore,e);e.targetChanges.forEach(((t,e)=>{const i=n.ya.get(e);i&&(Vi(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?i.Ra=!0:t.modifiedDocuments.size>0?Vi(i.Ra):t.removedDocuments.size>0&&(Vi(i.Ra),i.Ra=!1))})),await Jl(n,t,e)}catch(t){await pr(t)}}function jl(t,e,n){const i=Fi(t);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const t=[];i.ma.forEach(((n,i)=>{const r=i.view.Q_(e);r.snapshot&&t.push(r.snapshot)})),function(t,e){const n=Fi(t);n.onlineState=e;let i=!1;n.queries.forEach(((t,n)=>{for(const t of n.listeners)t.Q_(e)&&(i=!0)})),i&&Dl(n)}(i.eventManager,e),t.length&&i.Va.a_(t),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function ql(t,e,n){const i=Fi(t);i.sharedClientState.updateQueryState(e,"rejected",n);const r=i.ya.get(e),s=r&&r.key;if(s){let t=new Ar(or.comparator);t=t.insert(s,as.newNoDocument(s,er.min()));const n=uo().add(s),r=new ra(er.min(),new Map,new Ar(Ji),t,n);await Bl(i,r),i.pa=i.pa.remove(s),i.ya.delete(e),Yl(i)}else await Eu(i.localStore,e,!1).then((()=>Kl(i,e,n))).catch(pr)}async function zl(t,e){const n=Fi(t),i=e.batch.batchId;try{const t=await function(t,e){const n=Fi(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const i=e.batch.keys(),r=n.ss.newChangeBuffer({trackRemovals:!0});return function(t,e,n,i){const r=n.batch,s=r.keys();let o=mr.resolve();return s.forEach((t=>{o=o.next((()=>i.getEntry(e,t))).next((e=>{const s=n.docVersions.get(t);Vi(null!==s),e.version.compareTo(s)<0&&(r.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),i.addEntry(e)))}))})),o.next((()=>t.mutationQueue.removeMutationBatch(e,r)))}(n,t,e,r).next((()=>r.apply(t))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){let e=uo();for(let n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e)))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(n.localStore,e);Gl(n,i,null),Hl(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await Jl(n,t)}catch(t){await pr(t)}}async function $l(t,e,n){const i=Fi(t);try{const t=await function(t,e){const n=Fi(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let i;return n.mutationQueue.lookupMutationBatch(t,e).next((e=>(Vi(null!==e),i=e.keys(),n.mutationQueue.removeMutationBatch(t,e)))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,i))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(i.localStore,e);Gl(i,e,n),Hl(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await Jl(i,t)}catch(n){await pr(n)}}function Hl(t,e){(t.ba.get(e)||[]).forEach((t=>{t.resolve()})),t.ba.delete(e)}function Gl(t,e,n){const i=Fi(t);let r=i.Sa[i.currentUser.toKey()];if(r){const t=r.get(e);t&&(n?t.reject(n):t.resolve(),r=r.remove(e)),i.Sa[i.currentUser.toKey()]=r}}function Kl(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.fa.get(e))t.ma.delete(i),n&&t.Va.Fa(i,n);t.fa.delete(e),t.isPrimaryClient&&t.wa.Rr(e).forEach((e=>{t.wa.containsKey(e)||Wl(t,e)}))}function Wl(t,e){t.ga.delete(e.path.canonicalString());const n=t.pa.get(e);null!==n&&(Ku(t.remoteStore,n),t.pa=t.pa.remove(e),t.ya.delete(n),Yl(t))}function Ql(t,e,n){for(const i of n)i instanceof Rl?(t.wa.addReference(i.key,e),Xl(t,i)):i instanceof Nl?(Ni("SyncEngine","Document no longer in limbo: "+i.key),t.wa.removeReference(i.key,e),t.wa.containsKey(i.key)||Wl(t,i.key)):Mi()}function Xl(t,e){const n=e.key,i=n.path.canonicalString();t.pa.get(n)||t.ga.has(i)||(Ni("SyncEngine","New document in limbo: "+n),t.ga.add(i),Yl(t))}function Yl(t){for(;t.ga.size>0&&t.pa.size<t.maxConcurrentLimboResolutions;){const e=t.ga.values().next().value;t.ga.delete(e);const n=new or(ir.fromString(e)),i=t.Da.next();t.ya.set(i,new Ol(n)),t.pa=t.pa.insert(n,i),Gu(t.remoteStore,new $a(js(Vs(n.path)),i,"TargetPurposeLimboResolution",yr._e))}}async function Jl(t,e,n){const i=Fi(t),r=[],s=[],o=[];i.ma.isEmpty()||(i.ma.forEach(((t,a)=>{o.push(i.va(a,e,n).then((t=>{if((t||n)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,(null==t?void 0:t.fromCache)?"not-current":"current"),t){r.push(t);const e=du.Qi(a.targetId,t);s.push(e)}})))})),await Promise.all(o),i.Va.a_(r),await async function(t,e){const n=Fi(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>mr.forEach(e,(e=>mr.forEach(e.ki,(i=>n.persistence.referenceDelegate.addReference(t,e.targetId,i))).next((()=>mr.forEach(e.qi,(i=>n.persistence.referenceDelegate.removeReference(t,e.targetId,i)))))))))}catch(t){if(!gr(t))throw t;Ni("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.ts.get(e),i=t.snapshotVersion,r=t.withLastLimboFreeSnapshotVersion(i);n.ts=n.ts.insert(e,r)}}}(i.localStore,s))}async function Zl(t,e){const n=Fi(t);if(!n.currentUser.isEqual(e)){Ni("SyncEngine","User change. New user:",e.toKey());const t=await yu(n.localStore,e);n.currentUser=e,function(t,e){t.ba.forEach((t=>{t.forEach((t=>{t.reject(new Bi(Ui.CANCELLED,e))}))})),t.ba.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await Jl(n,t._s)}}function tc(t,e){const n=Fi(t),i=n.ya.get(e);if(i&&i.Ra)return uo().add(i.key);{let t=uo();const i=n.fa.get(e);if(!i)return t;for(const e of i){const i=n.ma.get(e);t=t.unionWith(i.view.ua)}return t}}function ec(t){const e=Fi(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Bl.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=tc.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ql.bind(null,e),e.Va.a_=Al.bind(null,e.eventManager),e.Va.Fa=kl.bind(null,e.eventManager),e}function nc(t){const e=Fi(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=zl.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=$l.bind(null,e),e}class ic{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=Mu(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,e){return null}createIndexBackfillerScheduler(t,e){return null}createLocalStore(t){return gu(this.persistence,new pu,t.initialUser,this.serializer)}createPersistence(t){return new lu(hu.jr,this.serializer)}createSharedClientState(t){return new Iu}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class rc{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>jl(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=Zl.bind(null,this.syncEngine),await ml(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new Sl}createDatastore(t){const e=Mu(t.databaseInfo.databaseId),n=function(t){return new Lu(t)}(t.databaseInfo);return function(t,e,n,i){return new ju(t,e,n,i)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return function(t,e,n,i,r){return new zu(t,e,n,i,r)}(this.localStore,this.datastore,t.asyncQueue,(t=>jl(this.syncEngine,t,0)),ku.D()?new ku:new Au)}createSyncEngine(t,e){return function(t,e,n,i,r,s,o){const a=new Ml(t,e,n,i,r,s);return o&&(a.Ca=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return async function(t){const e=Fi(t);Ni("RemoteStore","RemoteStore shutting down."),e.C_.add(5),await Hu(e),e.F_.shutdown(),e.M_.set("Unknown")}(this.remoteStore)}}class sc{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Oa(this.observer.next,t)}error(t){this.observer.error?this.Oa(this.observer.error,t):Pi("Uncaught Error in snapshot listener:",t.toString())}Na(){this.muted=!0}Oa(t,e){this.muted||setTimeout((()=>{this.muted||t(e)}),0)}}class oc{constructor(t,e,n,i){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=ki.UNAUTHENTICATED,this.clientId=Yi.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async t=>{Ni("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(Ni("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Bi(Ui.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new ji;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=wl(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function ac(t,e){t.asyncQueue.verifyOperationInProgress(),Ni("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async t=>{i.isEqual(t)||(await yu(e.localStore,t),i=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function uc(t,e){t.asyncQueue.verifyOperationInProgress();const n=await cc(t);Ni("FirestoreClient","Initializing OnlineComponentProvider");const i=await t.getConfiguration();await e.initialize(n,i),t.setCredentialChangeListener((t=>pl(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,n)=>pl(e.remoteStore,n))),t._onlineComponents=e}function lc(t){return"FirebaseError"===t.name?t.code===Ui.FAILED_PRECONDITION||t.code===Ui.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}async function cc(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ni("FirestoreClient","Using user provided OfflineComponentProvider");try{await ac(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!lc(n))throw n;Li("Error using user provided cache. Falling back to memory cache: "+n),await ac(t,new ic)}}else Ni("FirestoreClient","Using default OfflineComponentProvider"),await ac(t,new ic);return t._offlineComponents}async function hc(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ni("FirestoreClient","Using user provided OnlineComponentProvider"),await uc(t,t._uninitializedComponentsProvider._online)):(Ni("FirestoreClient","Using default OnlineComponentProvider"),await uc(t,new rc))),t._onlineComponents}function dc(t){return hc(t).then((t=>t.syncEngine))}async function fc(t){const e=await hc(t),n=e.eventManager;return n.onListen=Vl.bind(null,e.syncEngine),n.onUnlisten=Ul.bind(null,e.syncEngine),n}function pc(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const mc=new Map;function gc(t,e,n){if(!n)throw new Bi(Ui.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function yc(t){if(!or.isDocumentKey(t))throw new Bi(Ui.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function vc(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":Mi()}function wc(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Bi(Ui.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=vc(t);throw new Bi(Ui.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}class _c{constructor(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new Bi(Ui.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Bi(Ui.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(t,e,n,i){if(!0===e&&!0===i)throw new Bi(Ui.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)})("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=pc(null!==(n=t.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(t){if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new Bi(Ui.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (must not be NaN)`);if(t.timeoutSeconds<5)throw new Bi(Ui.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (minimum allowed value is 5)`);if(t.timeoutSeconds>30)throw new Bi(Ui.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(t,e){return t.timeoutSeconds===e.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class bc{constructor(t,e,n,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new _c({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Bi(Ui.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new Bi(Ui.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new _c(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new zi;switch(t.type){case"firstParty":return new Ki(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Bi(Ui.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=mc.get(t);e&&(Ni("ComponentProvider","Removing Datastore"),mc.delete(t),e.terminate())}(this),Promise.resolve()}}class Ec{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new Ec(this.firestore,t,this._query)}}class Tc{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Sc(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Tc(this.firestore,t,this._key)}}class Sc extends Ec{constructor(t,e,n){super(t,e,Vs(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Tc(this.firestore,null,new or(t))}withConverter(t){return new Sc(this.firestore,t,this._path)}}function Cc(t,e,...n){if(t=(0,a.m9)(t),1===arguments.length&&(e=Yi.newId()),gc("doc","path",e),t instanceof bc){const i=ir.fromString(e,...n);return yc(i),new Tc(t,null,new or(i))}{if(!(t instanceof Tc||t instanceof Sc))throw new Bi(Ui.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(ir.fromString(e,...n));return yc(i),new Tc(t.firestore,t instanceof Sc?t.converter:null,new or(i))}}function Ic(t,e){return t=(0,a.m9)(t),e=(0,a.m9)(e),(t instanceof Tc||t instanceof Sc)&&(e instanceof Tc||e instanceof Sc)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}class Ac{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new Vu(this,"async_queue_retry"),this.iu=()=>{const t=Ou();t&&Ni("AsyncQueue","Visibility state changed to "+t.visibilityState),this.zo.Qo()};const t=Ou();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.su(),this.ou(t)}enterRestrictedMode(t){if(!this.Za){this.Za=!0,this.nu=t||!1;const e=Ou();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.iu)}}enqueue(t){if(this.su(),this.Za)return new Promise((()=>{}));const e=new ji;return this.ou((()=>this.Za&&this.nu?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Ya.push(t),this._u())))}async _u(){if(0!==this.Ya.length){try{await this.Ya[0](),this.Ya.shift(),this.zo.reset()}catch(t){if(!gr(t))throw t;Ni("AsyncQueue","Operation failed with retryable error: "+t)}this.Ya.length>0&&this.zo.ko((()=>this._u()))}}ou(t){const e=this.Ja.then((()=>(this.tu=!0,t().catch((t=>{this.eu=t,this.tu=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw Pi("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this.tu=!1,t))))));return this.Ja=e,e}enqueueAfterDelay(t,e,n){this.su(),this.ru.indexOf(t)>-1&&(e=0);const i=vl.createAndSchedule(this,t,e,n,(t=>this.au(t)));return this.Xa.push(i),i}su(){this.eu&&Mi()}verifyOperationInProgress(){}async uu(){let t;do{t=this.Ja,await t}while(t!==this.Ja)}cu(t){for(const e of this.Xa)if(e.timerId===t)return!0;return!1}lu(t){return this.uu().then((()=>{this.Xa.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.Xa)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.uu()}))}hu(t){this.ru.push(t)}au(t){const e=this.Xa.indexOf(t);this.Xa.splice(e,1)}}function kc(t){return function(t,e){if("object"!=typeof t||null===t)return!1;const n=t;for(const t of e)if(t in n&&"function"==typeof n[t])return!0;return!1}(t,["next","error","complete"])}class Dc extends bc{constructor(t,e,n,i){super(t,e,n,i),this.type="firestore",this._queue=new Ac,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Nc(this),this._firestoreClient.terminate()}}function xc(t,e){const n="object"==typeof t?t:(0,r.Mq)(),i="string"==typeof t?t:e||"(default)",s=(0,r.qX)(n,"firestore").getImmediate({identifier:i});if(!s._initialized){const t=(0,a.P0)("firestore");t&&function(t,e,n,i={}){var r;const s=(t=wc(t,bc))._getSettings(),o=`${e}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&Li("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let e,n;if("string"==typeof i.mockUserToken)e=i.mockUserToken,n=ki.MOCK_USER;else{e=(0,a.Sg)(i.mockUserToken,null===(r=t._app)||void 0===r?void 0:r.options.projectId);const s=i.mockUserToken.sub||i.mockUserToken.user_id;if(!s)throw new Bi(Ui.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new ki(s)}t._authCredentials=new $i(new qi(e,n))}}(s,...t)}return s}function Rc(t){return t._firestoreClient||Nc(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Nc(t){var e,n,i;const r=t._freezeSettings(),s=function(t,e,n,i){return new qr(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,pc(i.experimentalLongPollingOptions),i.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,r);t._firestoreClient=new oc(t._authCredentials,t._appCheckCredentials,t._queue,s),(null===(n=r.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(i=r.localCache)||void 0===i?void 0:i._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.localCache.kind,_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider})}class Pc{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Pc(Lr.fromBase64String(t))}catch(t){throw new Bi(Ui.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new Pc(Lr.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Lc{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new Bi(Ui.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new sr(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Oc{constructor(t){this._methodName=t}}class Mc{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Bi(Ui.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Bi(Ui.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return Ji(this._lat,t._lat)||Ji(this._long,t._long)}}const Vc=/^__.*__$/;class Fc{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new Vo(t,this.data,this.fieldMask,e,this.fieldTransforms):new Mo(t,this.data,e,this.fieldTransforms)}}function Uc(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Mi()}}class Bc{constructor(t,e,n,i,r,s){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.Pu(),this.fieldTransforms=r||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(t){return new Bc(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Tu({path:n,du:!1});return i.Au(t),i}Ru(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Tu({path:n,du:!1});return i.Pu(),i}Vu(t){return this.Tu({path:void 0,du:!0})}mu(t){return Yc(t,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}Pu(){if(this.path)for(let t=0;t<this.path.length;t++)this.Au(this.path.get(t))}Au(t){if(0===t.length)throw this.mu("Document fields must not be empty");if(Uc(this.Iu)&&Vc.test(t))throw this.mu('Document fields cannot begin and end with "__"')}}class jc{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||Mu(t)}pu(t,e,n,i=!1){return new Bc({Iu:t,methodName:e,gu:n,path:sr.emptyPath(),du:!1,fu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function qc(t){const e=t._freezeSettings(),n=Mu(t._databaseId);return new jc(t._databaseId,!!e.ignoreUndefinedProperties,n)}function zc(t,e,n,i,r,s={}){const o=t.pu(s.merge||s.mergeFields?2:0,e,n,r);Kc("Data must be an object, but it was:",o,i);const a=Hc(i,o);let u,l;if(s.merge)u=new Nr(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){const t=[];for(const i of s.mergeFields){const r=Wc(e,i,n);if(!o.contains(r))throw new Bi(Ui.INVALID_ARGUMENT,`Field '${r}' is specified in your field mask but missing from your input data.`);Jc(t,r)||t.push(r)}u=new Nr(t),l=o.fieldTransforms.filter((t=>u.covers(t.field)))}else u=null,l=o.fieldTransforms;return new Fc(new ss(a),u,l)}function $c(t,e){if(Gc(t=(0,a.m9)(t)))return Kc("Unsupported field value:",e,t),Hc(t,e);if(t instanceof Oc)return function(t,e){if(!Uc(e.Iu))throw e.mu(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.mu(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.du&&4!==e.Iu)throw e.mu("Nested arrays are not supported");return function(t,e){const n=[];let i=0;for(const r of t){let t=$c(r,e.Vu(i));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),i++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=(0,a.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return po(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=tr.fromDate(t);return{timestampValue:va(e.serializer,n)}}if(t instanceof tr){const n=new tr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:va(e.serializer,n)}}if(t instanceof Mc)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Pc)return{bytesValue:wa(e.serializer,t._byteString)};if(t instanceof Tc){const n=e.databaseId,i=t.firestore._databaseId;if(!i.isEqual(n))throw e.mu(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Ea(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.mu(`Unsupported field value: ${vc(t)}`)}(t,e)}function Hc(t,e){const n={};return Ir(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Cr(t,((t,i)=>{const r=$c(i,e.Eu(t));null!=r&&(n[t]=r)})),{mapValue:{fields:n}}}function Gc(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof tr||t instanceof Mc||t instanceof Pc||t instanceof Tc||t instanceof Oc)}function Kc(t,e,n){if(!Gc(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const i=vc(n);throw"an object"===i?e.mu(t+" a custom object"):e.mu(t+" "+i)}}function Wc(t,e,n){if((e=(0,a.m9)(e))instanceof Lc)return e._internalPath;if("string"==typeof e)return Xc(t,e);throw Yc("Field path arguments must be of type string or ",t,!1,void 0,n)}const Qc=new RegExp("[~\\*/\\[\\]]");function Xc(t,e,n){if(e.search(Qc)>=0)throw Yc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Lc(...e.split("."))._internalPath}catch(i){throw Yc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Yc(t,e,n,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${i}`),o&&(u+=` in document ${r}`),u+=")"),new Bi(Ui.INVALID_ARGUMENT,a+t+u)}function Jc(t,e){return t.some((t=>t.isEqual(e)))}class Zc{constructor(t,e,n,i,r){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new Tc(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new th(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(eh("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class th extends Zc{data(){return super.data()}}function eh(t,e){return"string"==typeof e?Xc(t,e):e instanceof Lc?e._internalPath:e._delegate._internalPath}function nh(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new Bi(Ui.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ih{convertValue(t,e="none"){switch(Hr(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Vr(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Fr(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Mi()}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const n={};return Cr(t,((t,i)=>{n[t]=this.convertValue(i,e)})),n}convertGeoPoint(t){return new Mc(Vr(t.latitude),Vr(t.longitude))}convertArray(t,e){return(t.values||[]).map((t=>this.convertValue(t,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=Br(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(jr(t));default:return null}}convertTimestamp(t){const e=Mr(t);return new tr(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=ir.fromString(t);Vi(za(n));const i=new zr(n.get(1),n.get(3)),r=new or(n.popFirst(5));return i.isEqual(e)||Pi(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),r}}function rh(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}class sh{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class oh extends Zc{constructor(t,e,n,i,r,s){super(t,e,n,i,s),this._firestore=t,this._firestoreImpl=t,this.metadata=r}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new ah(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(eh("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}}class ah extends oh{data(t={}){return super.data(t)}}class uh{constructor(t,e,n,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new sh(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach((n=>{t.call(e,new ah(this._firestore,this._userDataWriter,n.key,n,new sh(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Bi(Ui.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){let e=0;return t._snapshot.docChanges.map((n=>{const i=new ah(t._firestore,t._userDataWriter,n.doc.key,n.doc,new sh(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter);return n.doc,{type:"added",doc:i,oldIndex:-1,newIndex:e++}}))}{let n=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((t=>e||3!==t.type)).map((e=>{const i=new ah(t._firestore,t._userDataWriter,e.doc.key,e.doc,new sh(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);let r=-1,s=-1;return 0!==e.type&&(r=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(n=n.add(e.doc),s=n.indexOf(e.doc.key)),{type:lh(e.type),doc:i,oldIndex:r,newIndex:s}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function lh(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Mi()}}class ch extends ih{constructor(t){super(),this.firestore=t}convertBytes(t){return new Pc(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Tc(this.firestore,null,e)}}function hh(t,e,n){t=wc(t,Tc);const i=wc(t.firestore,Dc),r=rh(t.converter,e,n);return fh(i,[zc(qc(i),"setDoc",t._key,r,null!==t.converter,n).toMutation(t._key,ko.none())])}function dh(t,...e){var n,i,r;t=(0,a.m9)(t);let s={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||kc(e[o])||(s=e[o],o++);const u={includeMetadataChanges:s.includeMetadataChanges};if(kc(e[o])){const t=e[o];e[o]=null===(n=t.next)||void 0===n?void 0:n.bind(t),e[o+1]=null===(i=t.error)||void 0===i?void 0:i.bind(t),e[o+2]=null===(r=t.complete)||void 0===r?void 0:r.bind(t)}let l,c,h;if(t instanceof Tc)c=wc(t.firestore,Dc),h=Vs(t._key.path),l={next:n=>{e[o]&&e[o](ph(c,t,n))},error:e[o+1],complete:e[o+2]};else{const n=wc(t,Ec);c=wc(n.firestore,Dc),h=n._query;const i=new ch(c);l={next:t=>{e[o]&&e[o](new uh(c,i,n,t))},error:e[o+1],complete:e[o+2]},nh(t._query)}return function(t,e,n,i){const r=new sc(i),s=new xl(e,r,n);return t.asyncQueue.enqueueAndForget((async()=>Cl(await fc(t),s))),()=>{r.Na(),t.asyncQueue.enqueueAndForget((async()=>Il(await fc(t),s)))}}(Rc(c),h,u,l)}function fh(t,e){return function(t,e){const n=new ji;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,n){const i=nc(t);try{const t=await function(t,e){const n=Fi(t),i=tr.now(),r=e.reduce(((t,e)=>t.add(e.key)),uo());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>{let a=Zs(),u=uo();return n.ss.getEntries(t,r).next((t=>{a=t,a.forEach(((t,e)=>{e.isValidDocument()||(u=u.add(t))}))})).next((()=>n.localDocuments.getOverlayedDocuments(t,a))).next((r=>{s=r;const o=[];for(const t of e){const e=Lo(t,s.get(t.key).overlayedDocument);null!=e&&o.push(new Vo(t.key,e,os(e.value.mapValue),ko.exists(!0)))}return n.mutationQueue.addMutationBatch(t,i,o,e)})).next((e=>{o=e;const i=e.applyToLocalDocumentSet(s,u);return n.documentOverlayCache.saveOverlays(t,e.batchId,i)}))})).then((()=>({batchId:o.batchId,changes:no(s)})))}(i.localStore,e);i.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let i=t.Sa[t.currentUser.toKey()];i||(i=new Ar(Ji)),i=i.insert(e,n),t.Sa[t.currentUser.toKey()]=i}(i,t.batchId,n),await Jl(i,t.changes),await sl(i.remoteStore)}catch(t){const e=wl(t,"Failed to persist write");n.reject(e)}}(await dc(t),e,n))),n.promise}(Rc(t),e)}function ph(t,e,n){const i=n.docs.get(e._key),r=new ch(t);return new oh(t,r,e._key,i,new sh(n.hasPendingWrites,n.fromCache),e.converter)}new WeakMap;!function(t,e=!0){!function(t){Di=t}(r.Jn),(0,r.Xd)(new s.wA("firestore",((t,{instanceIdentifier:n,options:i})=>{const r=t.getProvider("app").getImmediate(),s=new Dc(new Hi(t.getProvider("auth-internal")),new Qi(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Bi(Ui.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new zr(t.options.projectId,e)}(r,n),r);return i=Object.assign({useFetchStreams:e},i),s._setSettings(i),s}),"PUBLIC").setMultipleInstances(!0)),(0,r.KN)(Ai,"4.4.0",t),(0,r.KN)(Ai,"4.4.0","esm2017")}()},68650:(t,e,n)=>{n.r(e),n.d(e,{AggregateField:()=>fn,AggregateQuerySnapshot:()=>pn,Bytes:()=>Tn,CollectionReference:()=>yn,DocumentReference:()=>gn,DocumentSnapshot:()=>ti,FieldPath:()=>Sn,FieldValue:()=>In,Firestore:()=>un,FirestoreError:()=>N,GeoPoint:()=>An,Query:()=>mn,QueryCompositeFilterConstraint:()=>ci,QueryConstraint:()=>oi,QueryDocumentSnapshot:()=>ei,QueryEndAtConstraint:()=>bi,QueryFieldFilterConstraint:()=>ui,QueryLimitConstraint:()=>mi,QueryOrderByConstraint:()=>fi,QuerySnapshot:()=>ni,QueryStartAtConstraint:()=>vi,Timestamp:()=>Tt,Transaction:()=>rr,WriteBatch:()=>Qi,addDoc:()=>Mi,aggregateFieldEqual:()=>qi,aggregateQuerySnapshotEqual:()=>zi,and:()=>di,arrayRemove:()=>Ki,arrayUnion:()=>Gi,average:()=>Bi,collection:()=>vn,collectionGroup:()=>wn,connectFirestoreEmulator:()=>hn,count:()=>ji,deleteDoc:()=>Oi,deleteField:()=>$i,doc:()=>_n,documentId:()=>Cn,endAt:()=>Ti,endBefore:()=>Ei,getAggregate:()=>Fi,getCount:()=>Vi,getDoc:()=>Ri,getDocs:()=>Ni,getFirestore:()=>cn,increment:()=>Wi,initializeFirestore:()=>ln,limit:()=>gi,limitToLast:()=>yi,or:()=>hi,orderBy:()=>pi,query:()=>ai,queryEqual:()=>En,refEqual:()=>bn,runTransaction:()=>sr,serverTimestamp:()=>Hi,setDoc:()=>Pi,setLogLevel:()=>c,snapshotEqual:()=>ii,startAfter:()=>_i,startAt:()=>wi,sum:()=>Ui,terminate:()=>dn,updateDoc:()=>Li,where:()=>li,writeBatch:()=>Yi});var i=n(10389),r=n(8463),s=n(53333),o=n(74444);class a{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}a.UNAUTHENTICATED=new a(null),a.GOOGLE_CREDENTIALS=new a("google-credentials-uid"),a.FIRST_PARTY=new a("first-party-uid"),a.MOCK_USER=new a("mock-user");let u="10.7.0";const l=new s.Yd("@firebase/firestore");function c(t){l.setLogLevel(t)}function h(t,...e){if(l.logLevel<=s.in.DEBUG){const n=e.map(p);l.debug(`Firestore (${u}): ${t}`,...n)}}function d(t,...e){if(l.logLevel<=s.in.ERROR){const n=e.map(p);l.error(`Firestore (${u}): ${t}`,...n)}}function f(t,...e){if(l.logLevel<=s.in.WARN){const n=e.map(p);l.warn(`Firestore (${u}): ${t}`,...n)}}function p(t){if("string"==typeof t)return t;try{return function(t){return JSON.stringify(t)}(t)}catch(e){return t}}function m(t="Unexpected state"){const e=`FIRESTORE (${u}) INTERNAL ASSERTION FAILED: `+t;throw d(e),new Error(e)}function g(t,e){t||m()}function y(t,e){return t}const v="cancelled",w="unknown",_="invalid-argument",b="deadline-exceeded",E="not-found",T="permission-denied",S="unauthenticated",C="resource-exhausted",I="failed-precondition",A="aborted",k="out-of-range",D="unimplemented",x="internal",R="unavailable";class N extends o.ZR{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class P{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class L{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class O{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(a.UNAUTHENTICATED)))}shutdown(){}}class M{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class V{constructor(t){this.auth=null,t.onInit((t=>{this.auth=t}))}getToken(){return this.auth?this.auth.getToken().then((t=>t?(g("string"==typeof t.accessToken),new L(t.accessToken,new a(this.auth.getUid()))):null)):Promise.resolve(null)}invalidateToken(){}start(t,e){}shutdown(){}}class F{constructor(t,e,n){this.t=t,this.i=e,this.o=n,this.type="FirstParty",this.user=a.FIRST_PARTY,this.u=new Map}l(){return this.o?this.o():null}get headers(){this.u.set("X-Goog-AuthUser",this.t);const t=this.l();return t&&this.u.set("Authorization",t),this.i&&this.u.set("X-Goog-Iam-Authorization-Token",this.i),this.u}}class U{constructor(t,e,n){this.t=t,this.i=e,this.o=n}getToken(){return Promise.resolve(new F(this.t,this.i,this.o))}start(t,e){t.enqueueRetryable((()=>e(a.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class B{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class j{constructor(t){this.h=t,this.appCheck=null,t.onInit((t=>{this.appCheck=t}))}getToken(){return this.appCheck?this.appCheck.getToken().then((t=>t?(g("string"==typeof t.token),new B(t.token)):null)):Promise.resolve(null)}invalidateToken(){}start(t,e){}shutdown(){}}class q{constructor(t,e,n,i,r,s,o,a,u){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=u}}class z{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new z("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof z&&t.projectId===this.projectId&&t.database===this.database}}class ${constructor(t,e,n){void 0===e?e=0:e>t.length&&m(),void 0===n?n=t.length-e:n>t.length-e&&m(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===$.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof $?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const n=t.get(i),r=e.get(i);if(n<r)return-1;if(n>r)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class H extends ${construct(t,e,n){return new H(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new N(_,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new H(e)}static emptyPath(){return new H([])}}const G=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class K extends ${construct(t,e,n){return new K(t,e,n)}static isValidIdentifier(t){return G.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),K.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new K(["__name__"])}static fromServerFormat(t){const e=[];let n="",i=0;const r=()=>{if(0===n.length)throw new N(_,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let s=!1;for(;i<t.length;){const e=t[i];if("\\"===e){if(i+1===t.length)throw new N(_,"Path has trailing escape character: "+t);const e=t[i+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new N(_,"Path has invalid escape sequence: "+t);n+=e,i+=2}else"`"===e?(s=!s,i++):"."!==e||s?(n+=e,i++):(r(),i++)}if(r(),s)throw new N(_,"Unterminated ` in path: "+t);return new K(e)}static emptyPath(){return new K([])}}class W{constructor(t){this.path=t}static fromPath(t){return new W(H.fromString(t))}static fromName(t){return new W(H.fromString(t).popFirst(5))}static empty(){return new W(H.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===H.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return H.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new W(new H(t.slice()))}}function Q(t,e,n){if(!n)throw new N(_,`Function ${t}() cannot be called with an empty ${e}.`)}function X(t){if(!W.isDocumentKey(t))throw new N(_,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Y(t){if(W.isDocumentKey(t))throw new N(_,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function J(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":m()}function Z(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new N(_,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=J(t);throw new N(_,`Expected type '${e.name}', but it was: ${n}`)}}return t}function tt(t,e){if(e<=0)throw new N(_,`Function ${t}() requires a positive number, but it was: ${e}.`)}function et(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}let nt=null;function it(t){return null==t}function rt(t){return 0===t&&1/t==-1/0}const st={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var ot,at;function ut(t){if(void 0===t)return d("RPC_ERROR","HTTP error has no status"),w;switch(t){case 200:return"ok";case 400:return I;case 401:return S;case 403:return T;case 404:return E;case 409:return A;case 416:return k;case 429:return C;case 499:return v;case 500:return w;case 501:return D;case 503:return R;case 504:return b;default:return t>=200&&t<300?"ok":t>=400&&t<500?I:t>=500&&t<600?x:w}}(at=ot||(ot={}))[at.OK=0]="OK",at[at.CANCELLED=1]="CANCELLED",at[at.UNKNOWN=2]="UNKNOWN",at[at.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",at[at.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",at[at.NOT_FOUND=5]="NOT_FOUND",at[at.ALREADY_EXISTS=6]="ALREADY_EXISTS",at[at.PERMISSION_DENIED=7]="PERMISSION_DENIED",at[at.UNAUTHENTICATED=16]="UNAUTHENTICATED",at[at.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",at[at.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",at[at.ABORTED=10]="ABORTED",at[at.OUT_OF_RANGE=11]="OUT_OF_RANGE",at[at.UNIMPLEMENTED=12]="UNIMPLEMENTED",at[at.INTERNAL=13]="INTERNAL",at[at.UNAVAILABLE=14]="UNAVAILABLE",at[at.DATA_LOSS=15]="DATA_LOSS";class lt extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.m=e+"://"+t.host,this.A=`projects/${n}/databases/${i}`,this.T="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${i}`}get P(){return!1}R(t,e,n,i,r){const s=(null===nt?nt=268435456+Math.round(2147483648*Math.random()):nt++,"0x"+nt.toString(16)),o=this.I(t,e);h("RestConnection",`Sending RPC '${t}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.A,"x-goog-request-params":this.T};return this.V(a,i,r),this.p(t,o,a,n).then((e=>(h("RestConnection",`Received RPC '${t}' ${s}: `,e),e)),(e=>{throw f("RestConnection",`RPC '${t}' ${s} failed with error: `,e,"url: ",o,"request:",n),e}))}g(t,e,n,i,r,s){return this.R(t,e,n,i,r)}V(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+u,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}I(t,e){const n=st[t];return`${this.m}/v1/${e}:${n}`}}{constructor(t,e){super(t),this.F=e}v(t,e){throw new Error("Not supported by FetchConnection")}async p(t,e,n,i){var r;const s=JSON.stringify(i);let o;try{o=await this.F(e,{method:"POST",headers:n,body:s})}catch(t){const e=t;throw new N(ut(e.status),"Request failed with error: "+e.statusText)}if(!o.ok){let t=await o.json();Array.isArray(t)&&(t=t[0]);const e=null===(r=null==t?void 0:t.error)||void 0===r?void 0:r.message;throw new N(ut(o.status),`Request failed with error: ${null!=e?e:o.statusText}`)}return o.json()}}class ct{constructor(t,e,n){this.alias=t,this.aggregateType=e,this.fieldPath=n}}function ht(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class dt{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(256/62);let n="";for(;n.length<20;){const i=ht(40);for(let r=0;r<i.length;++r)n.length<20&&i[r]<e&&(n+=t.charAt(i[r]%62))}return n}}function ft(t,e){return t<e?-1:t>e?1:0}function pt(t,e,n){return t.length===e.length&&t.every(((t,i)=>n(t,e[i])))}function mt(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function gt(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}class yt extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class vt{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new yt("Invalid base64 string: "+t):t}}(t);return new vt(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new vt(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return ft(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}vt.EMPTY_BYTE_STRING=new vt("");const wt=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function _t(t){if(g(!!t),"string"==typeof t){let e=0;const n=wt.exec(t);if(g(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:bt(t.seconds),nanos:bt(t.nanos)}}function bt(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Et(t){return"string"==typeof t?vt.fromBase64String(t):vt.fromUint8Array(t)}class Tt{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new N(_,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new N(_,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new N(_,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new N(_,"Timestamp seconds out of range: "+t)}static now(){return Tt.fromMillis(Date.now())}static fromDate(t){return Tt.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new Tt(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?ft(this.nanoseconds,t.nanoseconds):ft(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}function St(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Ct(t){const e=t.mapValue.fields.__previous_value__;return St(e)?Ct(e):e}function It(t){const e=_t(t.mapValue.fields.__local_write_time__.timestampValue);return new Tt(e.seconds,e.nanos)}const At={fields:{__type__:{stringValue:"__max__"}}};function kt(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?St(t)?4:function(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}(t)?9007199254740991:10:m()}function Dt(t,e){if(t===e)return!0;const n=kt(t);if(n!==kt(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return It(t).isEqual(It(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=_t(t.timestampValue),i=_t(e.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Et(t.bytesValue).isEqual(Et(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return bt(t.geoPointValue.latitude)===bt(e.geoPointValue.latitude)&&bt(t.geoPointValue.longitude)===bt(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return bt(t.integerValue)===bt(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=bt(t.doubleValue),i=bt(e.doubleValue);return n===i?rt(n)===rt(i):isNaN(n)&&isNaN(i)}return!1}(t,e);case 9:return pt(t.arrayValue.values||[],e.arrayValue.values||[],Dt);case 10:return function(t,e){const n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(mt(n)!==mt(i))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===i[t]||!Dt(n[t],i[t])))return!1;return!0}(t,e);default:return m()}}function xt(t,e){return void 0!==(t.values||[]).find((t=>Dt(t,e)))}function Rt(t,e){if(t===e)return 0;const n=kt(t),i=kt(e);if(n!==i)return ft(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return ft(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=bt(t.integerValue||t.doubleValue),i=bt(e.integerValue||e.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(t,e);case 3:return Nt(t.timestampValue,e.timestampValue);case 4:return Nt(It(t),It(e));case 5:return ft(t.stringValue,e.stringValue);case 6:return function(t,e){const n=Et(t),i=Et(e);return n.compareTo(i)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),i=e.split("/");for(let t=0;t<n.length&&t<i.length;t++){const e=ft(n[t],i[t]);if(0!==e)return e}return ft(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=ft(bt(t.latitude),bt(e.latitude));return 0!==n?n:ft(bt(t.longitude),bt(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],i=e.values||[];for(let t=0;t<n.length&&t<i.length;++t){const e=Rt(n[t],i[t]);if(e)return e}return ft(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===At&&e===At)return 0;if(t===At)return 1;if(e===At)return-1;const n=t.fields||{},i=Object.keys(n),r=e.fields||{},s=Object.keys(r);i.sort(),s.sort();for(let t=0;t<i.length&&t<s.length;++t){const e=ft(i[t],s[t]);if(0!==e)return e;const o=Rt(n[i[t]],r[s[t]]);if(0!==o)return o}return ft(i.length,s.length)}(t.mapValue,e.mapValue);default:throw m()}}function Nt(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return ft(t,e);const n=_t(t),i=_t(e),r=ft(n.seconds,i.seconds);return 0!==r?r:ft(n.nanos,i.nanos)}function Pt(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Lt(t){return!!t&&"arrayValue"in t}function Ot(t){return!!t&&"nullValue"in t}function Mt(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Vt(t){return!!t&&"mapValue"in t}function Ft(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return gt(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=Ft(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ft(t.arrayValue.values[n]);return e}return Object.assign({},t)}class Ut{constructor(t,e){this.position=t,this.inclusive=e}}function Bt(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Dt(t.position[n],e.position[n]))return!1;return!0}class jt{}class qt extends jt{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new Ht(t,e,n):"array-contains"===e?new Qt(t,n):"in"===e?new Xt(t,n):"not-in"===e?new Yt(t,n):"array-contains-any"===e?new Jt(t,n):new qt(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new Gt(t,n):new Kt(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(Rt(e,this.value)):null!==e&&kt(this.value)===kt(e)&&this.matchesComparison(Rt(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return m()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class zt extends jt{constructor(t,e){super(),this.filters=t,this.op=e,this.D=null}static create(t,e){return new zt(t,e)}matches(t){return function(t){return"and"===t.op}(this)?void 0===this.filters.find((e=>!e.matches(t))):void 0!==this.filters.find((e=>e.matches(t)))}getFlattenedFilters(){return null!==this.D||(this.D=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.D}getFilters(){return Object.assign([],this.filters)}}function $t(t,e){return t instanceof qt?function(t,e){return e instanceof qt&&t.op===e.op&&t.field.isEqual(e.field)&&Dt(t.value,e.value)}(t,e):t instanceof zt?function(t,e){return e instanceof zt&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce(((t,n,i)=>t&&$t(n,e.filters[i])),!0)}(t,e):void m()}class Ht extends qt{constructor(t,e,n){super(t,e,n),this.key=W.fromName(n.referenceValue)}matches(t){const e=W.comparator(t.key,this.key);return this.matchesComparison(e)}}class Gt extends qt{constructor(t,e){super(t,"in",e),this.keys=Wt("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class Kt extends qt{constructor(t,e){super(t,"not-in",e),this.keys=Wt("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function Wt(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>W.fromName(t.referenceValue)))}class Qt extends qt{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Lt(e)&&xt(e.arrayValue,this.value)}}class Xt extends qt{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&xt(this.value.arrayValue,e)}}class Yt extends qt{constructor(t,e){super(t,"not-in",e)}matches(t){if(xt(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!xt(this.value.arrayValue,e)}}class Jt extends qt{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Lt(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>xt(this.value.arrayValue,t)))}}class Zt{constructor(t,e="asc"){this.field=t,this.dir=e}}function te(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class ee{constructor(t){this.timestamp=t}static fromTimestamp(t){return new ee(t)}static min(){return new ee(new Tt(0,0))}static max(){return new ee(new Tt(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class ne{constructor(t,e){this.comparator=t,this.root=e||re.EMPTY}insert(t,e){return new ne(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,re.BLACK,null,null))}remove(t){return new ne(this.comparator,this.root.remove(t,this.comparator).copy(null,null,re.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new ie(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new ie(this.root,t,this.comparator,!1)}getReverseIterator(){return new ie(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new ie(this.root,t,this.comparator,!0)}}class ie{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=e?n(t.key,e):1,e&&i&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(0===r){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class re{constructor(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:re.RED,this.left=null!=i?i:re.EMPTY,this.right=null!=r?r:re.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,r){return new re(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const r=n(t,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return re.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return re.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,re.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,re.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw m();if(this.right.isRed())throw m();const t=this.left.check();if(t!==this.right.check())throw m();return t+(this.isRed()?0:1)}}re.EMPTY=null,re.RED=!0,re.BLACK=!1,re.EMPTY=new class{constructor(){this.size=0}get key(){throw m()}get value(){throw m()}get color(){throw m()}get left(){throw m()}get right(){throw m()}copy(t,e,n,i,r){return this}insert(t,e,n){return new re(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class se{constructor(t){this.comparator=t,this.data=new ne(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new oe(this.data.getIterator())}getIteratorFrom(t){return new oe(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof se))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(t,i))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new se(this.comparator);return e.data=t,e}}class oe{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class ae{constructor(t){this.fields=t,t.sort(K.comparator)}static empty(){return new ae([])}unionWith(t){let e=new se(K.comparator);for(const t of this.fields)e=e.add(t);for(const n of t)e=e.add(n);return new ae(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return pt(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class ue{constructor(t){this.value=t}static empty(){return new ue({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!Vt(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Ft(e)}setAll(t){let e=K.emptyPath(),n={},i=[];t.forEach(((t,r)=>{if(!e.isImmediateParentOf(r)){const t=this.getFieldsMap(e);this.applyChanges(t,n,i),n={},i=[],e=r.popLast()}t?n[r.lastSegment()]=Ft(t):i.push(r.lastSegment())}));const r=this.getFieldsMap(e);this.applyChanges(r,n,i)}delete(t){const e=this.field(t.popLast());Vt(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Dt(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];Vt(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){gt(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new ue(Ft(this.value))}}class le{constructor(t,e,n,i,r,s,o){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.createTime=r,this.data=s,this.documentState=o}static newInvalidDocument(t){return new le(t,0,ee.min(),ee.min(),ee.min(),ue.empty(),0)}static newFoundDocument(t,e,n,i){return new le(t,1,e,ee.min(),n,i,0)}static newNoDocument(t,e){return new le(t,2,e,ee.min(),ee.min(),ue.empty(),0)}static newUnknownDocument(t,e){return new le(t,3,e,ee.min(),ee.min(),ue.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(ee.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=ue.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=ue.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ee.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof le&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new le(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class ce{constructor(t,e=null,n=[],i=[],r=null,s=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=s,this.endAt=o,this.C=null}}function he(t,e=null,n=[],i=[],r=null,s=null,o=null){return new ce(t,e,n,i,r,s,o)}class de{constructor(t,e=null,n=[],i=[],r=null,s="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=s,this.startAt=o,this.endAt=a,this.S=null,this.N=null,this.O=null,this.startAt,this.endAt}}function fe(t){return null!==t.collectionGroup}function pe(t){const e=y(t);if(null===e.S){e.S=[];const t=new Set;for(const n of e.explicitOrderBy)e.S.push(n),t.add(n.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc",i=function(t){let e=new se(K.comparator);return t.filters.forEach((t=>{t.getFlattenedFilters().forEach((t=>{t.isInequality()&&(e=e.add(t.field))}))})),e}(e);i.forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.S.push(new Zt(i,n))})),t.has(K.keyField().canonicalString())||e.S.push(new Zt(K.keyField(),n))}return e.S}function me(t){const e=y(t);return e.N||(e.N=ge(e,pe(t))),e.N}function ge(t,e){if("F"===t.limitType)return he(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((t=>{const e="desc"===t.dir?"asc":"desc";return new Zt(t.field,e)}));const n=t.endAt?new Ut(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new Ut(t.startAt.position,t.startAt.inclusive):null;return he(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}}function ye(t,e){const n=t.filters.concat([e]);return new de(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function ve(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!rt(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?function(t){return{integerValue:""+t}}(e):function(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:rt(e)?"-0":e}}(t,e)}class we{constructor(){this._=void 0}}class _e extends we{}class be extends we{constructor(t){super(),this.elements=t}}class Ee extends we{constructor(t){super(),this.elements=t}}class Te extends we{constructor(t,e){super(),this.serializer=t,this.q=e}}class Se{constructor(t,e){this.field=t,this.transform=e}}class Ce{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Ce}static exists(t){return new Ce(void 0,t)}static updateTime(t){return new Ce(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}class Ie{}class Ae extends Ie{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ke extends Ie{constructor(t,e,n,i,r=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}class De extends Ie{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class xe extends Ie{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}const Re={asc:"ASCENDING",desc:"DESCENDING"},Ne={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Pe={and:"AND",or:"OR"};class Le{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function Oe(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Me(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Ve(t,e){return Oe(t,e.toTimestamp())}function Fe(t){return g(!!t),ee.fromTimestamp(function(t){const e=_t(t);return new Tt(e.seconds,e.nanos)}(t))}function Ue(t,e){return function(t){return new H(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Be(t,e){return Ue(t.databaseId,e.path)}function je(t,e){const n=function(t){const e=H.fromString(t);return g(Je(e)),e}(e);if(n.get(1)!==t.databaseId.projectId)throw new N(_,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new N(_,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new W(function(t){return g(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}(n))}function qe(t,e){return Ue(t.databaseId,e)}function ze(t){return new H(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function $e(t,e,n){return{name:Be(t,e),fields:n.value.mapValue.fields}}function He(t,e){const n={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(n.parent=qe(t,i),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=qe(t,i.popLast()),n.structuredQuery.from=[{collectionId:i.lastSegment()}]);const r=function(t){if(0!==t.length)return Xe(zt.create(t,"and"))}(e.filters);r&&(n.structuredQuery.where=r);const s=function(t){if(0!==t.length)return t.map((t=>function(t){return{field:Qe(t.field),direction:Ge(t.dir)}}(t)))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const o=function(t,e){return t.useProto3Json||it(e)?e:{value:e}}(t,e.limit);return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt=function(t){return{before:t.inclusive,values:t.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(t){return{before:!t.inclusive,values:t.position}}(e.endAt)),n}function Ge(t){return Re[t]}function Ke(t){return Ne[t]}function We(t){return Pe[t]}function Qe(t){return{fieldPath:t.canonicalString()}}function Xe(t){return t instanceof qt?function(t){if("=="===t.op){if(Mt(t.value))return{unaryFilter:{field:Qe(t.field),op:"IS_NAN"}};if(Ot(t.value))return{unaryFilter:{field:Qe(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Mt(t.value))return{unaryFilter:{field:Qe(t.field),op:"IS_NOT_NAN"}};if(Ot(t.value))return{unaryFilter:{field:Qe(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Qe(t.field),op:Ke(t.op),value:t.value}}}(t):t instanceof zt?function(t){const e=t.getFilters().map((t=>Xe(t)));return 1===e.length?e[0]:{compositeFilter:{op:We(t.op),filters:e}}}(t):m()}function Ye(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Je(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function Ze(t){return new Le(t,!0)}class tn{constructor(t,e,n=1e3,i=1.5,r=6e4){this.B=t,this.timerId=e,this.$=n,this.L=i,this.M=r,this.k=0,this.U=null,this.j=Date.now(),this.reset()}reset(){this.k=0}W(){this.k=this.M}K(t){this.cancel();const e=Math.floor(this.k+this.G()),n=Math.max(0,Date.now()-this.j),i=Math.max(0,e-n);i>0&&h("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.k} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.U=this.B.enqueueAfterDelay(this.timerId,i,(()=>(this.j=Date.now(),t()))),this.k*=this.L,this.k<this.$&&(this.k=this.$),this.k>this.M&&(this.k=this.M)}H(){null!==this.U&&(this.U.skipDelay(),this.U=null)}cancel(){null!==this.U&&(this.U.cancel(),this.U=null)}G(){return(Math.random()-.5)*this.k}}class en extends class{}{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=i,this.J=!1}Y(){if(this.J)throw new N(I,"The client has already been terminated.")}R(t,e,n){return this.Y(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,r])=>this.connection.R(t,e,n,i,r))).catch((t=>{throw"FirebaseError"===t.name?(t.code===S&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new N(w,t.toString())}))}g(t,e,n,i){return this.Y(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,s])=>this.connection.g(t,e,n,r,s,i))).catch((t=>{throw"FirebaseError"===t.name?(t.code===S&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new N(w,t.toString())}))}terminate(){this.J=!0}}async function nn(t,e){const n=y(t),i=ze(n.serializer)+"/documents",r={writes:e.map((t=>function(t,e){let n;if(e instanceof Ae)n={update:$e(t,e.key,e.value)};else if(e instanceof De)n={delete:Be(t,e.key)};else if(e instanceof ke)n={update:$e(t,e.key,e.data),updateMask:Ye(e.fieldMask)};else{if(!(e instanceof xe))return m();n={verify:Be(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof _e)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof be)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Ee)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Te)return{fieldPath:e.field.canonicalString(),increment:n.q};throw m()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Ve(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:m()}(t,e.precondition)),n}(n.serializer,t)))};await n.R("Commit",i,r)}async function rn(t,e){const n=y(t),i=ze(n.serializer)+"/documents",r={documents:e.map((t=>Be(n.serializer,t)))},s=await n.g("BatchGetDocuments",i,r,e.length),o=new Map;s.forEach((t=>{const e=function(t,e){return"found"in e?function(t,e){g(!!e.found),e.found.name,e.found.updateTime;const n=je(t,e.found.name),i=Fe(e.found.updateTime),r=e.found.createTime?Fe(e.found.createTime):ee.min(),s=new ue({mapValue:{fields:e.found.fields}});return le.newFoundDocument(n,i,r,s)}(t,e):"missing"in e?function(t,e){g(!!e.missing),g(!!e.readTime);const n=je(t,e.missing),i=Fe(e.readTime);return le.newNoDocument(n,i)}(t,e):m()}(n.serializer,t);o.set(e.key.toString(),e)}));const a=[];return e.forEach((t=>{const e=o.get(t.toString());g(!!e),a.push(e)})),a}const sn=new Map;function on(t){if(t._terminated)throw new N(I,"The client has already been terminated.");if(!sn.has(t)){h("ComponentProvider","Initializing Datastore");const e=function(t){return new lt(t,fetch.bind(null))}(function(t,e,n,i){return new q(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,et(i.experimentalLongPollingOptions),i.useFetchStreams)}(t._databaseId,t.app.options.appId||"",t._persistenceKey,t._freezeSettings())),n=Ze(t._databaseId),i=function(t,e,n,i){return new en(t,e,n,i)}(t._authCredentials,t._appCheckCredentials,e,n);sn.set(t,i)}return sn.get(t)}class an{constructor(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new N(_,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new N(_,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}!function(t,e,n,i){if(!0===e&&!0===i)throw new N(_,`${t} and ${n} cannot be used together.`)}("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=et(null!==(n=t.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(t){if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new N(_,`invalid long polling timeout: ${t.timeoutSeconds} (must not be NaN)`);if(t.timeoutSeconds<5)throw new N(_,`invalid long polling timeout: ${t.timeoutSeconds} (minimum allowed value is 5)`);if(t.timeoutSeconds>30)throw new N(_,`invalid long polling timeout: ${t.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(t,e){return t.timeoutSeconds===e.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class un{constructor(t,e,n,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new an({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new N(I,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new N(I,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new an(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new O;switch(t.type){case"firstParty":return new U(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new N(_,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=sn.get(t);e&&(h("ComponentProvider","Removing Datastore"),sn.delete(t),e.terminate())}(this),Promise.resolve()}}function ln(t,e,n){n||(n="(default)");const r=(0,i.qX)(t,"firestore/lite");if(r.isInitialized(n))throw new N(I,"Firestore can only be initialized once per app.");return r.initialize({options:e,instanceIdentifier:n})}function cn(t,e){const n="object"==typeof t?t:(0,i.Mq)(),r="string"==typeof t?t:e||"(default)",s=(0,i.qX)(n,"firestore/lite").getImmediate({identifier:r});if(!s._initialized){const t=(0,o.P0)("firestore");t&&hn(s,...t)}return s}function hn(t,e,n,i={}){var r;const s=(t=Z(t,un))._getSettings(),u=`${e}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==u&&f("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:u,ssl:!1})),i.mockUserToken){let e,n;if("string"==typeof i.mockUserToken)e=i.mockUserToken,n=a.MOCK_USER;else{e=(0,o.Sg)(i.mockUserToken,null===(r=t._app)||void 0===r?void 0:r.options.projectId);const s=i.mockUserToken.sub||i.mockUserToken.user_id;if(!s)throw new N(_,"mockUserToken must contain 'sub' or 'user_id' field!");n=new a(s)}t._authCredentials=new M(new L(e,n))}}function dn(t){return t=Z(t,un),(0,i.wN)(t.app,"firestore/lite"),t._delete()}class fn{constructor(t="count",e){this._internalFieldPath=e,this.type="AggregateField",this.aggregateType=t}}class pn{constructor(t,e,n){this._userDataWriter=e,this._data=n,this.type="AggregateQuerySnapshot",this.query=t}data(){return this._userDataWriter.convertObjectMap(this._data)}}class mn{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new mn(this.firestore,t,this._query)}}class gn{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new yn(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new gn(this.firestore,t,this._key)}}class yn extends mn{constructor(t,e,n){super(t,e,function(t){return new de(t)}(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new gn(this.firestore,null,new W(t))}withConverter(t){return new yn(this.firestore,t,this._path)}}function vn(t,e,...n){if(t=(0,o.m9)(t),Q("collection","path",e),t instanceof un){const i=H.fromString(e,...n);return Y(i),new yn(t,null,i)}{if(!(t instanceof gn||t instanceof yn))throw new N(_,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(H.fromString(e,...n));return Y(i),new yn(t.firestore,null,i)}}function wn(t,e){if(t=Z(t,un),Q("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new N(_,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new mn(t,null,function(t){return new de(H.emptyPath(),t)}(e))}function _n(t,e,...n){if(t=(0,o.m9)(t),1===arguments.length&&(e=dt.newId()),Q("doc","path",e),t instanceof un){const i=H.fromString(e,...n);return X(i),new gn(t,null,new W(i))}{if(!(t instanceof gn||t instanceof yn))throw new N(_,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(H.fromString(e,...n));return X(i),new gn(t.firestore,t instanceof yn?t.converter:null,new W(i))}}function bn(t,e){return t=(0,o.m9)(t),e=(0,o.m9)(e),(t instanceof gn||t instanceof yn)&&(e instanceof gn||e instanceof yn)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function En(t,e){return t=(0,o.m9)(t),e=(0,o.m9)(e),t instanceof mn&&e instanceof mn&&t.firestore===e.firestore&&function(t,e){return function(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!te(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!$t(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Bt(t.startAt,e.startAt)&&Bt(t.endAt,e.endAt)}(me(t),me(e))&&t.limitType===e.limitType}(t._query,e._query)&&t.converter===e.converter}class Tn{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Tn(vt.fromBase64String(t))}catch(t){throw new N(_,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new Tn(vt.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Sn{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new N(_,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new K(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}function Cn(){return new Sn("__name__")}class In{constructor(t){this._methodName=t}}class An{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new N(_,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new N(_,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return ft(this._lat,t._lat)||ft(this._long,t._long)}}const kn=/^__.*__$/;class Dn{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new ke(t,this.data,this.fieldMask,e,this.fieldTransforms):new Ae(t,this.data,e,this.fieldTransforms)}}class xn{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return new ke(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function Rn(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw m()}}class Nn{constructor(t,e,n,i,r,s){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.X(),this.fieldTransforms=r||[],this.fieldMask=s||[]}get path(){return this.settings.path}get tt(){return this.settings.tt}et(t){return new Nn(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}rt(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.et({path:n,nt:!1});return i.it(t),i}st(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.et({path:n,nt:!1});return i.X(),i}ot(t){return this.et({path:void 0,nt:!0})}ut(t){return Jn(t,this.settings.methodName,this.settings._t||!1,this.path,this.settings.ct)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}X(){if(this.path)for(let t=0;t<this.path.length;t++)this.it(this.path.get(t))}it(t){if(0===t.length)throw this.ut("Document fields must not be empty");if(Rn(this.tt)&&kn.test(t))throw this.ut('Document fields cannot begin and end with "__"')}}class Pn{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||Ze(t)}lt(t,e,n,i=!1){return new Nn({tt:t,methodName:e,ct:n,path:K.emptyPath(),nt:!1,_t:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ln(t){const e=t._freezeSettings(),n=Ze(t._databaseId);return new Pn(t._databaseId,!!e.ignoreUndefinedProperties,n)}function On(t,e,n,i,r,s={}){const o=t.lt(s.merge||s.mergeFields?2:0,e,n,r);Wn("Data must be an object, but it was:",o,i);const a=Gn(i,o);let u,l;if(s.merge)u=new ae(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){const t=[];for(const i of s.mergeFields){const r=Qn(e,i,n);if(!o.contains(r))throw new N(_,`Field '${r}' is specified in your field mask but missing from your input data.`);Zn(t,r)||t.push(r)}u=new ae(t),l=o.fieldTransforms.filter((t=>u.covers(t.field)))}else u=null,l=o.fieldTransforms;return new Dn(new ue(a),u,l)}class Mn extends In{_toFieldTransform(t){if(2!==t.tt)throw 1===t.tt?t.ut(`${this._methodName}() can only appear at the top level of your update data`):t.ut(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Mn}}function Vn(t,e,n){return new Nn({tt:3,ct:e.settings.ct,methodName:t._methodName,nt:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Fn extends In{_toFieldTransform(t){return new Se(t.path,new _e)}isEqual(t){return t instanceof Fn}}class Un extends In{constructor(t,e){super(t),this.ht=e}_toFieldTransform(t){const e=Vn(this,t,!0),n=this.ht.map((t=>Hn(t,e))),i=new be(n);return new Se(t.path,i)}isEqual(t){return this===t}}class Bn extends In{constructor(t,e){super(t),this.ht=e}_toFieldTransform(t){const e=Vn(this,t,!0),n=this.ht.map((t=>Hn(t,e))),i=new Ee(n);return new Se(t.path,i)}isEqual(t){return this===t}}class jn extends In{constructor(t,e){super(t),this.dt=e}_toFieldTransform(t){const e=new Te(t.serializer,ve(t.serializer,this.dt));return new Se(t.path,e)}isEqual(t){return this===t}}function qn(t,e,n,i){const r=t.lt(1,e,n);Wn("Data must be an object, but it was:",r,i);const s=[],a=ue.empty();gt(i,((t,i)=>{const u=Yn(e,t,n);i=(0,o.m9)(i);const l=r.st(u);if(i instanceof Mn)s.push(u);else{const t=Hn(i,l);null!=t&&(s.push(u),a.set(u,t))}}));const u=new ae(s);return new xn(a,u,r.fieldTransforms)}function zn(t,e,n,i,r,s){const a=t.lt(1,e,n),u=[Qn(e,i,n)],l=[r];if(s.length%2!=0)throw new N(_,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let t=0;t<s.length;t+=2)u.push(Qn(e,s[t])),l.push(s[t+1]);const c=[],h=ue.empty();for(let t=u.length-1;t>=0;--t)if(!Zn(c,u[t])){const e=u[t];let n=l[t];n=(0,o.m9)(n);const i=a.st(e);if(n instanceof Mn)c.push(e);else{const t=Hn(n,i);null!=t&&(c.push(e),h.set(e,t))}}const d=new ae(c);return new xn(h,d,a.fieldTransforms)}function $n(t,e,n,i=!1){return Hn(n,t.lt(i?4:3,e))}function Hn(t,e){if(Kn(t=(0,o.m9)(t)))return Wn("Unsupported field value:",e,t),Gn(t,e);if(t instanceof In)return function(t,e){if(!Rn(e.tt))throw e.ut(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.ut(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.nt&&4!==e.tt)throw e.ut("Nested arrays are not supported");return function(t,e){const n=[];let i=0;for(const r of t){let t=Hn(r,e.ot(i));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),i++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=(0,o.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ve(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=Tt.fromDate(t);return{timestampValue:Oe(e.serializer,n)}}if(t instanceof Tt){const n=new Tt(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Oe(e.serializer,n)}}if(t instanceof An)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Tn)return{bytesValue:Me(e.serializer,t._byteString)};if(t instanceof gn){const n=e.databaseId,i=t.firestore._databaseId;if(!i.isEqual(n))throw e.ut(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Ue(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.ut(`Unsupported field value: ${J(t)}`)}(t,e)}function Gn(t,e){const n={};return function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):gt(t,((t,i)=>{const r=Hn(i,e.rt(t));null!=r&&(n[t]=r)})),{mapValue:{fields:n}}}function Kn(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Tt||t instanceof An||t instanceof Tn||t instanceof gn||t instanceof In)}function Wn(t,e,n){if(!Kn(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const i=J(n);throw"an object"===i?e.ut(t+" a custom object"):e.ut(t+" "+i)}}function Qn(t,e,n){if((e=(0,o.m9)(e))instanceof Sn)return e._internalPath;if("string"==typeof e)return Yn(t,e);throw Jn("Field path arguments must be of type string or ",t,!1,void 0,n)}const Xn=new RegExp("[~\\*/\\[\\]]");function Yn(t,e,n){if(e.search(Xn)>=0)throw Jn(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Sn(...e.split("."))._internalPath}catch(i){throw Jn(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Jn(t,e,n,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${i}`),o&&(u+=` in document ${r}`),u+=")"),new N(_,a+t+u)}function Zn(t,e){return t.some((t=>t.isEqual(e)))}class ti{constructor(t,e,n,i,r){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new gn(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new ei(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(ri("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class ei extends ti{data(){return super.data()}}class ni{constructor(t,e){this._docs=e,this.query=t}get docs(){return[...this._docs]}get size(){return this.docs.length}get empty(){return 0===this.docs.length}forEach(t,e){this._docs.forEach(t,e)}}function ii(t,e){return t=(0,o.m9)(t),e=(0,o.m9)(e),t instanceof ti&&e instanceof ti?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof ni&&e instanceof ni&&En(t.query,e.query)&&pt(t.docs,e.docs,ii)}function ri(t,e){return"string"==typeof e?Yn(t,e):e instanceof Sn?e._internalPath:e._delegate._internalPath}class si{}class oi extends si{}function ai(t,e,...n){let i=[];e instanceof si&&i.push(e),i=i.concat(n),function(t){const e=t.filter((t=>t instanceof ci)).length,n=t.filter((t=>t instanceof ui)).length;if(e>1||e>0&&n>0)throw new N(_,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const e of i)t=e._apply(t);return t}class ui extends oi{constructor(t,e,n){super(),this._field=t,this._op=e,this._value=n,this.type="where"}static _create(t,e,n){return new ui(t,e,n)}_apply(t){const e=this._parse(t);return Ai(t._query,e),new mn(t.firestore,t.converter,ye(t._query,e))}_parse(t){const e=Ln(t.firestore),n=function(t,e,n,i,r,s,o){let a;if(r.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new N(_,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){Ii(o,s);const e=[];for(const n of o)e.push(Ci(i,t,n));a={arrayValue:{values:e}}}else a=Ci(i,t,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Ii(o,s),a=$n(n,e,o,"in"===s||"not-in"===s);return qt.create(r,s,a)}(t._query,"where",e,t.firestore._databaseId,this._field,this._op,this._value);return n}}function li(t,e,n){const i=e,r=ri("where",t);return ui._create(r,i,n)}class ci extends si{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new ci(t,e)}_parse(t){const e=this._queryConstraints.map((e=>e._parse(t))).filter((t=>t.getFilters().length>0));return 1===e.length?e[0]:zt.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return 0===e.getFilters().length?t:(function(t,e){let n=t;const i=e.getFlattenedFilters();for(const t of i)Ai(n,t),n=ye(n,t)}(t._query,e),new mn(t.firestore,t.converter,ye(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}function hi(...t){return t.forEach((t=>ki("or",t))),ci._create("or",t)}function di(...t){return t.forEach((t=>ki("and",t))),ci._create("and",t)}class fi extends oi{constructor(t,e){super(),this._field=t,this._direction=e,this.type="orderBy"}static _create(t,e){return new fi(t,e)}_apply(t){const e=function(t,e,n){if(null!==t.startAt)throw new N(_,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new N(_,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Zt(e,n)}(t._query,this._field,this._direction);return new mn(t.firestore,t.converter,function(t,e){const n=t.explicitOrderBy.concat([e]);return new de(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))}}function pi(t,e="asc"){const n=e,i=ri("orderBy",t);return fi._create(i,n)}class mi extends oi{constructor(t,e,n){super(),this.type=t,this._limit=e,this._limitType=n}static _create(t,e,n){return new mi(t,e,n)}_apply(t){return new mn(t.firestore,t.converter,function(t,e,n){return new de(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}(t._query,this._limit,this._limitType))}}function gi(t){return tt("limit",t),mi._create("limit",t,"F")}function yi(t){return tt("limitToLast",t),mi._create("limitToLast",t,"L")}class vi extends oi{constructor(t,e,n){super(),this.type=t,this._docOrFields=e,this._inclusive=n}static _create(t,e,n){return new vi(t,e,n)}_apply(t){const e=Si(t,this.type,this._docOrFields,this._inclusive);return new mn(t.firestore,t.converter,function(t,e){return new de(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))}}function wi(...t){return vi._create("startAt",t,!0)}function _i(...t){return vi._create("startAfter",t,!1)}class bi extends oi{constructor(t,e,n){super(),this.type=t,this._docOrFields=e,this._inclusive=n}static _create(t,e,n){return new bi(t,e,n)}_apply(t){const e=Si(t,this.type,this._docOrFields,this._inclusive);return new mn(t.firestore,t.converter,function(t,e){return new de(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))}}function Ei(...t){return bi._create("endBefore",t,!1)}function Ti(...t){return bi._create("endAt",t,!0)}function Si(t,e,n,i){if(n[0]=(0,o.m9)(n[0]),n[0]instanceof ti)return function(t,e,n,i,r){if(!i)throw new N(E,`Can't use a DocumentSnapshot that doesn't exist for ${n}().`);const s=[];for(const n of pe(t))if(n.field.isKeyField())s.push(Pt(e,i.key));else{const t=i.data.field(n.field);if(St(t))throw new N(_,'Invalid query. You are trying to start or end a query using a document for which the field "'+n.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===t){const t=n.field.canonicalString();throw new N(_,`Invalid query. You are trying to start or end a query using a document for which the field '${t}' (used as the orderBy) does not exist.`)}s.push(t)}return new Ut(s,r)}(t._query,t.firestore._databaseId,e,n[0]._document,i);{const r=Ln(t.firestore);return function(t,e,n,i,r,s){const o=t.explicitOrderBy;if(r.length>o.length)throw new N(_,`Too many arguments provided to ${i}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const a=[];for(let s=0;s<r.length;s++){const u=r[s];if(o[s].field.isKeyField()){if("string"!=typeof u)throw new N(_,`Invalid query. Expected a string for document ID in ${i}(), but got a ${typeof u}`);if(!fe(t)&&-1!==u.indexOf("/"))throw new N(_,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${i}() must be a plain document ID, but '${u}' contains a slash.`);const n=t.path.child(H.fromString(u));if(!W.isDocumentKey(n))throw new N(_,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${i}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const r=new W(n);a.push(Pt(e,r))}else{const t=$n(n,i,u);a.push(t)}}return new Ut(a,s)}(t._query,t.firestore._databaseId,r,e,n,i)}}function Ci(t,e,n){if("string"==typeof(n=(0,o.m9)(n))){if(""===n)throw new N(_,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!fe(e)&&-1!==n.indexOf("/"))throw new N(_,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=e.path.child(H.fromString(n));if(!W.isDocumentKey(i))throw new N(_,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Pt(t,new W(i))}if(n instanceof gn)return Pt(t,n._key);throw new N(_,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${J(n)}.`)}function Ii(t,e){if(!Array.isArray(t)||0===t.length)throw new N(_,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Ai(t,e){const n=function(t,e){for(const n of t)for(const t of n.getFlattenedFilters())if(e.indexOf(t.op)>=0)return t.op;return null}(t.filters,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==n)throw n===e.op?new N(_,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new N(_,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function ki(t,e){if(!(e instanceof ui||e instanceof ci))throw new N(_,`Function ${t}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}function Di(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}class xi extends class{convertValue(t,e="none"){switch(kt(t)){case 0:return null;case 1:return t.booleanValue;case 2:return bt(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Et(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw m()}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const n={};return gt(t,((t,i)=>{n[t]=this.convertValue(i,e)})),n}convertGeoPoint(t){return new An(bt(t.latitude),bt(t.longitude))}convertArray(t,e){return(t.values||[]).map((t=>this.convertValue(t,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=Ct(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(It(t));default:return null}}convertTimestamp(t){const e=_t(t);return new Tt(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=H.fromString(t);g(Je(n));const i=new z(n.get(1),n.get(3)),r=new W(n.popFirst(5));return i.isEqual(e)||d(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),r}}{constructor(t){super(),this.firestore=t}convertBytes(t){return new Tn(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new gn(this.firestore,null,e)}}function Ri(t){const e=on((t=Z(t,gn)).firestore),n=new xi(t.firestore);return rn(e,[t._key]).then((e=>{g(1===e.length);const i=e[0];return new ti(t.firestore,n,t._key,i.isFoundDocument()?i:null,t.converter)}))}function Ni(t){!function(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new N(D,"limitToLast() queries require specifying at least one orderBy() clause")}((t=Z(t,mn))._query);const e=on(t.firestore),n=new xi(t.firestore);return async function(t,e){const n=y(t),i=He(n.serializer,me(e));return(await n.g("RunQuery",i.parent,{structuredQuery:i.structuredQuery})).filter((t=>!!t.document)).map((t=>function(t,e,n){const i=je(t,e.name),r=Fe(e.updateTime),s=e.createTime?Fe(e.createTime):ee.min(),o=new ue({mapValue:{fields:e.fields}}),a=le.newFoundDocument(i,r,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}(n.serializer,t.document,void 0)))}(e,t._query).then((e=>{const i=e.map((e=>new ei(t.firestore,n,e.key,e,t.converter)));return"L"===t._query.limitType&&i.reverse(),new ni(t,i)}))}function Pi(t,e,n){const i=Di((t=Z(t,gn)).converter,e,n),r=On(Ln(t.firestore),"setDoc",t._key,i,null!==t.converter,n);return nn(on(t.firestore),[r.toMutation(t._key,Ce.none())])}function Li(t,e,n,...i){const r=Ln((t=Z(t,gn)).firestore);let s;return s="string"==typeof(e=(0,o.m9)(e))||e instanceof Sn?zn(r,"updateDoc",t._key,e,n,i):qn(r,"updateDoc",t._key,e),nn(on(t.firestore),[s.toMutation(t._key,Ce.exists(!0))])}function Oi(t){return nn(on((t=Z(t,gn)).firestore),[new De(t._key,Ce.none())])}function Mi(t,e){const n=_n(t=Z(t,yn)),i=Di(t.converter,e),r=On(Ln(t.firestore),"addDoc",n._key,i,null!==n.converter,{});return nn(on(t.firestore),[r.toMutation(n._key,Ce.exists(!1))]).then((()=>n))}function Vi(t){return Fi(t,{count:ji()})}function Fi(t,e){const n=Z(t.firestore,un),i=on(n),r=function(t,e){const n=[];for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.push(e(t[i],i,t));return n}(e,((t,e)=>new ct(e,t.aggregateType,t._internalFieldPath)));return async function(t,e,n){var i;const r=y(t),{request:s,Z:o}=function(t,e,n){const i=He(t,e),r={},s=[];let o=0;return n.forEach((t=>{const e="aggregate_"+o++;r[e]=t.alias,"count"===t.aggregateType?s.push({alias:e,count:{}}):"avg"===t.aggregateType?s.push({alias:e,avg:{field:Qe(t.fieldPath)}}):"sum"===t.aggregateType&&s.push({alias:e,sum:{field:Qe(t.fieldPath)}})})),{request:{structuredAggregationQuery:{aggregations:s,structuredQuery:i.structuredQuery},parent:i.parent},Z:r}}(r.serializer,function(t){const e=y(t);return e.O||(e.O=ge(e,t.explicitOrderBy)),e.O}(e),n),a=s.parent;r.connection.P||delete s.parent;const u=(await r.g("RunAggregationQuery",a,s,1)).filter((t=>!!t.result));g(1===u.length);const l=null===(i=u[0].result)||void 0===i?void 0:i.aggregateFields;return Object.keys(l).reduce(((t,e)=>(t[o[e]]=l[e],t)),{})}(i,t._query,r).then((e=>function(t,e,n){const i=new xi(t);return new pn(e,i,n)}(n,t,e)))}function Ui(t){return new fn("sum",Qn("sum",t))}function Bi(t){return new fn("avg",Qn("average",t))}function ji(){return new fn("count")}function qi(t,e){var n,i;return t instanceof fn&&e instanceof fn&&t.aggregateType===e.aggregateType&&(null===(n=t._internalFieldPath)||void 0===n?void 0:n.canonicalString())===(null===(i=e._internalFieldPath)||void 0===i?void 0:i.canonicalString())}function zi(t,e){return En(t.query,e.query)&&(0,o.vZ)(t.data(),e.data())}function $i(){return new Mn("deleteField")}function Hi(){return new Fn("serverTimestamp")}function Gi(...t){return new Un("arrayUnion",t)}function Ki(...t){return new Bn("arrayRemove",t)}function Wi(t){return new jn("increment",t)}class Qi{constructor(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=Ln(t)}set(t,e,n){this._verifyNotCommitted();const i=Xi(t,this._firestore),r=Di(i.converter,e,n),s=On(this._dataReader,"WriteBatch.set",i._key,r,null!==i.converter,n);return this._mutations.push(s.toMutation(i._key,Ce.none())),this}update(t,e,n,...i){this._verifyNotCommitted();const r=Xi(t,this._firestore);let s;return s="string"==typeof(e=(0,o.m9)(e))||e instanceof Sn?zn(this._dataReader,"WriteBatch.update",r._key,e,n,i):qn(this._dataReader,"WriteBatch.update",r._key,e),this._mutations.push(s.toMutation(r._key,Ce.exists(!0))),this}delete(t){this._verifyNotCommitted();const e=Xi(t,this._firestore);return this._mutations=this._mutations.concat(new De(e._key,Ce.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new N(I,"A write batch can no longer be used after commit() has been called.")}}function Xi(t,e){if((t=(0,o.m9)(t)).firestore!==e)throw new N(_,"Provided document reference is from a different Firestore instance.");return t}function Yi(t){const e=on(t=Z(t,un));return new Qi(t,(t=>nn(e,t)))}class Ji{constructor(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(t){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new N(_,"Firestore transactions require all reads to be executed before all writes.");const e=await rn(this.datastore,t);return e.forEach((t=>this.recordVersion(t))),e}set(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())}update(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())}delete(t){this.write(new De(t,this.precondition(t))),this.writtenDocs.add(t.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const t=this.readVersions;this.mutations.forEach((e=>{t.delete(e.key.toString())})),t.forEach(((t,e)=>{const n=W.fromPath(e);this.mutations.push(new xe(n,this.precondition(n)))})),await nn(this.datastore,this.mutations),this.committed=!0}recordVersion(t){let e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw m();e=ee.min()}const n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new N(A,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)}precondition(t){const e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?e.isEqual(ee.min())?Ce.exists(!1):Ce.updateTime(e):Ce.none()}preconditionForUpdate(t){const e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(ee.min()))throw new N(_,"Can't update a document that doesn't exist.");return Ce.updateTime(e)}return Ce.exists(!0)}write(t){this.ensureCommitNotCalled(),this.mutations.push(t)}ensureCommitNotCalled(){}}const Zi={maxAttempts:5};class tr{constructor(t,e,n,i,r){this.asyncQueue=t,this.datastore=e,this.options=n,this.updateFunction=i,this.deferred=r,this.ft=n.maxAttempts,this.Et=new tn(this.asyncQueue,"transaction_retry")}run(){this.ft-=1,this.At()}At(){this.Et.K((async()=>{const t=new Ji(this.datastore),e=this.Tt(t);e&&e.then((e=>{this.asyncQueue.enqueueAndForget((()=>t.commit().then((()=>{this.deferred.resolve(e)})).catch((t=>{this.Pt(t)}))))})).catch((t=>{this.Pt(t)}))}))}Tt(t){try{const e=this.updateFunction(t);return!it(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Pt(t){this.ft>0&&this.Rt(t)?(this.ft-=1,this.asyncQueue.enqueueAndForget((()=>(this.At(),Promise.resolve())))):this.deferred.reject(t)}Rt(t){if("FirebaseError"===t.name){const e=t.code;return"aborted"===e||"failed-precondition"===e||"already-exists"===e||!function(t){switch(t){default:return m();case v:case w:case b:case C:case x:case R:case S:return!1;case _:case E:case"already-exists":case T:case I:case A:case k:case D:case"data-loss":return!0}}(e)}return!1}}function er(){return"undefined"!=typeof document?document:null}class nr{constructor(t,e,n,i,r){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new P,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,i,r){const s=Date.now()+n,o=new nr(t,e,s,i,r);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new N(v,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}class ir{constructor(){this.It=Promise.resolve(),this.Vt=[],this.yt=!1,this.wt=[],this.gt=null,this.Ft=!1,this.vt=!1,this.Dt=[],this.Et=new tn(this,"async_queue_retry"),this.bt=()=>{const t=er();t&&h("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Et.H()};const t=er();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.bt)}get isShuttingDown(){return this.yt}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.Ct(),this.St(t)}enterRestrictedMode(t){if(!this.yt){this.yt=!0,this.vt=t||!1;const e=er();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.bt)}}enqueue(t){if(this.Ct(),this.yt)return new Promise((()=>{}));const e=new P;return this.St((()=>this.yt&&this.vt?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Vt.push(t),this.Nt())))}async Nt(){if(0!==this.Vt.length){try{await this.Vt[0](),this.Vt.shift(),this.Et.reset()}catch(t){if(!function(t){return"IndexedDbTransactionError"===t.name}(t))throw t;h("AsyncQueue","Operation failed with retryable error: "+t)}this.Vt.length>0&&this.Et.K((()=>this.Nt()))}}St(t){const e=this.It.then((()=>(this.Ft=!0,t().catch((t=>{this.gt=t,this.Ft=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw d("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this.Ft=!1,t))))));return this.It=e,e}enqueueAfterDelay(t,e,n){this.Ct(),this.Dt.indexOf(t)>-1&&(e=0);const i=nr.createAndSchedule(this,t,e,n,(t=>this.Ot(t)));return this.wt.push(i),i}Ct(){this.gt&&m()}verifyOperationInProgress(){}async qt(){let t;do{t=this.It,await t}while(t!==this.It)}Bt(t){for(const e of this.wt)if(e.timerId===t)return!0;return!1}Qt(t){return this.qt().then((()=>{this.wt.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.wt)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.qt()}))}$t(t){this.Dt.push(t)}Ot(t){const e=this.wt.indexOf(t);this.wt.splice(e,1)}}class rr{constructor(t,e){this._firestore=t,this._transaction=e,this._dataReader=Ln(t)}get(t){const e=Xi(t,this._firestore),n=new xi(this._firestore);return this._transaction.lookup([e._key]).then((t=>{if(!t||1!==t.length)return m();const i=t[0];if(i.isFoundDocument())return new ti(this._firestore,n,i.key,i,e.converter);if(i.isNoDocument())return new ti(this._firestore,n,e._key,null,e.converter);throw m()}))}set(t,e,n){const i=Xi(t,this._firestore),r=Di(i.converter,e,n),s=On(this._dataReader,"Transaction.set",i._key,r,null!==i.converter,n);return this._transaction.set(i._key,s),this}update(t,e,n,...i){const r=Xi(t,this._firestore);let s;return s="string"==typeof(e=(0,o.m9)(e))||e instanceof Sn?zn(this._dataReader,"Transaction.update",r._key,e,n,i):qn(this._dataReader,"Transaction.update",r._key,e),this._transaction.update(r._key,s),this}delete(t){const e=Xi(t,this._firestore);return this._transaction.delete(e._key),this}}function sr(t,e,n){const i=on(t=Z(t,un)),r=Object.assign(Object.assign({},Zi),n);!function(t){if(t.maxAttempts<1)throw new N(_,"Max attempts must be at least 1")}(r);const s=new P;return new tr(new ir,i,r,(n=>e(new rr(t,n))),s).run(),s.promise}var or;or=`${i.Jn}_lite`,u=or,(0,i.Xd)(new r.wA("firestore/lite",((t,{instanceIdentifier:e,options:n})=>{const i=t.getProvider("app").getImmediate(),r=new un(new V(t.getProvider("auth-internal")),new j(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new N(_,'"projectId" not provided in firebase.initializeApp.');return new z(t.options.projectId,e)}(i,e),i);return n&&r._setSettings(n),r}),"PUBLIC").setMultipleInstances(!0)),(0,i.KN)("firestore-lite","4.4.0",""),(0,i.KN)("firestore-lite","4.4.0","esm2017")},46271:(t,e,n)=>{n.d(e,{Jt:()=>Pt,cF:()=>Ot,iH:()=>Lt,B0:()=>Nt});var i=n(10389),r=n(74444),s=n(8463);const o="firebasestorage.googleapis.com",a="storageBucket";class u extends r.ZR{constructor(t,e,n=0){super(h(t),`Firebase Storage: ${e} (${h(t)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,u.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return h(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}var l,c;function h(t){return"storage/"+t}function d(){return new u(l.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function f(){return new u(l.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function p(){return new u(l.CANCELED,"User canceled the upload/download.")}function m(){return new u(l.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function g(t){return new u(l.INVALID_ARGUMENT,t)}function y(){return new u(l.APP_DELETED,"The Firebase app was deleted.")}function v(t,e){return new u(l.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function w(t){throw new u(l.INTERNAL_ERROR,"Internal error: "+t)}!function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(l||(l={}));class _{constructor(t,e){this.bucket=t,this.path_=e}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,e){let n;try{n=_.makeFromUrl(t,e)}catch(e){return new _(t,"")}if(""===n.path)return n;throw i=t,new u(l.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+i+"'.");var i}static makeFromUrl(t,e){let n=null;const i="([A-Za-z0-9.\\-_]+)";const r=new RegExp("^gs://"+i+"(/(.*))?$","i");function s(t){t.path_=decodeURIComponent(t.path)}const a=e.replace(/[.]/g,"\\."),c=[{regex:r,indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${a}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:s},{regex:new RegExp(`^https?://${e===o?"(?:storage.googleapis.com|storage.cloud.google.com)":e}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:s}];for(let e=0;e<c.length;e++){const i=c[e],r=i.regex.exec(t);if(r){const t=r[i.indices.bucket];let e=r[i.indices.path];e||(e=""),n=new _(t,e),i.postModify(n);break}}if(null==n)throw function(t){return new u(l.INVALID_URL,"Invalid URL '"+t+"'.")}(t);return n}}class b{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}function E(t){return"string"==typeof t||t instanceof String}function T(t){return S()&&t instanceof Blob}function S(){return"undefined"!=typeof Blob}function C(t,e,n,i){if(i<e)throw g(`Invalid value for '${t}'. Expected ${e} or greater.`);if(i>n)throw g(`Invalid value for '${t}'. Expected ${n} or less.`)}function I(t,e,n){let i=e;return null==n&&(i=`https://${e}`),`${n}://${i}/v0${t}`}function A(t){const e=encodeURIComponent;let n="?";for(const i in t)if(t.hasOwnProperty(i)){n=n+(e(i)+"="+e(t[i]))+"&"}return n=n.slice(0,-1),n}function k(t,e){const n=t>=500&&t<600,i=-1!==[408,429].indexOf(t),r=-1!==e.indexOf(t);return n||i||r}!function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"}(c||(c={}));class D{constructor(t,e,n,i,r,s,o,a,u,l,c,h=!0){this.url_=t,this.method_=e,this.headers_=n,this.body_=i,this.successCodes_=r,this.additionalRetryCodes_=s,this.callback_=o,this.errorCallback_=a,this.timeout_=u,this.progressCallback_=l,this.connectionFactory_=c,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise(((t,e)=>{this.resolve_=t,this.reject_=e,this.start_()}))}start_(){const t=(t,e)=>{if(e)return void t(!1,new x(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const i=t=>{const e=t.loaded,n=t.lengthComputable?t.total:-1;null!==this.progressCallback_&&this.progressCallback_(e,n)};null!==this.progressCallback_&&n.addUploadProgressListener(i),n.send(this.url_,this.method_,this.body_,this.headers_).then((()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(i),this.pendingConnection_=null;const e=n.getErrorCode()===c.NO_ERROR,r=n.getStatus();if(!e||k(r,this.additionalRetryCodes_)&&this.retry){const e=n.getErrorCode()===c.ABORT;return void t(!1,new x(!1,null,e))}const s=-1!==this.successCodes_.indexOf(r);t(!0,new x(s,n))}))},e=(t,e)=>{const n=this.resolve_,i=this.reject_,r=e.connection;if(e.wasSuccessCode)try{const t=this.callback_(r,r.getResponse());void 0!==t?n(t):n()}catch(t){i(t)}else if(null!==r){const t=d();t.serverResponse=r.getErrorText(),this.errorCallback_?i(this.errorCallback_(r,t)):i(t)}else if(e.canceled){i(this.appDelete_?y():p())}else{i(f())}};this.canceled_?e(0,new x(!1,null,!0)):this.backoffId_=function(t,e,n){let i=1,r=null,s=null,o=!1,a=0;function u(){return 2===a}let l=!1;function c(...t){l||(l=!0,e.apply(null,t))}function h(e){r=setTimeout((()=>{r=null,t(f,u())}),e)}function d(){s&&clearTimeout(s)}function f(t,...e){if(l)return void d();if(t)return d(),void c.call(null,t,...e);if(u()||o)return d(),void c.call(null,t,...e);let n;i<64&&(i*=2),1===a?(a=2,n=0):n=1e3*(i+Math.random()),h(n)}let p=!1;function m(t){p||(p=!0,d(),l||(null!==r?(t||(a=2),clearTimeout(r),h(0)):t||(a=1)))}return h(0),s=setTimeout((()=>{o=!0,m(!0)}),n),m}(t,e,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class x{constructor(t,e,n){this.wasSuccessCode=t,this.connection=e,this.canceled=!!n}}function R(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function N(...t){const e=R();if(void 0!==e){const n=new e;for(let e=0;e<t.length;e++)n.append(t[e]);return n.getBlob()}if(S())return new Blob(t);throw new u(l.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}function P(t){if("undefined"==typeof atob)throw e="base-64",new u(l.UNSUPPORTED_ENVIRONMENT,`${e} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`);var e;return atob(t)}const L={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class O{constructor(t,e){this.data=t,this.contentType=e||null}}function M(t,e){switch(t){case L.RAW:return new O(V(e));case L.BASE64:case L.BASE64URL:return new O(F(t,e));case L.DATA_URL:return new O(function(t){const e=new U(t);return e.base64?F(L.BASE64,e.rest):function(t){let e;try{e=decodeURIComponent(t)}catch(t){throw v(L.DATA_URL,"Malformed data URL.")}return V(e)}(e.rest)}(e),new U(e).contentType)}throw d()}function V(t){const e=[];for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|63&i);else if(55296==(64512&i)){if(n<t.length-1&&56320==(64512&t.charCodeAt(n+1))){i=65536|(1023&i)<<10|1023&t.charCodeAt(++n),e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i)}else e.push(239,191,189)}else 56320==(64512&i)?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|63&i)}return new Uint8Array(e)}function F(t,e){switch(t){case L.BASE64:{const n=-1!==e.indexOf("-"),i=-1!==e.indexOf("_");if(n||i){throw v(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?")}break}case L.BASE64URL:{const n=-1!==e.indexOf("+"),i=-1!==e.indexOf("/");if(n||i){throw v(t,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?")}e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=P(e)}catch(e){if(e.message.includes("polyfill"))throw e;throw v(t,"Invalid character found")}const i=new Uint8Array(n.length);for(let t=0;t<n.length;t++)i[t]=n.charCodeAt(t);return i}class U{constructor(t){this.base64=!1,this.contentType=null;const e=t.match(/^data:([^,]+)?,/);if(null===e)throw v(L.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=e[1]||null;null!=n&&(this.base64=function(t,e){if(!(t.length>=e.length))return!1;return t.substring(t.length-e.length)===e}(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=t.substring(t.indexOf(",")+1)}}class B{constructor(t,e){let n=0,i="";T(t)?(this.data_=t,n=t.size,i=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=i}size(){return this.size_}type(){return this.type_}slice(t,e){if(T(this.data_)){const n=function(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}(this.data_,t,e);return null===n?null:new B(n)}{const n=new Uint8Array(this.data_.buffer,t,e-t);return new B(n,!0)}}static getBlob(...t){if(S()){const e=t.map((t=>t instanceof B?t.data_:t));return new B(N.apply(null,e))}{const e=t.map((t=>E(t)?M(L.RAW,t).data:t.data_));let n=0;e.forEach((t=>{n+=t.byteLength}));const i=new Uint8Array(n);let r=0;return e.forEach((t=>{for(let e=0;e<t.length;e++)i[r++]=t[e]})),new B(i,!0)}}uploadData(){return this.data_}}function j(t){let e;try{e=JSON.parse(t)}catch(t){return null}return"object"!=typeof(n=e)||Array.isArray(n)?null:e;var n}function q(t){const e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function z(t,e){return e}class ${constructor(t,e,n,i){this.server=t,this.local=e||t,this.writable=!!n,this.xform=i||z}}let H=null;function G(){if(H)return H;const t=[];t.push(new $("bucket")),t.push(new $("generation")),t.push(new $("metageneration")),t.push(new $("name","fullPath",!0));const e=new $("name");e.xform=function(t,e){return function(t){return!E(t)||t.length<2?t:q(t)}(e)},t.push(e);const n=new $("size");return n.xform=function(t,e){return void 0!==e?Number(e):e},t.push(n),t.push(new $("timeCreated")),t.push(new $("updated")),t.push(new $("md5Hash",null,!0)),t.push(new $("cacheControl",null,!0)),t.push(new $("contentDisposition",null,!0)),t.push(new $("contentEncoding",null,!0)),t.push(new $("contentLanguage",null,!0)),t.push(new $("contentType",null,!0)),t.push(new $("metadata","customMetadata",!0)),H=t,H}function K(t,e,n){const i={type:"file"},r=n.length;for(let t=0;t<r;t++){const r=n[t];i[r.local]=r.xform(i,e[r.server])}return function(t,e){Object.defineProperty(t,"ref",{get:function(){const n=t.bucket,i=t.fullPath,r=new _(n,i);return e._makeStorageReference(r)}})}(i,t),i}function W(t,e,n){const i=j(e);if(null===i)return null;return K(t,i,n)}function Q(t,e){const n={},i=e.length;for(let r=0;r<i;r++){const i=e[r];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class X{constructor(t,e,n,i){this.url=t,this.method=e,this.handler=n,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Y(t){if(!t)throw d()}function J(t,e){return function(n,i){const r=W(t,i,e);return Y(null!==r),r}}function Z(t,e){return function(n,i){const r=W(t,i,e);return Y(null!==r),function(t,e,n,i){const r=j(e);if(null===r)return null;if(!E(r.downloadTokens))return null;const s=r.downloadTokens;if(0===s.length)return null;const o=encodeURIComponent;return s.split(",").map((e=>{const r=t.bucket,s=t.fullPath;return I("/b/"+o(r)+"/o/"+o(s),n,i)+A({alt:"media",token:e})}))[0]}(r,i,t.host,t._protocol)}}function tt(t){return function(e,n){let i;var r,s;return 401===e.getStatus()?i=e.getErrorText().includes("Firebase App Check token is invalid")?new u(l.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new u(l.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?(s=t.bucket,i=new u(l.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===e.getStatus()?(r=t.path,i=new u(l.UNAUTHORIZED,"User does not have permission to access '"+r+"'.")):i=n,i.status=e.getStatus(),i.serverResponse=n.serverResponse,i}}function et(t){const e=tt(t);return function(n,i){let r=e(n,i);var s;return 404===n.getStatus()&&(s=t.path,r=new u(l.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")),r.serverResponse=i.serverResponse,r}}function nt(t,e,n){const i=I(e.fullServerUrl(),t.host,t._protocol),r=t.maxOperationRetryTime,s=new X(i,"GET",J(t,n),r);return s.errorHandler=et(e),s}function it(t,e,n){const i=Object.assign({},n);return i.fullPath=t.path,i.size=e.size(),i.contentType||(i.contentType=function(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}(null,e)),i}function rt(t,e,n,i,r){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};const a=function(){let t="";for(let e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();o["Content-Type"]="multipart/related; boundary="+a;const u=it(e,i,r),l="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+Q(u,n)+"\r\n--"+a+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",c="\r\n--"+a+"--",h=B.getBlob(l,i,c);if(null===h)throw m();const d={name:u.fullPath},f=I(s,t.host,t._protocol),p=t.maxUploadRetryTime,g=new X(f,"POST",J(t,n),p);return g.urlParams=d,g.headers=o,g.body=h.uploadData(),g.errorHandler=tt(e),g}class st{constructor(t,e,n,i){this.current=t,this.total=e,this.finalized=!!n,this.metadata=i||null}}function ot(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(t){Y(!1)}return Y(!!n&&-1!==(e||["active"]).indexOf(n)),n}const at=262144;function ut(t,e,n,i,r,s,o,a){const c=new st(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=i.size()),i.size()!==c.total)throw new u(l.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.");const h=c.total-c.current;let d=h;r>0&&(d=Math.min(d,r));const f=c.current,p=f+d;let g="";g=0===d?"finalize":h===d?"upload, finalize":"upload";const y={"X-Goog-Upload-Command":g,"X-Goog-Upload-Offset":`${c.current}`},v=i.slice(f,p);if(null===v)throw m();const w=e.maxUploadRetryTime,_=new X(n,"POST",(function(t,n){const r=ot(t,["active","final"]),o=c.current+d,a=i.size();let u;return u="final"===r?J(e,s)(t,n):null,new st(o,a,"final"===r,u)}),w);return _.headers=y,_.body=v.uploadData(),_.progressCallback=a||null,_.errorHandler=tt(t),_}const lt="running",ct="paused",ht="success",dt="canceled",ft="error";function pt(t){switch(t){case"running":case"pausing":case"canceling":return lt;case"paused":return ct;case"success":return ht;case"canceled":return dt;default:return ft}}class mt{constructor(t,e,n){if("function"==typeof t||null!=e||null!=n)this.next=t,this.error=null!=e?e:void 0,this.complete=null!=n?n:void 0;else{const e=t;this.next=e.next,this.error=e.error,this.complete=e.complete}}}function gt(t){return(...e)=>{Promise.resolve().then((()=>t(...e)))}}let yt=null;class vt{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=c.NO_ERROR,this.sendPromise_=new Promise((t=>{this.xhr_.addEventListener("abort",(()=>{this.errorCode_=c.ABORT,t()})),this.xhr_.addEventListener("error",(()=>{this.errorCode_=c.NETWORK_ERROR,t()})),this.xhr_.addEventListener("load",(()=>{t()}))}))}send(t,e,n,i){if(this.sent_)throw w("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),void 0!==i)for(const t in i)i.hasOwnProperty(t)&&this.xhr_.setRequestHeader(t,i[t].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw w("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw w("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}}getResponse(){if(!this.sent_)throw w("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw w("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",t)}}class wt extends vt{initXhr(){this.xhr_.responseType="text"}}function _t(){return yt?yt():new wt}class bt{constructor(t,e,n=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=e,this._metadata=n,this._mappings=G(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=t=>{if(this._request=void 0,this._chunkMultiplier=1,t._codeEquals(l.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const e=this.isExponentialBackoffExpired();if(k(t.status,[])){if(!e)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();t=f()}this._error=t,this._transition("error")}},this._metadataErrorHandler=t=>{this._request=void 0,t._codeEquals(l.CANCELED)?this.completeTransitions_():(this._error=t,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise(((t,e)=>{this._resolve=t,this._reject=e,this._start()})),this._promise.then(null,(()=>{}))}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const t=this._transferred;return e=>this._updateProgress(t+e)}_shouldDoResumable(t){return t.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout((()=>{this.pendingTimeout=void 0,this._continueUpload()}),this.sleepTime):this._oneShotUpload())}_resolveToken(t){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then((([e,n])=>{switch(this._state){case"running":t(e,n);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}}))}_createResumable(){this._resolveToken(((t,e)=>{const n=function(t,e,n,i,r){const s=e.bucketOnlyServerUrl(),o=it(e,i,r),a={name:o.fullPath},u=I(s,t.host,t._protocol),l={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${i.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},c=Q(o,n),h=t.maxUploadRetryTime,d=new X(u,"POST",(function(t){let e;ot(t);try{e=t.getResponseHeader("X-Goog-Upload-URL")}catch(t){Y(!1)}return Y(E(e)),e}),h);return d.urlParams=a,d.headers=l,d.body=c,d.errorHandler=tt(e),d}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(n,_t,t,e);this._request=i,i.getPromise().then((t=>{this._request=void 0,this._uploadUrl=t,this._needToFetchStatus=!1,this.completeTransitions_()}),this._errorHandler)}))}_fetchStatus(){const t=this._uploadUrl;this._resolveToken(((e,n)=>{const i=function(t,e,n,i){const r=t.maxUploadRetryTime,s=new X(n,"POST",(function(t){const e=ot(t,["active","final"]);let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(t){Y(!1)}n||Y(!1);const r=Number(n);return Y(!isNaN(r)),new st(r,i.size(),"final"===e)}),r);return s.headers={"X-Goog-Upload-Command":"query"},s.errorHandler=tt(e),s}(this._ref.storage,this._ref._location,t,this._blob),r=this._ref.storage._makeRequest(i,_t,e,n);this._request=r,r.getPromise().then((t=>{this._request=void 0,this._updateProgress(t.current),this._needToFetchStatus=!1,t.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()}),this._errorHandler)}))}_continueUpload(){const t=at*this._chunkMultiplier,e=new st(this._transferred,this._blob.size()),n=this._uploadUrl;this._resolveToken(((i,r)=>{let s;try{s=ut(this._ref._location,this._ref.storage,n,this._blob,t,this._mappings,e,this._makeProgressCallback())}catch(t){return this._error=t,void this._transition("error")}const o=this._ref.storage._makeRequest(s,_t,i,r,!1);this._request=o,o.getPromise().then((t=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(t.current),t.finalized?(this._metadata=t.metadata,this._transition("success")):this.completeTransitions_()}),this._errorHandler)}))}_increaseMultiplier(){2*(at*this._chunkMultiplier)<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken(((t,e)=>{const n=nt(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(n,_t,t,e);this._request=i,i.getPromise().then((t=>{this._request=void 0,this._metadata=t,this._transition("success")}),this._metadataErrorHandler)}))}_oneShotUpload(){this._resolveToken(((t,e)=>{const n=rt(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(n,_t,t,e);this._request=i,i.getPromise().then((t=>{this._request=void 0,this._metadata=t,this._updateProgress(this._blob.size()),this._transition("success")}),this._errorHandler)}))}_updateProgress(t){const e=this._transferred;this._transferred=t,this._transferred!==e&&this._notifyObservers()}_transition(t){if(this._state!==t)switch(t){case"canceling":case"pausing":this._state=t,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const e="paused"===this._state;this._state=t,e&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=t,this._notifyObservers();break;case"canceled":this._error=p(),this._state=t,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const t=pt(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:t,metadata:this._metadata,task:this,ref:this._ref}}on(t,e,n,i){const r=new mt(e||void 0,n||void 0,i||void 0);return this._addObserver(r),()=>{this._removeObserver(r)}}then(t,e){return this._promise.then(t,e)}catch(t){return this.then(null,t)}_addObserver(t){this._observers.push(t),this._notifyObserver(t)}_removeObserver(t){const e=this._observers.indexOf(t);-1!==e&&this._observers.splice(e,1)}_notifyObservers(){this._finishPromise();this._observers.slice().forEach((t=>{this._notifyObserver(t)}))}_finishPromise(){if(void 0!==this._resolve){let t=!0;switch(pt(this._state)){case ht:gt(this._resolve.bind(null,this.snapshot))();break;case dt:case ft:gt(this._reject.bind(null,this._error))();break;default:t=!1}t&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(t){switch(pt(this._state)){case lt:case ct:t.next&&gt(t.next.bind(t,this.snapshot))();break;case ht:t.complete&&gt(t.complete.bind(t))();break;default:t.error&&gt(t.error.bind(t,this._error))()}}resume(){const t="paused"===this._state||"pausing"===this._state;return t&&this._transition("running"),t}pause(){const t="running"===this._state;return t&&this._transition("pausing"),t}cancel(){const t="running"===this._state||"pausing"===this._state;return t&&this._transition("canceling"),t}}class Et{constructor(t,e){this._service=t,this._location=e instanceof _?e:_.makeFromUrl(e,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,e){return new Et(t,e)}get root(){const t=new _(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return q(this._location.path)}get storage(){return this._service}get parent(){const t=function(t){if(0===t.length)return null;const e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this._location.path);if(null===t)return null;const e=new _(this._location.bucket,t);return new Et(this._service,e)}_throwIfRoot(t){if(""===this._location.path)throw function(t){return new u(l.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(t)}}function Tt(t){t._throwIfRoot("getDownloadURL");const e=function(t,e,n){const i=I(e.fullServerUrl(),t.host,t._protocol),r=t.maxOperationRetryTime,s=new X(i,"GET",Z(t,n),r);return s.errorHandler=et(e),s}(t.storage,t._location,G());return t.storage.makeRequestWithTokens(e,_t).then((t=>{if(null===t)throw new u(l.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return t}))}function St(t,e){const n=function(t,e){const n=e.split("/").filter((t=>t.length>0)).join("/");return 0===t.length?n:t+"/"+n}(t._location.path,e),i=new _(t._location.bucket,n);return new Et(t.storage,i)}function Ct(t,e){if(t instanceof kt){const n=t;if(null==n._bucket)throw new u(l.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+a+"' property when initializing the app?");const i=new Et(n,n._bucket);return null!=e?Ct(i,e):i}return void 0!==e?St(t,e):t}function It(t,e){if(e&&/^[A-Za-z]+:\/\//.test(e)){if(t instanceof kt)return new Et(t,e);throw g("To use ref(service, url), the first argument must be a Storage instance.")}return Ct(t,e)}function At(t,e){const n=null==e?void 0:e[a];return null==n?null:_.makeFromBucketSpec(n,t)}class kt{constructor(t,e,n,i,r){this.app=t,this._authProvider=e,this._appCheckProvider=n,this._url=i,this._firebaseVersion=r,this._bucket=null,this._host=o,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?_.makeFromBucketSpec(i,this._host):At(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,null!=this._url?this._bucket=_.makeFromBucketSpec(this._url,t):this._bucket=At(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){C("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){C("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const e=await t.getToken();if(null!==e)return e.accessToken}return null}async _getAppCheckToken(){const t=this._appCheckProvider.getImmediate({optional:!0});if(t){return(await t.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach((t=>t.cancel())),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new Et(this,t)}_makeRequest(t,e,n,i,r=!0){if(this._deleted)return new b(y());{const s=function(t,e,n,i,r,s,o=!0){const a=A(t.urlParams),u=t.url+a,l=Object.assign({},t.headers);return function(t,e){e&&(t["X-Firebase-GMPID"]=e)}(l,e),function(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(l,n),function(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(null!=e?e:"AppManager")}(l,s),function(t,e){null!==e&&(t["X-Firebase-AppCheck"]=e)}(l,i),new D(u,t.method,l,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r,o)}(t,this._appId,n,i,e,this._firebaseVersion,r);return this._requests.add(s),s.getPromise().then((()=>this._requests.delete(s)),(()=>this._requests.delete(s))),s}}async makeRequestWithTokens(t,e){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,e,n,i).getPromise()}}const Dt="@firebase/storage",xt="0.12.0",Rt="storage";function Nt(t,e,n){return function(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new bt(t,new B(e),n)}(t=(0,r.m9)(t),e,n)}function Pt(t){return Tt(t=(0,r.m9)(t))}function Lt(t,e){return It(t=(0,r.m9)(t),e)}function Ot(t=(0,i.Mq)(),e){t=(0,r.m9)(t);const n=(0,i.qX)(t,Rt).getImmediate({identifier:e}),s=(0,r.P0)("storage");return s&&function(t,e,n,i={}){!function(t,e,n,i={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:s}=i;s&&(t._overrideAuthToken="string"==typeof s?s:(0,r.Sg)(s,t.app.options.projectId))}(t,e,n,i)}(n,...s),n}function Mt(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new kt(n,r,s,e,i.Jn)}(0,i.Xd)(new s.wA(Rt,Mt,"PUBLIC").setMultipleInstances(!0)),(0,i.KN)(Dt,xt,""),(0,i.KN)(Dt,xt,"esm2017")},84962:(t,e,n)=>{n.d(e,{E:()=>Ce});var i=n(71534),r=n(77672),s=n(88726),o=n(93202),a=n(50806),u=n(81662),l=n(45487),c=n(28148),h=n(86917),d=n(70486),f=n(83624);const p=(t,e)=>Math.abs(t-e);var m=n(9403),g=n(15618);class y{constructor(t,e,{transformPagePoint:n,contextWindow:i,dragSnapToOrigin:r=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!this.lastMoveEvent||!this.lastMoveEventInfo)return;const t=_(this.lastMoveEventInfo,this.history),e=null!==this.startEvent,n=function(t,e){const n=p(t.x,e.x),i=p(t.y,e.y);return Math.sqrt(n**2+i**2)}(t.offset,{x:0,y:0})>=3;if(!e&&!n)return;const{point:i}=t,{timestamp:r}=g.frameData;this.history.push({...i,timestamp:r});const{onStart:s,onMove:o}=this.handlers;e||(s&&s(this.lastMoveEvent,t),this.startEvent=this.lastMoveEvent),o&&o(this.lastMoveEvent,t)},this.handlePointerMove=(t,e)=>{this.lastMoveEvent=t,this.lastMoveEventInfo=v(e,this.transformPagePoint),g.Wi.update(this.updatePoint,!0)},this.handlePointerUp=(t,e)=>{this.end();const{onEnd:n,onSessionEnd:i,resumeAnimation:r}=this.handlers;if(this.dragSnapToOrigin&&r&&r(),!this.lastMoveEvent||!this.lastMoveEventInfo)return;const s=_("pointercancel"===t.type?this.lastMoveEventInfo:v(e,this.transformPagePoint),this.history);this.startEvent&&n&&n(t,s),i&&i(t,s)},!(0,m.D)(t))return;this.dragSnapToOrigin=r,this.handlers=e,this.transformPagePoint=n,this.contextWindow=i||window;const s=v((0,c.Q)(t),this.transformPagePoint),{point:o}=s,{timestamp:a}=g.frameData;this.history=[{...o,timestamp:a}];const{onSessionStart:u}=e;u&&u(t,_(s,this.history)),this.removeListeners=(0,f.z)((0,d.a)(this.contextWindow,"pointermove",this.handlePointerMove),(0,d.a)(this.contextWindow,"pointerup",this.handlePointerUp),(0,d.a)(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),(0,g.Pn)(this.updatePoint)}}function v(t,e){return e?{point:e(t.point)}:t}function w(t,e){return{x:t.x-e.x,y:t.y-e.y}}function _({point:t},e){return{point:t,delta:w(t,E(e)),offset:w(t,b(e)),velocity:T(e,.1)}}function b(t){return t[0]}function E(t){return t[t.length-1]}function T(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,i=null;const r=E(t);for(;n>=0&&(i=t[n],!(r.timestamp-i.timestamp>(0,h.w)(e)));)n--;if(!i)return{x:0,y:0};const s=(0,h.X)(r.timestamp-i.timestamp);if(0===s)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}var S=n(37544),C=n(51804),I=n(23967),A=n(80022);function k(t){return t.max-t.min}function D(t,e=0,n=.01){return Math.abs(t-e)<=n}function x(t,e,n,i=.5){t.origin=i,t.originPoint=(0,A.C)(e.min,e.max,t.origin),t.scale=k(n)/k(e),(D(t.scale,1,1e-4)||isNaN(t.scale))&&(t.scale=1),t.translate=(0,A.C)(n.min,n.max,t.origin)-t.originPoint,(D(t.translate)||isNaN(t.translate))&&(t.translate=0)}function R(t,e,n,i){x(t.x,e.x,n.x,i?i.originX:void 0),x(t.y,e.y,n.y,i?i.originY:void 0)}function N(t,e,n){t.min=n.min+e.min,t.max=t.min+k(e)}function P(t,e,n){t.min=e.min-n.min,t.max=t.min+k(e)}function L(t,e,n){P(t.x,e.x,n.x),P(t.y,e.y,n.y)}var O=n(24169);function M(t,e,n){return{min:void 0!==e?t.min+e:void 0,max:void 0!==n?t.max+n-(t.max-t.min):void 0}}function V(t,e){let n=e.min-t.min,i=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,i]=[i,n]),{min:n,max:i}}const F=.35;function U(t,e,n){return{min:B(t,e),max:B(t,n)}}function B(t,e){return"number"==typeof t?t:t[e]||0}var j=n(61512);function q(t){return[t("x"),t("y")]}var z=n(56460),$=n(76117),H=n(18456),G=n(96190),K=n(8824);const W=({current:t})=>t?t.ownerDocument.defaultView:null,Q=new WeakMap;class X{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=(0,j.dO)(),this.visualElement=t}start(t,{snapToCursor:e=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&!1===n.isPresent)return;const{dragSnapToOrigin:i}=this.getProps();this.panSession=new y(t,{onSessionStart:t=>{const{dragSnapToOrigin:n}=this.getProps();n?this.pauseAnimation():this.stopAnimation(),e&&this.snapToCursor((0,c.Q)(t,"page").point)},onStart:(t,e)=>{const{drag:n,dragPropagation:i,onDragStart:r}=this.getProps();if(n&&!i&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=(0,S.fJ)(n),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),q((t=>{let e=this.getAxisMotionValue(t).get()||0;if(G.aQ.test(e)){const{projection:n}=this.visualElement;if(n&&n.layout){const i=n.layout.layoutBox[t];if(i){e=k(i)*(parseFloat(e)/100)}}}this.originPoint[t]=e})),r&&g.Wi.update((()=>r(t,e)),!1,!0);const{animationState:s}=this.visualElement;s&&s.setActive("whileDrag",!0)},onMove:(t,e)=>{const{dragPropagation:n,dragDirectionLock:i,onDirectionLock:r,onDrag:s}=this.getProps();if(!n&&!this.openGlobalLock)return;const{offset:o}=e;if(i&&null===this.currentDirection)return this.currentDirection=function(t,e=10){let n=null;Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x");return n}(o),void(null!==this.currentDirection&&r&&r(this.currentDirection));this.updateAxis("x",e.point,o),this.updateAxis("y",e.point,o),this.visualElement.render(),s&&s(t,e)},onSessionEnd:(t,e)=>this.stop(t,e),resumeAnimation:()=>q((t=>{var e;return"paused"===this.getAnimationState(t)&&(null===(e=this.getAxisMotionValue(t).animation)||void 0===e?void 0:e.play())}))},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:i,contextWindow:W(this.visualElement)})}stop(t,e){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:i}=e;this.startAnimation(i);const{onDragEnd:r}=this.getProps();r&&g.Wi.update((()=>r(t,e)))}cancel(){this.isDragging=!1;const{projection:t,animationState:e}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),e&&e.setActive("whileDrag",!1)}updateAxis(t,e,n){const{drag:i}=this.getProps();if(!n||!Y(t,i,this.currentDirection))return;const r=this.getAxisMotionValue(t);let s=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(s=function(t,{min:e,max:n},i){return void 0!==e&&t<e?t=i?(0,A.C)(e,t,i.min):Math.max(t,e):void 0!==n&&t>n&&(t=i?(0,A.C)(n,t,i.max):Math.min(t,n)),t}(s,this.constraints[t],this.elastic[t])),r.set(s)}resolveConstraints(){var t;const{dragConstraints:e,dragElastic:n}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):null===(t=this.visualElement.projection)||void 0===t?void 0:t.layout,r=this.constraints;e&&(0,C.I)(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):this.constraints=!(!e||!i)&&function(t,{top:e,left:n,bottom:i,right:r}){return{x:M(t.x,n,r),y:M(t.y,e,i)}}(i.layoutBox,e),this.elastic=function(t=F){return!1===t?t=0:!0===t&&(t=F),{x:U(t,"left","right"),y:U(t,"top","bottom")}}(n),r!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&q((t=>{this.getAxisMotionValue(t)&&(this.constraints[t]=function(t,e){const n={};return void 0!==e.min&&(n.min=e.min-t.min),void 0!==e.max&&(n.max=e.max-t.min),n}(i.layoutBox[t],this.constraints[t]))}))}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:e}=this.getProps();if(!t||!(0,C.I)(t))return!1;const n=t.current;(0,l.k)(null!==n,"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.");const{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const r=(0,z.z)(n,i.root,this.visualElement.getTransformPagePoint());let s=function(t,e){return{x:V(t.x,e.x),y:V(t.y,e.y)}}(i.layout.layoutBox,r);if(e){const t=e((0,$.z2)(s));this.hasMutatedConstraints=!!t,t&&(s=(0,$.i8)(t))}return s}startAnimation(t){const{drag:e,dragMomentum:n,dragElastic:i,dragTransition:r,dragSnapToOrigin:s,onDragTransitionEnd:o}=this.getProps(),a=this.constraints||{},u=q((o=>{if(!Y(o,e,this.currentDirection))return;let u=a&&a[o]||{};s&&(u={min:0,max:0});const l=i?200:1e6,c=i?40:1e7,h={type:"inertia",velocity:n?t[o]:0,bounceStiffness:l,bounceDamping:c,timeConstant:750,restDelta:1,restSpeed:10,...r,...u};return this.startAxisValueAnimation(o,h)}));return Promise.all(u).then(o)}startAxisValueAnimation(t,e){const n=this.getAxisMotionValue(t);return n.start((0,K.v)(t,n,0,e))}stopAnimation(){q((t=>this.getAxisMotionValue(t).stop()))}pauseAnimation(){q((t=>{var e;return null===(e=this.getAxisMotionValue(t).animation)||void 0===e?void 0:e.pause()}))}getAnimationState(t){var e;return null===(e=this.getAxisMotionValue(t).animation)||void 0===e?void 0:e.state}getAxisMotionValue(t){const e="_drag"+t.toUpperCase(),n=this.visualElement.getProps(),i=n[e];return i||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){q((e=>{const{drag:n}=this.getProps();if(!Y(e,n,this.currentDirection))return;const{projection:i}=this.visualElement,r=this.getAxisMotionValue(e);if(i&&i.layout){const{min:n,max:s}=i.layout.layoutBox[e];r.set(t[e]-(0,A.C)(n,s,.5))}}))}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:e}=this.getProps(),{projection:n}=this.visualElement;if(!(0,C.I)(e)||!n||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};q((t=>{const e=this.getAxisMotionValue(t);if(e){const n=e.get();i[t]=function(t,e){let n=.5;const i=k(t),r=k(e);return r>i?n=(0,I.Y)(e.min,e.max-i,t.min):i>r&&(n=(0,I.Y)(t.min,t.max-r,e.min)),(0,O.u)(0,1,n)}({min:n,max:n},this.constraints[t])}}));const{transformTemplate:r}=this.visualElement.getProps();this.visualElement.current.style.transform=r?r({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),q((e=>{if(!Y(e,t,null))return;const n=this.getAxisMotionValue(e),{min:r,max:s}=this.constraints[e];n.set((0,A.C)(r,s,i[e]))}))}addListeners(){if(!this.visualElement.current)return;Q.set(this.visualElement,this);const t=this.visualElement.current,e=(0,d.a)(t,"pointerdown",(t=>{const{drag:e,dragListener:n=!0}=this.getProps();e&&n&&this.start(t)})),n=()=>{const{dragConstraints:t}=this.getProps();(0,C.I)(t)&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,r=i.addEventListener("measure",n);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),n();const s=(0,H.E)(window,"resize",(()=>this.scalePositionWithinConstraints())),o=i.addEventListener("didUpdate",(({delta:t,hasLayoutChanged:e})=>{this.isDragging&&e&&(q((e=>{const n=this.getAxisMotionValue(e);n&&(this.originPoint[e]+=t[e].translate,n.set(n.get()+t[e].translate))})),this.visualElement.render())}));return()=>{s(),e(),r(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:e=!1,dragDirectionLock:n=!1,dragPropagation:i=!1,dragConstraints:r=!1,dragElastic:s=F,dragMomentum:o=!0}=t;return{...t,drag:e,dragDirectionLock:n,dragPropagation:i,dragConstraints:r,dragElastic:s,dragMomentum:o}}}function Y(t,e,n){return!(!0!==e&&e!==t||null!==n&&n!==t)}class J extends a.L{constructor(t){super(t),this.removeGroupControls=u.Z,this.removeListeners=u.Z,this.controls=new X(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||u.Z}unmount(){this.removeGroupControls(),this.removeListeners()}}const Z=t=>(e,n)=>{t&&g.Wi.update((()=>t(e,n)))};class tt extends a.L{constructor(){super(...arguments),this.removePointerDownListener=u.Z}onPointerDown(t){this.session=new y(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:W(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:e,onPan:n,onPanEnd:i}=this.node.getProps();return{onSessionStart:Z(t),onStart:Z(e),onMove:n,onEnd:(t,e)=>{delete this.session,i&&g.Wi.update((()=>i(t,e)))}}}mount(){this.removePointerDownListener=(0,d.a)(this.node.current,"pointerdown",(t=>this.onPointerDown(t)))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}var et=n(67294),nt=n(240);var it=n(25364),rt=n(41705);const st={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function ot(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const at={correct:(t,e)=>{if(!e.target)return t;if("string"==typeof t){if(!G.px.test(t))return t;t=parseFloat(t)}return`${ot(t,e.target.x)}% ${ot(t,e.target.y)}%`}};var ut=n(51550);const lt={correct:(t,{treeScale:e,projectionDelta:n})=>{const i=t,r=ut.P.parse(t);if(r.length>5)return i;const s=ut.P.createTransformer(t),o="number"!=typeof r[0]?1:0,a=n.x.scale*e.x,u=n.y.scale*e.y;r[0+o]/=a,r[1+o]/=u;const l=(0,A.C)(a,u,.5);return"number"==typeof r[2+o]&&(r[2+o]/=l),"number"==typeof r[3+o]&&(r[3+o]/=l),s(r)}};var ct=n(64561);class ht extends et.Component{componentDidMount(){const{visualElement:t,layoutGroup:e,switchLayoutGroup:n,layoutId:i}=this.props,{projection:r}=t;(0,ct.B)(ft),r&&(e.group&&e.group.add(r),n&&n.register&&i&&n.register(r),r.root.didUpdate(),r.addEventListener("animationComplete",(()=>{this.safeToRemove()})),r.setOptions({...r.options,onExitComplete:()=>this.safeToRemove()})),st.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:e,visualElement:n,drag:i,isPresent:r}=this.props,s=n.projection;return s?(s.isPresent=r,i||t.layoutDependency!==e||void 0===e?s.willUpdate():this.safeToRemove(),t.isPresent!==r&&(r?s.promote():s.relegate()||g.Wi.postRender((()=>{const t=s.getStack();t&&t.members.length||this.safeToRemove()}))),null):null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),queueMicrotask((()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()})))}componentWillUnmount(){const{visualElement:t,layoutGroup:e,switchLayoutGroup:n}=this.props,{projection:i}=t;i&&(i.scheduleCheckAfterUnmount(),e&&e.group&&e.group.remove(i),n&&n.deregister&&n.deregister(i))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function dt(t){const[e,n]=function(){const t=(0,et.useContext)(nt.O);if(null===t)return[!0,null];const{isPresent:e,onExitComplete:n,register:i}=t,r=(0,et.useId)();return(0,et.useEffect)((()=>i(r)),[]),!e&&n?[!1,()=>n&&n(r)]:[!0]}(),i=(0,et.useContext)(it.p);return et.createElement(ht,{...t,layoutGroup:i,switchLayoutGroup:(0,et.useContext)(rt.g),isPresent:e,safeToRemove:n})}const ft={borderRadius:{...at,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:at,borderTopRightRadius:at,borderBottomLeftRadius:at,borderBottomRightRadius:at,boxShadow:lt};var pt=n(21560),mt=n(27255);const gt=["TopLeft","TopRight","BottomLeft","BottomRight"],yt=gt.length,vt=t=>"string"==typeof t?parseFloat(t):t,wt=t=>"number"==typeof t||G.px.test(t);function _t(t,e){return void 0!==t[e]?t[e]:t.borderRadius}const bt=Tt(0,.5,mt.Bn),Et=Tt(.5,.95,u.Z);function Tt(t,e,n){return i=>i<t?0:i>e?1:n((0,I.Y)(t,e,i))}function St(t,e){t.min=e.min,t.max=e.max}function Ct(t,e){St(t.x,e.x),St(t.y,e.y)}var It=n(16e3);function At(t,e,n,i,r){return t-=e,t=(0,It.q2)(t,1/n,i),void 0!==r&&(t=(0,It.q2)(t,1/r,i)),t}function kt(t,e,[n,i,r],s,o){!function(t,e=0,n=1,i=.5,r,s=t,o=t){G.aQ.test(e)&&(e=parseFloat(e),e=(0,A.C)(o.min,o.max,e/100)-o.min);if("number"!=typeof e)return;let a=(0,A.C)(s.min,s.max,i);t===s&&(a-=e),t.min=At(t.min,e,n,a,r),t.max=At(t.max,e,n,a,r)}(t,e[n],e[i],e[r],e.scale,s,o)}const Dt=["x","scaleX","originX"],xt=["y","scaleY","originY"];function Rt(t,e,n,i){kt(t.x,e,Dt,n?n.x:void 0,i?i.x:void 0),kt(t.y,e,xt,n?n.y:void 0,i?i.y:void 0)}var Nt=n(31056);function Pt(t){return 0===t.translate&&1===t.scale}function Lt(t){return Pt(t.x)&&Pt(t.y)}function Ot(t,e){return Math.round(t.x.min)===Math.round(e.x.min)&&Math.round(t.x.max)===Math.round(e.x.max)&&Math.round(t.y.min)===Math.round(e.y.min)&&Math.round(t.y.max)===Math.round(e.y.max)}function Mt(t){return k(t.x)/k(t.y)}var Vt=n(10010);class Ft{constructor(){this.members=[]}add(t){(0,Vt.y4)(this.members,t),t.scheduleRender()}remove(t){if((0,Vt.cl)(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(t){const e=this.members.findIndex((e=>t===e));if(0===e)return!1;let n;for(let t=e;t>=0;t--){const e=this.members[t];if(!1!==e.isPresent){n=e;break}}return!!n&&(this.promote(n),!0)}promote(t,e){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,e&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:i}=t.options;!1===i&&n.hide()}}exitAnimationComplete(){this.members.forEach((t=>{const{options:e,resumingFrom:n}=t;e.onExitComplete&&e.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()}))}scheduleRender(){this.members.forEach((t=>{t.instance&&t.scheduleRender(!1)}))}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Ut(t,e,n){let i="";const r=t.x.translate/e.x,s=t.y.translate/e.y;if((r||s)&&(i=`translate3d(${r}px, ${s}px, 0) `),1===e.x&&1===e.y||(i+=`scale(${1/e.x}, ${1/e.y}) `),n){const{rotate:t,rotateX:e,rotateY:r}=n;t&&(i+=`rotate(${t}deg) `),e&&(i+=`rotateX(${e}deg) `),r&&(i+=`rotateY(${r}deg) `)}const o=t.x.scale*e.x,a=t.y.scale*e.y;return 1===o&&1===a||(i+=`scale(${o}, ${a})`),i||"none"}var Bt=n(99527);const jt=(t,e)=>t.depth-e.depth;class qt{constructor(){this.children=[],this.isDirty=!1}add(t){(0,Vt.y4)(this.children,t),this.isDirty=!0}remove(t){(0,Vt.cl)(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(jt),this.isDirty=!1,this.children.forEach(t)}}var zt=n(16399);var $t=n(33234),Ht=n(40406);const Gt=["","X","Y","Z"],Kt={visibility:"hidden"};let Wt=0;const Qt={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function Xt({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(t={},n=(null==e?void 0:e())){this.id=Wt++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{var t;this.projectionUpdateScheduled=!1,Qt.totalNodes=Qt.resolvedTargetDeltas=Qt.recalculatedProjection=0,this.nodes.forEach(Zt),this.nodes.forEach(oe),this.nodes.forEach(ae),this.nodes.forEach(te),t=Qt,window.MotionDebug&&window.MotionDebug.record(t)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=t,this.root=n?n.root||n:this,this.path=n?[...n.path,n]:[],this.parent=n,this.depth=n?n.depth+1:0;for(let t=0;t<this.path.length;t++)this.path[t].shouldResetTransform=!0;this.root===this&&(this.nodes=new qt)}addEventListener(t,e){return this.eventHandlers.has(t)||this.eventHandlers.set(t,new pt.L),this.eventHandlers.get(t).add(e)}notifyListeners(t,...e){const n=this.eventHandlers.get(t);n&&n.notify(...e)}hasListeners(t){return this.eventHandlers.has(t)}mount(e,n=this.root.hasTreeAnimated){if(this.instance)return;var i;this.isSVG=(i=e)instanceof SVGElement&&"svg"!==i.tagName,this.instance=e;const{layoutId:r,layout:s,visualElement:o}=this.options;if(o&&!o.current&&o.mount(e),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),n&&(s||r)&&(this.isLayoutDirty=!0),t){let n;const i=()=>this.root.updateBlockedByResize=!1;t(e,(()=>{this.root.updateBlockedByResize=!0,n&&n(),n=function(t,e){const n=performance.now(),i=({timestamp:r})=>{const s=r-n;s>=e&&((0,g.Pn)(i),t(s-e))};return g.Wi.read(i,!0),()=>(0,g.Pn)(i)}(i,250),st.hasAnimatedSinceResize&&(st.hasAnimatedSinceResize=!1,this.nodes.forEach(se))}))}r&&this.root.registerSharedNode(r,this),!1!==this.options.animate&&o&&(r||s)&&this.addEventListener("didUpdate",(({delta:t,hasLayoutChanged:e,hasRelativeTargetChanged:n,layout:i})=>{if(this.isTreeAnimationBlocked())return this.target=void 0,void(this.relativeTarget=void 0);const r=this.options.transition||o.getDefaultTransition()||fe,{onLayoutAnimationStart:s,onLayoutAnimationComplete:a}=o.getProps(),u=!this.targetLayout||!Ot(this.targetLayout,i)||n,l=!e&&n;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||l||e&&(u||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(t,l);const e={...(0,Nt.e)(r,"layout"),onPlay:s,onComplete:a};(o.shouldReduceMotion||this.options.layoutRoot)&&(e.delay=0,e.type=!1),this.startAnimation(e)}else e||se(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=i}))}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const t=this.getStack();t&&t.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,(0,g.Pn)(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(ue),this.animationId++)}getTransformTemplate(){const{visualElement:t}=this.options;return t&&t.getProps().transformTemplate}willUpdate(t=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked())return void(this.options.onExitComplete&&this.options.onExitComplete());if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let t=0;t<this.path.length;t++){const e=this.path[t];e.shouldResetTransform=!0,e.updateScroll("snapshot"),e.options.layoutRoot&&e.willUpdate(!1)}const{layoutId:e,layout:n}=this.options;if(void 0===e&&!n)return;const i=this.getTransformTemplate();this.prevTransformTemplateValue=i?i(this.latestValues,""):void 0,this.updateSnapshot(),t&&this.notifyListeners("willUpdate")}update(){this.updateScheduled=!1;if(this.isUpdateBlocked())return this.unblockUpdate(),this.clearAllSnapshots(),void this.nodes.forEach(ne);this.isUpdating||this.nodes.forEach(ie),this.isUpdating=!1,this.nodes.forEach(re),this.nodes.forEach(Yt),this.nodes.forEach(Jt),this.clearAllSnapshots();const t=performance.now();g.frameData.delta=(0,O.u)(0,1e3/60,t-g.frameData.timestamp),g.frameData.timestamp=t,g.frameData.isProcessing=!0,g.S6.update.process(g.frameData),g.S6.preRender.process(g.frameData),g.S6.render.process(g.frameData),g.frameData.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask((()=>this.update())))}clearAllSnapshots(){this.nodes.forEach(ee),this.sharedNodes.forEach(le)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,g.Wi.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){g.Wi.postRender((()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()}))}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure())}updateLayout(){if(!this.instance)return;if(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead()||this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let t=0;t<this.path.length;t++){this.path[t].updateScroll()}const t=this.layout;this.layout=this.measure(!1),this.layoutCorrected=(0,j.dO)(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:e}=this.options;e&&e.notify("LayoutMeasure",this.layout.layoutBox,t?t.layoutBox:void 0)}updateScroll(t="measure"){let e=Boolean(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===t&&(e=!1),e&&(this.scroll={animationId:this.root.animationId,phase:t,isRoot:i(this.instance),offset:n(this.instance)})}resetTransform(){if(!r)return;const t=this.isLayoutDirty||this.shouldResetTransform,e=this.projectionDelta&&!Lt(this.projectionDelta),n=this.getTransformTemplate(),i=n?n(this.latestValues,""):void 0,s=i!==this.prevTransformTemplateValue;t&&(e||(0,Bt.ud)(this.latestValues)||s)&&(r(this.instance,i),this.shouldResetTransform=!1,this.scheduleRender())}measure(t=!0){const e=this.measurePageBox();let n=this.removeElementScroll(e);var i;return t&&(n=this.removeTransform(n)),ge((i=n).x),ge(i.y),{animationId:this.root.animationId,measuredBox:e,layoutBox:n,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:t}=this.options;if(!t)return(0,j.dO)();const e=t.measureViewportBox(),{scroll:n}=this.root;return n&&((0,It.am)(e.x,n.offset.x),(0,It.am)(e.y,n.offset.y)),e}removeElementScroll(t){const e=(0,j.dO)();Ct(e,t);for(let n=0;n<this.path.length;n++){const i=this.path[n],{scroll:r,options:s}=i;if(i!==this.root&&r&&s.layoutScroll){if(r.isRoot){Ct(e,t);const{scroll:n}=this.root;n&&((0,It.am)(e.x,-n.offset.x),(0,It.am)(e.y,-n.offset.y))}(0,It.am)(e.x,r.offset.x),(0,It.am)(e.y,r.offset.y)}}return e}applyTransform(t,e=!1){const n=(0,j.dO)();Ct(n,t);for(let t=0;t<this.path.length;t++){const i=this.path[t];!e&&i.options.layoutScroll&&i.scroll&&i!==i.root&&(0,It.D2)(n,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),(0,Bt.ud)(i.latestValues)&&(0,It.D2)(n,i.latestValues)}return(0,Bt.ud)(this.latestValues)&&(0,It.D2)(n,this.latestValues),n}removeTransform(t){const e=(0,j.dO)();Ct(e,t);for(let t=0;t<this.path.length;t++){const n=this.path[t];if(!n.instance)continue;if(!(0,Bt.ud)(n.latestValues))continue;(0,Bt.Lj)(n.latestValues)&&n.updateSnapshot();const i=(0,j.dO)();Ct(i,n.measurePageBox()),Rt(e,n.latestValues,n.snapshot?n.snapshot.layoutBox:void 0,i)}return(0,Bt.ud)(this.latestValues)&&Rt(e,this.latestValues),e}setTargetDelta(t){this.targetDelta=t,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(t){this.options={...this.options,...t,crossfade:void 0===t.crossfade||t.crossfade}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==g.frameData.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(t=!1){var e;const n=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=n.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=n.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=n.isSharedProjectionDirty);const i=Boolean(this.resumingFrom)||this!==n;if(!(t||i&&this.isSharedProjectionDirty||this.isProjectionDirty||(null===(e=this.parent)||void 0===e?void 0:e.isProjectionDirty)||this.attemptToResolveRelativeTarget))return;const{layout:r,layoutId:s}=this.options;if(this.layout&&(r||s)){if(this.resolvedRelativeTargetAt=g.frameData.timestamp,!this.targetDelta&&!this.relativeTarget){const t=this.getClosestProjectingParent();t&&t.layout&&1!==this.animationProgress?(this.relativeParent=t,this.forceRelativeParentToResolveTarget(),this.relativeTarget=(0,j.dO)(),this.relativeTargetOrigin=(0,j.dO)(),L(this.relativeTargetOrigin,this.layout.layoutBox,t.layout.layoutBox),Ct(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(this.relativeTarget||this.targetDelta){var o,a,u;if(this.target||(this.target=(0,j.dO)(),this.targetWithTransforms=(0,j.dO)()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),o=this.target,a=this.relativeTarget,u=this.relativeParent.target,N(o.x,a.x,u.x),N(o.y,a.y,u.y)):this.targetDelta?(Boolean(this.resumingFrom)?this.target=this.applyTransform(this.layout.layoutBox):Ct(this.target,this.layout.layoutBox),(0,It.o2)(this.target,this.targetDelta)):Ct(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const t=this.getClosestProjectingParent();t&&Boolean(t.resumingFrom)===Boolean(this.resumingFrom)&&!t.options.layoutScroll&&t.target&&1!==this.animationProgress?(this.relativeParent=t,this.forceRelativeParentToResolveTarget(),this.relativeTarget=(0,j.dO)(),this.relativeTargetOrigin=(0,j.dO)(),L(this.relativeTargetOrigin,this.target,t.target),Ct(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Qt.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(this.parent&&!(0,Bt.Lj)(this.parent.latestValues)&&!(0,Bt.D_)(this.parent.latestValues))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return Boolean((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var t;const e=this.getLead(),n=Boolean(this.resumingFrom)||this!==e;let i=!0;if((this.isProjectionDirty||(null===(t=this.parent)||void 0===t?void 0:t.isProjectionDirty))&&(i=!1),n&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(i=!1),this.resolvedRelativeTargetAt===g.frameData.timestamp&&(i=!1),i)return;const{layout:r,layoutId:s}=this.options;if(this.isTreeAnimating=Boolean(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!r&&!s)return;Ct(this.layoutCorrected,this.layout.layoutBox);const o=this.treeScale.x,a=this.treeScale.y;(0,It.YY)(this.layoutCorrected,this.treeScale,this.path,n),!e.layout||e.target||1===this.treeScale.x&&1===this.treeScale.y||(e.target=e.layout.layoutBox);const{target:u}=e;if(!u)return void(this.projectionTransform&&(this.projectionDelta=(0,j.wc)(),this.projectionTransform="none",this.scheduleRender()));this.projectionDelta||(this.projectionDelta=(0,j.wc)(),this.projectionDeltaWithTransform=(0,j.wc)());const l=this.projectionTransform;R(this.projectionDelta,this.layoutCorrected,u,this.latestValues),this.projectionTransform=Ut(this.projectionDelta,this.treeScale),this.projectionTransform===l&&this.treeScale.x===o&&this.treeScale.y===a||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",u)),Qt.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(t=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),t){const t=this.getStack();t&&t.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(t,e=!1){const n=this.snapshot,i=n?n.latestValues:{},r={...this.latestValues},s=(0,j.wc)();this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!e;const o=(0,j.dO)(),a=(n?n.source:void 0)!==(this.layout?this.layout.source:void 0),u=this.getStack(),l=!u||u.members.length<=1,c=Boolean(a&&!l&&!0===this.options.crossfade&&!this.path.some(de));let h;this.animationProgress=0,this.mixTargetDelta=e=>{const n=e/1e3;var u,d,f,p,m,g;ce(s.x,t.x,n),ce(s.y,t.y,n),this.setTargetDelta(s),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(L(o,this.layout.layoutBox,this.relativeParent.layout.layoutBox),f=this.relativeTarget,p=this.relativeTargetOrigin,m=o,g=n,he(f.x,p.x,m.x,g),he(f.y,p.y,m.y,g),h&&(u=this.relativeTarget,d=h,u.x.min===d.x.min&&u.x.max===d.x.max&&u.y.min===d.y.min&&u.y.max===d.y.max)&&(this.isProjectionDirty=!1),h||(h=(0,j.dO)()),Ct(h,this.relativeTarget)),a&&(this.animationValues=r,function(t,e,n,i,r,s){r?(t.opacity=(0,A.C)(0,void 0!==n.opacity?n.opacity:1,bt(i)),t.opacityExit=(0,A.C)(void 0!==e.opacity?e.opacity:1,0,Et(i))):s&&(t.opacity=(0,A.C)(void 0!==e.opacity?e.opacity:1,void 0!==n.opacity?n.opacity:1,i));for(let r=0;r<yt;r++){const s=`border${gt[r]}Radius`;let o=_t(e,s),a=_t(n,s);void 0===o&&void 0===a||(o||(o=0),a||(a=0),0===o||0===a||wt(o)===wt(a)?(t[s]=Math.max((0,A.C)(vt(o),vt(a),i),0),(G.aQ.test(a)||G.aQ.test(o))&&(t[s]+="%")):t[s]=a)}(e.rotate||n.rotate)&&(t.rotate=(0,A.C)(e.rotate||0,n.rotate||0,i))}(r,i,this.latestValues,n,c,l)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=n},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(t){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&((0,g.Pn)(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=g.Wi.update((()=>{st.hasAnimatedSinceResize=!0,this.currentAnimation=function(t,e,n){const i=(0,Ht.i)(t)?t:(0,$t.BX)(t);return i.start((0,K.v)("",i,e,n)),i.animation}(0,1e3,{...t,onUpdate:e=>{this.mixTargetDelta(e),t.onUpdate&&t.onUpdate(e)},onComplete:()=>{t.onComplete&&t.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0}))}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const t=this.getStack();t&&t.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const t=this.getLead();let{targetWithTransforms:e,target:n,layout:i,latestValues:r}=t;if(e&&n&&i){if(this!==t&&this.layout&&i&&ye(this.options.animationType,this.layout.layoutBox,i.layoutBox)){n=this.target||(0,j.dO)();const e=k(this.layout.layoutBox.x);n.x.min=t.target.x.min,n.x.max=n.x.min+e;const i=k(this.layout.layoutBox.y);n.y.min=t.target.y.min,n.y.max=n.y.min+i}Ct(e,n),(0,It.D2)(e,r),R(this.projectionDeltaWithTransform,this.layoutCorrected,e,r)}}registerSharedNode(t,e){this.sharedNodes.has(t)||this.sharedNodes.set(t,new Ft);this.sharedNodes.get(t).add(e);const n=e.options.initialPromotionConfig;e.promote({transition:n?n.transition:void 0,preserveFollowOpacity:n&&n.shouldPreserveFollowOpacity?n.shouldPreserveFollowOpacity(e):void 0})}isLead(){const t=this.getStack();return!t||t.lead===this}getLead(){var t;const{layoutId:e}=this.options;return e&&(null===(t=this.getStack())||void 0===t?void 0:t.lead)||this}getPrevLead(){var t;const{layoutId:e}=this.options;return e?null===(t=this.getStack())||void 0===t?void 0:t.prevLead:void 0}getStack(){const{layoutId:t}=this.options;if(t)return this.root.sharedNodes.get(t)}promote({needsReset:t,transition:e,preserveFollowOpacity:n}={}){const i=this.getStack();i&&i.promote(this,n),t&&(this.projectionDelta=void 0,this.needsReset=!0),e&&this.setOptions({transition:e})}relegate(){const t=this.getStack();return!!t&&t.relegate(this)}resetRotation(){const{visualElement:t}=this.options;if(!t)return;let e=!1;const{latestValues:n}=t;if((n.rotate||n.rotateX||n.rotateY||n.rotateZ)&&(e=!0),!e)return;const i={};for(let e=0;e<Gt.length;e++){const r="rotate"+Gt[e];n[r]&&(i[r]=n[r],t.setStaticValue(r,0))}t.render();for(const e in i)t.setStaticValue(e,i[e]);t.scheduleRender()}getProjectionStyles(t){var e,n;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Kt;const i={visibility:""},r=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,i.opacity="",i.pointerEvents=(0,zt.b)(null==t?void 0:t.pointerEvents)||"",i.transform=r?r(this.latestValues,""):"none",i;const s=this.getLead();if(!this.projectionDelta||!this.layout||!s.target){const e={};return this.options.layoutId&&(e.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,e.pointerEvents=(0,zt.b)(null==t?void 0:t.pointerEvents)||""),this.hasProjected&&!(0,Bt.ud)(this.latestValues)&&(e.transform=r?r({},""):"none",this.hasProjected=!1),e}const o=s.animationValues||s.latestValues;this.applyTransformsToTarget(),i.transform=Ut(this.projectionDeltaWithTransform,this.treeScale,o),r&&(i.transform=r(o,i.transform));const{x:a,y:u}=this.projectionDelta;i.transformOrigin=`${100*a.origin}% ${100*u.origin}% 0`,s.animationValues?i.opacity=s===this?null!==(n=null!==(e=o.opacity)&&void 0!==e?e:this.latestValues.opacity)&&void 0!==n?n:1:this.preserveOpacity?this.latestValues.opacity:o.opacityExit:i.opacity=s===this?void 0!==o.opacity?o.opacity:"":void 0!==o.opacityExit?o.opacityExit:0;for(const t in ct.P){if(void 0===o[t])continue;const{correct:e,applyTo:n}=ct.P[t],r="none"===i.transform?o[t]:e(o[t],s);if(n){const t=n.length;for(let e=0;e<t;e++)i[n[e]]=r}else i[t]=r}return this.options.layoutId&&(i.pointerEvents=s===this?(0,zt.b)(null==t?void 0:t.pointerEvents)||"":"none"),i}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach((t=>{var e;return null===(e=t.currentAnimation)||void 0===e?void 0:e.stop()})),this.root.nodes.forEach(ne),this.root.sharedNodes.clear()}}}function Yt(t){t.updateLayout()}function Jt(t){var e;const n=(null===(e=t.resumeFrom)||void 0===e?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:e,measuredBox:i}=t.layout,{animationType:r}=t.options,s=n.source!==t.layout.source;"size"===r?q((t=>{const i=s?n.measuredBox[t]:n.layoutBox[t],r=k(i);i.min=e[t].min,i.max=i.min+r})):ye(r,n.layoutBox,e)&&q((i=>{const r=s?n.measuredBox[i]:n.layoutBox[i],o=k(e[i]);r.max=r.min+o,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[i].max=t.relativeTarget[i].min+o)}));const o=(0,j.wc)();R(o,e,n.layoutBox);const a=(0,j.wc)();s?R(a,t.applyTransform(i,!0),n.measuredBox):R(a,e,n.layoutBox);const u=!Lt(o);let l=!1;if(!t.resumeFrom){const i=t.getClosestProjectingParent();if(i&&!i.resumeFrom){const{snapshot:r,layout:s}=i;if(r&&s){const o=(0,j.dO)();L(o,n.layoutBox,r.layoutBox);const a=(0,j.dO)();L(a,e,s.layoutBox),Ot(o,a)||(l=!0),i.options.layoutRoot&&(t.relativeTarget=a,t.relativeTargetOrigin=o,t.relativeParent=i)}}}t.notifyListeners("didUpdate",{layout:e,snapshot:n,delta:a,layoutDelta:o,hasLayoutChanged:u,hasRelativeTargetChanged:l})}else if(t.isLead()){const{onExitComplete:e}=t.options;e&&e()}t.options.transition=void 0}function Zt(t){Qt.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=Boolean(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function te(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function ee(t){t.clearSnapshot()}function ne(t){t.clearMeasurements()}function ie(t){t.isLayoutDirty=!1}function re(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function se(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function oe(t){t.resolveTargetDelta()}function ae(t){t.calcProjection()}function ue(t){t.resetRotation()}function le(t){t.removeLeadSnapshot()}function ce(t,e,n){t.translate=(0,A.C)(e.translate,0,n),t.scale=(0,A.C)(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function he(t,e,n,i){t.min=(0,A.C)(e.min,n.min,i),t.max=(0,A.C)(e.max,n.max,i)}function de(t){return t.animationValues&&void 0!==t.animationValues.opacityExit}const fe={duration:.45,ease:[.4,0,.1,1]},pe=t=>"undefined"!=typeof navigator&&navigator.userAgent.toLowerCase().includes(t),me=pe("applewebkit/")&&!pe("chrome/")?Math.round:u.Z;function ge(t){t.min=me(t.min),t.max=me(t.max)}function ye(t,e,n){return"position"===t||"preserve-aspect"===t&&!D(Mt(e),Mt(n),.2)}const ve=Xt({attachResizeListener:(t,e)=>(0,H.E)(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),we={current:void 0},_e=Xt({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!we.current){const t=new ve({});t.mount(window),t.setOptions({layoutScroll:!0}),we.current=t}return we.current},resetTransform:(t,e)=>{t.style.transform=void 0!==e?e:"none"},checkIsScrollRoot:t=>Boolean("fixed"===window.getComputedStyle(t).position)}),be={pan:{Feature:tt},drag:{Feature:J,ProjectionNode:_e,MeasureLayout:dt}};var Ee=n(8899);const Te={layout:{ProjectionNode:_e,MeasureLayout:dt}},Se={...o.s,...s.E,...be,...Te},Ce=(0,i.D)(((t,e)=>(0,r.w)(t,e,Se,Ee.b)))}}]);