"use strict";(self.webpackChunkcustom_vf_nextjs=self.webpackChunkcustom_vf_nextjs||[]).push([[465],{23465:(e,a,t)=>{t.r(a),t.d(a,{default:()=>Q});var n=t(42982),r=t(15861),s=t(92167),o=t(70885),l=t(64687),c=t.n(l),i=t(67294),u=t(87462),d=t(46271),g=t(13356),v=t(51649),f=t(13068),p=t(57897),b=t(15607),m=t(45987),h=t(61476),y=t(68552),w=t(2459),O=t(87487),x=t(33899),C=t(58473),j=(0,O.tv)({slots:{base:[" vg-relative "," vg-max-w-fit "," vg-inline-flex "," vg-items-center "," vg-justify-between "," vg-box-border "," vg-whitespace-nowrap "],content:" vg-flex-1 vg-text-inherit vg-font-normal ",dot:[" vg-w-2 "," vg-h-2 "," vg-ml-1 "," vg-rounded-full "],avatar:" vg-flex-shrink-0 ",closeButton:[" vg-z-10 "," vg-appearance-none "," vg-outline-none "," vg-select-none "," vg-transition-opacity "," vg-opacity-70 "," vg-hover:opacity-100 "," vg-cursor-pointer "," vg-active:opacity-disabled "," vg-tap-highlight-transparent "]},variants:{variant:{solid:{},bordered:{base:" vg-border-medium vg-bg-transparent "},light:{base:" vg-bg-transparent "},flat:{},faded:{base:" vg-border-medium "},shadow:{},dot:{base:" vg-border-medium vg-border-default vg-text-foreground vg-bg-transparent "}},color:{default:{dot:" vg-bg-default-400 "},primary:{dot:" vg-bg-primary "},secondary:{dot:" vg-bg-secondary "},success:{dot:" vg-bg-success "},warning:{dot:" vg-bg-warning "},danger:{dot:" vg-bg-danger "}},size:{sm:{base:" vg-px-1 vg-h-6 vg-text-tiny ",content:" vg-px-1 ",closeButton:" vg-text-medium ",avatar:" vg-w-4 vg-h-4 "},md:{base:" vg-px-1 vg-h-7 vg-text-small ",content:" vg-px-2 ",closeButton:" vg-text-large ",avatar:" vg-w-5 vg-h-5 "},lg:{base:" vg-px-2 vg-h-8 vg-text-medium ",content:" vg-px-2 ",closeButton:" vg-text-xl ",avatar:" vg-w-6 vg-h-6 "}},radius:{none:{base:" vg-rounded-none "},sm:{base:" vg-rounded-small "},md:{base:" vg-rounded-medium "},lg:{base:" vg-rounded-large "},full:{base:" vg-rounded-full "}},isOneChar:{true:{},false:{}},isCloseable:{true:{},false:{}},hasStartContent:{true:{}},hasEndContent:{true:{}},isDisabled:{true:{base:" vg-opacity-disabled vg-pointer-events-none "}},isCloseButtonFocusVisible:{true:{closeButton:[].concat((0,n.Z)(x.jR),[" vg-ring-1 "," vg-rounded-full "])}}},defaultVariants:{variant:"solid",color:"default",size:"md",radius:"full",isDisabled:!1},compoundVariants:[{variant:"solid",color:"default",class:{base:C.J.solid.default}},{variant:"solid",color:"primary",class:{base:C.J.solid.primary}},{variant:"solid",color:"secondary",class:{base:C.J.solid.secondary}},{variant:"solid",color:"success",class:{base:C.J.solid.success}},{variant:"solid",color:"warning",class:{base:C.J.solid.warning}},{variant:"solid",color:"danger",class:{base:C.J.solid.danger}},{variant:"shadow",color:"default",class:{base:C.J.shadow.default}},{variant:"shadow",color:"primary",class:{base:C.J.shadow.primary}},{variant:"shadow",color:"secondary",class:{base:C.J.shadow.secondary}},{variant:"shadow",color:"success",class:{base:C.J.shadow.success}},{variant:"shadow",color:"warning",class:{base:C.J.shadow.warning}},{variant:"shadow",color:"danger",class:{base:C.J.shadow.danger}},{variant:"bordered",color:"default",class:{base:C.J.bordered.default}},{variant:"bordered",color:"primary",class:{base:C.J.bordered.primary}},{variant:"bordered",color:"secondary",class:{base:C.J.bordered.secondary}},{variant:"bordered",color:"success",class:{base:C.J.bordered.success}},{variant:"bordered",color:"warning",class:{base:C.J.bordered.warning}},{variant:"bordered",color:"danger",class:{base:C.J.bordered.danger}},{variant:"flat",color:"default",class:{base:C.J.flat.default}},{variant:"flat",color:"primary",class:{base:C.J.flat.primary}},{variant:"flat",color:"secondary",class:{base:C.J.flat.secondary}},{variant:"flat",color:"success",class:{base:C.J.flat.success}},{variant:"flat",color:"warning",class:{base:C.J.flat.warning}},{variant:"flat",color:"danger",class:{base:C.J.flat.danger}},{variant:"faded",color:"default",class:{base:C.J.faded.default}},{variant:"faded",color:"primary",class:{base:C.J.faded.primary}},{variant:"faded",color:"secondary",class:{base:C.J.faded.secondary}},{variant:"faded",color:"success",class:{base:C.J.faded.success}},{variant:"faded",color:"warning",class:{base:C.J.faded.warning}},{variant:"faded",color:"danger",class:{base:C.J.faded.danger}},{variant:"light",color:"default",class:{base:C.J.light.default}},{variant:"light",color:"primary",class:{base:C.J.light.primary}},{variant:"light",color:"secondary",class:{base:C.J.light.secondary}},{variant:"light",color:"success",class:{base:C.J.light.success}},{variant:"light",color:"warning",class:{base:C.J.light.warning}},{variant:"light",color:"danger",class:{base:C.J.light.danger}},{isOneChar:!0,size:"sm",class:{base:" vg-w-5 vg-h-5 vg-min-w-5 vg-min-h-5 "}},{isOneChar:!0,size:"md",class:{base:" vg-w-6 vg-h-6 vg-min-w-6 vg-min-h-6 "}},{isOneChar:!0,size:"lg",class:{base:" vg-w-7 vg-h-7 vg-min-w-7 vg-min-h-7 "}},{isOneChar:!0,isCloseable:!1,class:{base:" vg-px-0 vg-justify-center ",content:" vg-px-0 vg-flex-none "}},{isOneChar:!0,isCloseable:!0,class:{base:" vg-w-auto "}},{hasStartContent:!0,size:"sm",class:{content:" vg-pl-0.5 "}},{hasStartContent:!0,size:["md","lg"],class:{content:" vg-pl-1 "}},{hasEndContent:!0,size:"sm",class:{content:" vg-pr-0.5 "}},{hasEndContent:!0,size:["md","lg"],class:{content:" vg-pr-1 "}}]}),P=t(33295),D=t(49869),N=["ref","as","children","avatar","startContent","endContent","onClose","classNames","className"];function S(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function J(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?S(Object(t),!0).forEach((function(a){(0,s.Z)(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):S(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}var k=i.createElement;function Z(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function M(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?Z(Object(t),!0).forEach((function(a){(0,s.Z)(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Z(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}var E=(0,b.Gp)((function(e,a){var t=function(e){var a=(0,b.oe)(e,j.variantKeys),t=(0,o.Z)(a,2),r=t[0],s=t[1],l=r.ref,c=r.as,u=r.children,d=r.avatar,g=r.startContent,v=r.endContent,f=r.onClose,p=r.classNames,O=r.className,x=(0,m.Z)(r,N),C=c||"div",S=(0,P.gy)(l),k=(0,D.W)(null==p?void 0:p.base,O),Z=!!f,M="dot"===e.variant,E=(0,w.F)(),I=E.focusProps,B=E.isFocusVisible,z=(0,i.useMemo)((function(){return"string"==typeof u&&1===(null==u?void 0:u.length)}),[u]),F=(0,i.useMemo)((function(){return!!d||!!g}),[d,g]),_=(0,i.useMemo)((function(){return!!v||Z}),[v,Z]),T=(0,i.useMemo)((function(){return j(J(J({},s),{},{hasStartContent:F,hasEndContent:_,isOneChar:z,isCloseable:Z,isCloseButtonFocusVisible:B}))}),[].concat((0,n.Z)(Object.values(s)),[B,F,_,z,Z])),R=(0,y.r)({isDisabled:!(null==e||!e.isDisabled),onPress:f}).pressProps,V=function(e){return(0,i.isValidElement)(e)?(0,i.cloneElement)(e,{className:(0,D.W)("max-h-[80%]",e.props.className)}):null};return{Component:C,children:u,slots:T,classNames:p,isDot:M,isCloseable:Z,startContent:function(e){return(0,i.isValidElement)(e)?(0,i.cloneElement)(e,{className:T.avatar({class:null==p?void 0:p.avatar})}):null}(d)||V(g),endContent:V(v),getCloseButtonProps:function(){return J({role:"button",tabIndex:0,className:T.closeButton({class:null==p?void 0:p.closeButton})},(0,h.d)(R,I))},getChipProps:function(){return J({ref:S,className:T.base({class:k})},x)}}}(M(M({},e),{},{ref:a})),r=t.Component,s=t.children,l=t.slots,c=t.classNames,u=t.isDot,d=t.isCloseable,g=t.startContent,v=t.endContent,f=t.getCloseButtonProps,O=t.getChipProps,x=(0,i.useMemo)((function(){return u&&!g?k("span",{className:l.dot({class:null==c?void 0:c.dot})}):g}),[l,g,u]),C=(0,i.useMemo)((function(){return d?k("span",f(),v||k(p.f,null)):v}),[v,d,f]);return k(r,O(),x,k("span",{className:l.content({class:null==c?void 0:c.content})},s),C)}));E.displayName="NextUI.Chip";const I=E;var B=t(73711),z=t(11194),F=t(8193),_=t(82280),T=t(91148),R=t(49472),V=i.createElement;function U(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function L(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?U(Object(t),!0).forEach((function(a){(0,s.Z)(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):U(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}const K=function(e){var a=(0,i.useState)([]),t=a[0],s=a[1],l=(0,i.useState)(!1),p=l[0],b=l[1],m=(0,i.useState)(0),h=m[0],y=m[1],w=(0,i.useState)([]),O=w[0],x=w[1],C=(0,i.useState)([]),j=C[0],P=C[1],D=i.useState({fileName:!1}),N=(0,o.Z)(D,2),S=(N[0],N[1]),J=(0,i.useState)([]),k=(J[0],J[1],(0,i.useState)([])),Z=k[0],M=k[1],E=(0,d.cF)(B.l2,"voiceglow-eu");i.useEffect((function(){if(null!=O&&O.length&&!e.lightMode)return e.uploadTasksCallback&&e.uploadTasksCallback(O),O.forEach((function(e){e.on("state_changed",(function(e){var a=Math.round(e.bytesTransferred/e.totalBytes*100);y(a)}),(function(e){}),(function(){b(!1),y(0)}))})),function(){O.forEach((function(e){return e.cancel()}))}}),[O]);var U=function(){var a=(0,r.Z)(c().mark((function a(t){var o;return c().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!e.isDisabled){a.next=2;break}return a.abrupt("return");case 2:e.onStartUpload&&e.onStartUpload(),o=t.map((function(a){var t,o=a.size,l=e.path||"/public",i=(null===(t=a.name)||void 0===t||null===(t=t.split(".")[1])||void 0===t?void 0:t.toLowerCase())||!1;if(e.accept&&!e.accept.includes(i))return alert("Only ".concat(e.accept.join(", ")," files are allowed"));if(e.maxSizeMB&&1e6*e.maxSizeMB<o)return alert("Max size: ".concat(e.maxSizeMB,"MB"));var u=(0,z.D1)(10),g="".concat(l,"/").concat(u,".").concat(a.name.split(".")[1]),v=(0,d.iH)(E,"".concat(g));if(!e.lightMode){var f=(0,d.B0)(v,a,{cacheControl:"public,max-age=31536000"});return f.on("state_changed",(function(e){var a=Math.round(e.bytesTransferred/e.totalBytes*100);y(a)}),(function(e){}),(function(){(0,d.Jt)(v).then(function(){var t=(0,r.Z)(c().mark((function t(r){var i,d,v;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i={url:r,path:"".concat(l),id:e.id||u,dbFilePath:g,name:a.name,bucket:"voiceglow-eu",serverFilename:"".concat(u,"-").concat(a.name),sizeMbs:o/1e6},e.callback&&e.callback(i),null!=e&&e.userId&&(v=Math.min(Math.round((null===R.Rm||void 0===R.Rm||null===(d=R.Rm.COSTS_CREDITS)||void 0===d?void 0:d.FILE_UPLOADED_PER_MB)*(a.size/1e6)),100),fetch("".concat((0,T.Sw)({region:"voiceglow-eu"===(null==e?void 0:e.bucket)?"eu":"na"}),"/public/users/").concat(e.userId,"/consume-credits"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({consume:v,logData:{amount:v,agentId:null==e?void 0:e.agentId,causedBy:"agent",logMessage:"File with size ".concat(o/1e6," MBs was uploaded through an agent, consuming ").concat(v," credits")}})})),s((function(e){return[].concat((0,n.Z)(e),[i])})),S((function(e){return L(L({},e),{},{fileName:a.name})}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())})),b(!0),f}var p={id:u,serverFilename:"".concat(u,"-").concat(a.name),serverFilePath:g,file:a};M((function(a){var t=[].concat((0,n.Z)(a),[p]);return e.lightCallback&&e.lightCallback(t),t}))})),P((function(e){return[].concat((0,n.Z)(e),(0,n.Z)(o.filter((function(e){return null!==e}))))})),x(o.filter((function(e){return null!==e})));case 6:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}();i.useEffect((function(){null!=e&&e.setLoading&&((null==t?void 0:t.length)===(null==j?void 0:j.length)?e.setLoading(!1):e.setLoading(!0))}),[j,t]);var K=(0,g.uI)({onDrop:U,multiple:!0}),A=K.getRootProps,H=K.getInputProps;return K.isDragActive,V("div",{className:" vg-flex vg-flex-col vg-gap-2 vg-w-full vg-h-full "},V("div",{className:" vg-w-full vg-h-full vg-mx-auto vg-p-2 vg-rounded-lg vg-transition-all vg-duration-500 ".concat(e.isDisabled&&" vg-opacity-75 "," vg-upload-container")},V("div",(0,u.Z)({},A(),{className:" vg-w-full vg-h-full vg-flex-all-center vg-border-dashed vg-border-2 ".concat(t.length>0?" vg-border-foreground ":" vg-border-primary-400 "," vg-rounded-lg ").concat(e.className||" "," vg-transition-all vg-duration-500 vg-upload-drop-container")}),V("input",H()),t.length>0&&!p&&"img"==e.type?t.map((function(e,a){return V("img",{key:a,className:" vg-w-32 vg-h-32 vg-upload--img-placeholder",src:e.url})})):!t.length&&!p&&V(F.IEK,{className:" vg-w-12 vg-h-12 vg-upload--icon"}),p?V(i.Fragment,null,V(f.Z,{className:" vg-mb-2 vg-upload-spinner",color:"primary"}),V("p",{className:" vg-opacity-50 vg-mb-2 vg-text-small vg-text-center vg-leading-5 vg-upload-text"},V(_.Z,{text:"Uploading.."})," ",V("br",null),V(_.Z,{text:"Please Keep This Tab Open"})),V("div",{className:" vg-w-[80%] vg-h-5 vg-bg-primary-100 vg-rounded-full vg-overflow-hidden vg-mx-auto vg-upload-loading-container"},V("div",{className:" vg-h-full vg-bg-primary-700 vg-relative vg-upload-loading--bar",style:{width:"".concat(h||1,"%")}},V("p",{className:" vg-absolute vg-right-1 vg-top-[2px] vg-text-small vg-text-primary-100 vg-upload-loading--text"},"".concat(h||1,"%"))))):V(i.Fragment,null,t.length>0&&e.showUrls&&!e.lightMode?V("div",{className:" vg-text-foreground "},V("div",{className:" vg-mb-1 vg-flex vg-items-center vg-font-medium "},V(v.DVR,{className:" vg-w-4 vg-h-4 vg-mr-2 "}),V("p",null,V(_.Z,{text:"Uploaded Successfully"}))),t.map((function(e,a){return V("p",{key:a,className:" vg-opacity-75 vg-text-center "},(0,z.MB)(e.name,20))}))):V(i.Fragment,null,V("p",{className:" vg-text-small "},V(_.Z,{text:"Drag and Drop Here"})),e.maxSizeMB&&V("p",{className:" vg-opacity-75 vg-mb-3 vg-text-small "},V(_.Z,{text:"Max Size:"})," ",V("strong",null,e.maxSizeMB,"MB")),e.accept?V("p",{className:" vg-opacity-75 vg-text-small "},V(_.Z,{text:"Only"})," ",e.accept.length?e.accept.map((function(e){return e+" "})):""," ",V(_.Z,{text:"Files"})):"")))),V("div",null,(null==Z?void 0:Z.length)>0?Z.map((function(a){return V(I,{variant:"light",onClose:function(){M((function(t){var n=t.filter((function(e){return e.id!==a.id}));return e.lightCallback&&e.lightCallback(Z.filter((function(e){return e.id!==a.id}))),n}))}},V("p",{className:" vg-text-foreground "},a.file.name))})):null))};var A=t(73850),H=t(48676),W=i.createElement;function G(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function q(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?G(Object(t),!0).forEach((function(a){(0,s.Z)(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):G(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}const Q=function(e){var a,t,s,l=(0,H.useRuntime)(),u=l.setRuntime,d=l.runtime,g=l.confirmedBucket,v=l.formattedTurnsValue,f=(null==e||null===(a=e.message)||void 0===a||null===(a=a.item)||void 0===a||null===(a=a.payload)||void 0===a?void 0:a.options)||{},p=i.useState((null==f?void 0:f.defaultValue)||0),b=(0,o.Z)(p,2),m=b[0],h=(b[1],i.useState(!1)),y=(0,o.Z)(h,2),w=y[0],O=y[1],x=v.length-1,C=i.useState([]),j=(0,o.Z)(C,2),P=j[0],D=j[1];i.useEffect((function(){null!=f&&f.canCancel||u((function(e){return q(q({},e),{},{blockInput:!0})}))}),[]);var N=function(){var e=(0,r.Z)(c().mark((function e(a){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(!0),e.next=3,(0,H.handlePushMessageNoInteract)({agentID:d.variables.ID,userID:d.userID,action:void 0,messages:[{from:"human",type:"cancel"===a?"info:danger":"info:success",item:"cancel"===a?"Operation cancelled":"Submitted successfully",delay:0}],bucket:g,origin:"web-chat"});case 3:return e.next=5,new Promise((function(e){return setTimeout(e,1e3)}));case 5:return e.next=7,(0,H.handlePushMessageNoInteract)({agentID:d.variables.ID,userID:d.userID,action:{type:a,payload:{type:"MultiFileUpload",payload:{value:m}}},bucket:g,vf_variables:{vg_filesupload_response:JSON.stringify({files:P.map((function(e){return{url:e.url,name:e.name,sizeMegabytes:e.sizeMbs}}))})},origin:"web-chat"});case 7:O(!1);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}();return W("div",{className:" vg-w-full vg-h-full vg-flex vg-flex-col vg-gap-1 vg-multiupload--container"},W("div",{style:{height:150+10*P.length},className:" vg-w-full vg-text-foreground vg-multiupload--dropbox"},W(K,{loading:w,setLoading:O,bucket:g,agentId:null==d||null===(t=d.variables)||void 0===t?void 0:t.ID,userId:null===(s=d.variables)||void 0===s?void 0:s.ownerID,variant:"plain",showUrls:!0,callback:function(e){D((function(a){return[].concat((0,n.Z)(a),[e])}))}})),W("div",{className:" vg-w-full vg-grid vg-grid-cols-2 vg-gap-2 vg-multiupload--buttons"},W(A.Z,{className:" ".concat(!1===(null==f?void 0:f.canCancel)?" vg-col-span-full ":" "," vg-multiupload--submit"),isLoading:w,isDisabled:!(null!=P&&P.length)||x!==e.turnIndex,color:"primary",onPress:function(){N("default")}},W(_.Z,null,"Submit")),!1===(null==f?void 0:f.canCancel)?null:W(A.Z,{className:"vg-multiupload--cancel",color:"danger",isDisabled:w||!1===(null==f?void 0:f.canCancel)||x!==e.turnIndex,onPress:function(){N("cancel")}},W(_.Z,null,"Cancel"))))}}}]);